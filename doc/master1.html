<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<meta name="author" content="Author Name">
<title>Project Documentation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Project Documentation</h1>
<div class="details">
<span id="author" class="author">Author Name</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_welcome_to_the_wonderful_world_of_polylith_for_clojure">Welcome to the wonderful world of Polylith for Clojure!</a></li>
<li><a href="#_sponsor_polylith">Sponsor Polylith</a>
<ul class="sectlevel2">
<li><a href="#_bronze_sponsors">Bronze Sponsors</a></li>
<li><a href="#_iron_sponsors">Iron Sponsors</a></li>
<li><a href="#_polylith_fans">Polylith Fans</a></li>
<li><a href="#_polylith_friends">Polylith Friends</a></li>
</ul>
</li>
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_introduction_2">Introduction</a></li>
<li><a href="#_install">Install</a></li>
<li><a href="#_install_2">Install</a>
<ul class="sectlevel1">
<li><a href="#install-on-mac">Install as Stand-alone on macOS</a></li>
<li><a href="#install-on-linux">Install as Stand-alone on Linux</a></li>
<li><a href="#install-on-windows">Install Stand-alone on Windows</a>
<ul class="sectlevel2">
<li><a href="#_troubleshooting_clojure_cli_install_on_windows">Troubleshooting Clojure CLI Install on Windows</a></li>
<li><a href="#_install_the_poly_tool">Install the poly tool</a></li>
</ul>
</li>
<li><a href="#install-via-nix">Install as Stand-alone via Nix</a></li>
<li><a href="#use-as-dependency">Use as Dependency</a>
<ul class="sectlevel2">
<li><a href="#github-dependency">Using a Git Dependency</a></li>
<li><a href="#_specifying_logging_libraries">Specifying Logging Libraries</a></li>
</ul>
</li>
<li><a href="#_use_as_a_library">Use as a library</a></li>
<li><a href="#jvm-options">JVM options</a></li>
<li><a href="#_upgrade">Upgrade</a></li>
</ul>
</li>
<li><a href="#_upgrade_2">Upgrade</a>
<ul class="sectlevel1">
<li><a href="#_stand_alone_macos">Stand-alone macOS</a></li>
<li><a href="#_stand_alone_linux">Stand-alone Linux</a></li>
<li><a href="#_stand_alone_windows">Stand-alone Windows</a></li>
<li><a href="#_stand_alone_nix">Stand-alone Nix</a></li>
<li><a href="#_as_dependency">As Dependency</a></li>
<li><a href="#_example_systems">Example Systems</a></li>
</ul>
</li>
<li><a href="#_example_systems_2">Example Systems</a>
<ul class="sectlevel1">
<li><a href="#_realworld">RealWorld</a></li>
<li><a href="#_usermanager">Usermanager</a></li>
<li><a href="#_demo_rama_electric">Demo Rama Electric</a></li>
<li><a href="#integrant-system">Integrant system</a></li>
<li><a href="#_game_of_life">Game of Life</a></li>
<li><a href="#_production_systems">Production Systems</a></li>
</ul>
</li>
<li><a href="#_production_systems_2">Production Systems</a>
<ul class="sectlevel1">
<li><a href="#_scrintal">Scrintal</a></li>
<li><a href="#_world_singles_networks">World Singles Networks</a></li>
<li><a href="#_greenlabs">Greenlabs</a></li>
<li><a href="#_polylith">Polylith</a></li>
<li><a href="#_add_your_company_here">Add your Company Here!</a></li>
<li><a href="#_workspace">Workspace</a></li>
</ul>
</li>
<li><a href="#_workspace_2">Workspace</a>
<ul class="sectlevel1">
<li><a href="#sub-workspaces">Existing git Repository</a></li>
<li><a href="#bootstrap">Bootstrapping a Workspace</a></li>
<li><a href="#_development">Development</a></li>
</ul>
</li>
<li><a href="#_development_2">Development</a>
<ul class="sectlevel1">
<li><a href="#_generic_setup">Generic Setup</a></li>
<li><a href="#idea-cursive">IntelliJ IDEA with Cursive Setup</a>
<ul class="sectlevel2">
<li><a href="#_cursive_setup">Cursive Setup</a></li>
<li><a href="#_trying_out_your_development_environment">Trying Out Your Development Environment</a></li>
</ul>
</li>
<li><a href="#_component">Component</a></li>
</ul>
</li>
<li><a href="#_component_2">Component</a>
<ul class="sectlevel1">
<li><a href="#_how_to_execute_commands">How to Execute Commands</a></li>
<li><a href="#create-component">Creating a Component</a></li>
<li><a href="#_add_an_implementation">Add an Implementation</a></li>
<li><a href="#ide-local-root">IDE Support for <code>:local/root</code></a></li>
<li><a href="#_interface">Interface</a></li>
</ul>
</li>
<li><a href="#_interface_2">Interface</a>
<ul class="sectlevel1">
<li><a href="#one-interface-in-multiple-components">Declaring the Same Interface in Multiple Components</a></li>
<li><a href="#_splitting_an_interface_into_sub_namespaces">Splitting an Interface into Sub-Namespaces</a></li>
<li><a href="#_delegation">Delegation</a></li>
<li><a href="#_interface_definitions">Interface Definitions</a></li>
<li><a href="#_more_about_interfaces">More About Interfaces</a></li>
<li><a href="#_base">Base</a></li>
</ul>
</li>
<li><a href="#_base_2">Base</a>
<ul class="sectlevel1">
<li><a href="#_project">Project</a></li>
</ul>
</li>
<li><a href="#_project_2">Project</a>
<ul class="sectlevel1">
<li><a href="#_shell">Shell</a></li>
</ul>
</li>
<li><a href="#_shell_2">Shell</a>
<ul class="sectlevel1">
<li><a href="#launch">Launching</a></li>
<li><a href="#quit">Quitting</a></li>
<li><a href="#_lets_play">Let&#8217;s Play</a></li>
<li><a href="#_the_dash_item">The Dash Item</a></li>
<li><a href="#_using_autocomplete_to_explore">Using Autocomplete to Explore</a></li>
<li><a href="#_switching_workspace">Switching Workspace</a>
<ul class="sectlevel2">
<li><a href="#_switching_to_an_exported_workspace">Switching to an Exported Workspace</a></li>
<li><a href="#switch-workspace">Switching workspace by name</a></li>
<li><a href="#_switch_at_launch">Switch at Launch</a></li>
<li><a href="#_workspace_switch_mechanics">Workspace Switch Mechanics</a></li>
</ul>
</li>
<li><a href="#_autocomplete_examples">Autocomplete Examples</a></li>
<li><a href="#_limitations">Limitations</a>
<ul class="sectlevel2">
<li><a href="#_browsing_directories">Browsing Directories</a></li>
<li><a href="#_creating_a_workspace">Creating a Workspace</a></li>
</ul>
</li>
<li><a href="#_documentation">Documentation</a></li>
</ul>
</li>
<li><a href="#_doc">Doc</a>
<ul class="sectlevel1">
<li><a href="#page">page</a></li>
<li><a href="#help">help</a></li>
<li><a href="#ws">ws</a></li>
<li><a href="#more">more</a>
<ul class="sectlevel2">
<li><a href="#_blog_posts">blog posts</a></li>
<li><a href="#_high_level">high-level</a></li>
<li><a href="#_in_japanese">in japanese</a></li>
<li><a href="#_podcasts">podcasts</a></li>
<li><a href="#_python_tool">python tool</a></li>
<li><a href="#_slack">slack</a></li>
<li><a href="#videos">videos</a></li>
<li><a href="#_workspaces">workspaces</a></li>
</ul>
</li>
<li><a href="#_tap">Tap</a></li>
</ul>
</li>
<li><a href="#_tap_2">Tap</a>
<ul class="sectlevel1">
<li><a href="#_tools_deps">Tools.deps</a></li>
</ul>
</li>
<li><a href="#_tools_deps_2">Tools.deps</a>
<ul class="sectlevel1">
<li><a href="#_the_poly_alias">The <code>poly</code> Alias</a></li>
<li><a href="#_clojure_vs_clj">clojure vs clj</a></li>
<li><a href="#_build">Build</a></li>
</ul>
</li>
<li><a href="#_build_2">Build</a>
<ul class="sectlevel1">
<li><a href="#_try_it_out">Try it out</a></li>
<li><a href="#_git">Git</a></li>
</ul>
</li>
<li><a href="#_git_2">Git</a>
<ul class="sectlevel1">
<li><a href="#_tagging">Tagging</a></li>
</ul>
</li>
<li><a href="#_tagging_2">Tagging</a>
<ul class="sectlevel1">
<li><a href="#release">Release</a></li>
<li><a href="#_flags">Flags</a></li>
</ul>
</li>
<li><a href="#_flags_2">Flags</a>
<ul class="sectlevel1">
<li><a href="#_project_flags">Project Flags</a>
<ul class="sectlevel2">
<li><a href="#_projects_status_column_flags">Projects <code>status</code> Column Flags</a></li>
<li><a href="#_projects_dev_column_flags">Projects <code>dev</code> Column Flags</a></li>
</ul>
</li>
<li><a href="#_brick_flags">Brick Flags</a>
<ul class="sectlevel2">
<li><a href="#_bricks_deployable_projects_columns">Bricks Deployable Projects Columns</a></li>
<li><a href="#_bricks_dev_project_column">Bricks <code>dev</code> Project Column</a></li>
</ul>
</li>
<li><a href="#r-flag">The optional <code>r</code> flag</a></li>
<li><a href="#_testing">Testing</a></li>
</ul>
</li>
<li><a href="#_testing_2">Testing</a>
<ul class="sectlevel1">
<li><a href="#_test_filters">Test Filters</a>
<ul class="sectlevel2">
<li><a href="#filter-projects">Filter on Projects</a></li>
<li><a href="#filter-bricks">Filter on Bricks</a></li>
</ul>
</li>
<li><a href="#project-tests">Project Tests</a></li>
<li><a href="#_test_approaches">Test approaches</a></li>
<li><a href="#setup-and-teardown">Test Setup and Teardown</a></li>
<li><a href="#include-exclude">Include and Exclude Bricks by Configuration</a></li>
<li><a href="#_summary">Summary</a></li>
<li><a href="#_how_test_execution_works">How Test Execution Works</a>
<ul class="sectlevel2">
<li><a href="#from-the-repl">From the REPL</a></li>
<li><a href="#_from_poly">From <code>poly</code></a></li>
</ul>
</li>
<li><a href="#_troubleshooting">Troubleshooting</a></li>
<li><a href="#_long_lived_shell_sessions">Long-Lived Shell Sessions</a></li>
<li><a href="#_test_runners">Test Runners</a></li>
</ul>
</li>
<li><a href="#_test_runners_2">Test Runners</a>
<ul class="sectlevel1">
<li><a href="#in-process">In-Process Test Runner</a></li>
<li><a href="#external">External Test Runner</a></li>
<li><a href="#_in_process_vs_external_test_runner">In-process vs. External Test Runner</a></li>
<li><a href="#_use_a_custom_test_runner">Use a Custom Test Runner</a></li>
<li><a href="#write-your-own">Implement Your Own Custom Test Runner</a></li>
<li><a href="#test-configuration">Test configuration</a></li>
<li><a href="#_test_runners_from_the_community">Test Runners from the Community</a>
<ul class="sectlevel2">
<li><a href="#imre-kaocha-test-runner">Kaocha Test Runner</a></li>
<li><a href="#sean-external-test-runner">External Test Runner</a></li>
</ul>
</li>
<li><a href="#_profile">Profile</a></li>
</ul>
</li>
<li><a href="#_profile_2">Profile</a>
<ul class="sectlevel1">
<li><a href="#_an_example_scenario">An Example Scenario</a></li>
<li><a href="#_profiles_to_the_rescue">Profiles to the Rescue</a></li>
<li><a href="#_planning_a_solution">Planning a Solution</a></li>
<li><a href="#_implementation">Implementation</a>
<ul class="sectlevel2">
<li><a href="#create-user-api-base">1. Create the <code>user-api</code> base</a>
<ul class="sectlevel3">
<li><a href="#create-user-api-base2">a. Create the <code>user-api</code> base</a></li>
<li><a href="#add-slacker-library-to-user-api">b. Add the <code>slacker</code> library to the <code>user-api</code> base</a></li>
<li><a href="#add-user-api-to-dev-deps">c. Add  <code>user-api</code> base to <code>./deps.edn</code>:</a></li>
<li><a href="#implement-user-api">d. Implement the server for the <code>user-api</code> base</a></li>
</ul>
</li>
<li><a href="#create-user-remote-component">2. Create the <code>user-remote</code> component</a>
<ul class="sectlevel3">
<li><a href="#create-user-remote-component2">a. Create the <code>user-remote</code> component</a></li>
<li><a href="#add-slacker-library-to-user-remote">b. Add the <code>slacker</code> library to <code>user-remote</code> component</a></li>
<li><a href="#remove-user-from-dev-deps">c. Remove the <code>user</code> component from <code>./deps.edn</code>:</a></li>
<li><a href="#add-profiles-to-dev-deps">d. Add the <code>default</code> and <code>remote</code> profiles to <code>./deps.edn</code>:</a></li>
<li><a href="#activate-remote-profile-in-ide">e. Activate the <code>remote</code> profile in your IDE</a></li>
<li><a href="#implement-user-remote">f. Implement <code>user-remote</code></a></li>
<li><a href="#activate-default-profile">g. Activate the <code>default</code> profile in your IDE</a></li>
</ul>
</li>
<li><a href="#adjust-command-line-project">3. Switch from <code>user</code> to <code>user-remote</code> in the <code>command-line</code> project</a>
<ul class="sectlevel3">
<li><a href="#replace-user-with-user-remote-in-command-line">a. Replace <code>user</code> with <code>user-remote</code> in <code>command-line</code> project</a></li>
<li><a href="#create-command-line-uberjar">b. Create <code>command-line</code> uberjar</a></li>
</ul>
</li>
<li><a href="#create-user-service-project">4. Create the <code>user-service</code> project</a>
<ul class="sectlevel3">
<li><a href="#create-user-service-project2">a. Create the <code>user-service</code> project:</a></li>
<li><a href="#configure-user-service">b. Configure the <code>user-service</code></a></li>
<li><a href="#add-user-service-project-alias">c. Add a <code>poly</code> alias for the <code>user-service</code></a></li>
</ul>
</li>
<li><a href="#build-user-service">5. Build the <code>user-service</code></a></li>
</ul>
</li>
<li><a href="#_verifying_our_work">Verifying our Work</a></li>
<li><a href="#_exploring_with_poly_info">Exploring with <code>poly info</code></a></li>
<li><a href="#_testing_with_poly_test">Testing with <code>poly test</code></a></li>
<li><a href="#_dependencies">Dependencies</a></li>
</ul>
</li>
<li><a href="#_dependencies_2">Dependencies</a>
<ul class="sectlevel1">
<li><a href="#setup">Setup for Tutorial</a></li>
<li><a href="#_digging_in">Digging In</a></li>
<li><a href="#_swap_axes">Swap axes</a></li>
<li><a href="#_accessibility">Accessibility</a></li>
<li><a href="#_circular_dependencies">Circular dependencies</a></li>
<li><a href="#_libraries">Libraries</a></li>
</ul>
</li>
<li><a href="#_libraries_2">Libraries</a>
<ul class="sectlevel1">
<li><a href="#_tutorial_setup">Tutorial Setup</a></li>
<li><a href="#reporting">Reporting</a></li>
<li><a href="#_updating">Updating</a></li>
<li><a href="#lib-dep-types">Library Dependency Types</a></li>
<li><a href="#_configuration">Configuration</a>
<ul class="sectlevel2">
<li><a href="#local-deps">Local Dependencies</a>
<ul class="sectlevel3">
<li><a href="#_distinguishing_from_bricks">Distinguishing from Bricks</a></li>
<li><a href="#_differences_from_tools_deps">Differences from Tools.deps</a></li>
</ul>
</li>
<li><a href="#_project_library_dependencies">Project Library Dependencies</a></li>
</ul>
</li>
<li><a href="#_configuration_2">Configuration</a></li>
</ul>
</li>
<li><a href="#_configuration_3">Configuration</a>
<ul class="sectlevel1">
<li><a href="#_poly_workspace_edn">Poly <code>workspace.edn</code></a>
<ul class="sectlevel2">
<li><a href="#ws-projects">Projects</a></li>
</ul>
</li>
<li><a href="#_tools_deps_deps_edn_files">Tools.deps <code>deps.edn</code> Files</a>
<ul class="sectlevel2">
<li><a href="#_projects">Projects</a></li>
<li><a href="#_bases">Bases</a></li>
<li><a href="#_components">Components</a></li>
</ul>
</li>
<li><a href="#user">Poly User <code>config.edn</code></a></li>
<li><a href="#custom">Custom configuration</a></li>
<li><a href="#_validations">Validations</a></li>
</ul>
</li>
<li><a href="#_validations_2">Validations</a>
<ul class="sectlevel1">
<li><a href="#_viewing_all_errors_and_warnings">Viewing All Errors and Warnings</a></li>
<li><a href="#warning207">Marking a Brick as Necessary to Suppress Warning 207</a></li>
<li><a href="#error111">Workspace Structure Reflects Error 111</a></li>
<li><a href="#_state">State</a></li>
</ul>
</li>
<li><a href="#_state_2">State</a>
<ul class="sectlevel1">
<li><a href="#_source_code">Source Code</a></li>
</ul>
</li>
<li><a href="#_source_code_2">Source code</a>
<ul class="sectlevel1">
<li><a href="#_paths">Paths</a></li>
<li><a href="#_resources">Resources</a></li>
<li><a href="#frontend">Frontend Code Options</a>
<ul class="sectlevel2">
<li><a href="#_1_frontend_in_base_or_components">1. Frontend in Base or Components</a></li>
<li><a href="#_2_frontend_in_a_non_poly_directory">2. Frontend in a Non-<code>poly</code> Directory</a>
<ul class="sectlevel3">
<li><a href="#_a_under_the_workspace">a) Under the Workspace</a></li>
<li><a href="#_b_outside_the_workspace">b) Outside the Workspace</a></li>
</ul>
</li>
<li><a href="#_3_frontend_in_separate_repository">3. Frontend in Separate Repository</a></li>
</ul>
</li>
<li><a href="#_artifacts">Artifacts</a></li>
</ul>
</li>
<li><a href="#_artifacts_2">Artifacts</a>
<ul class="sectlevel1">
<li><a href="#libraries">Libraries</a>
<ul class="sectlevel2">
<li><a href="#_single_library">Single library</a></li>
<li><a href="#_multiple_libraries">Multiple libraries</a></li>
<li><a href="#_one_library_per_brick">One library per brick</a></li>
<li><a href="#_one_library_per_workspace">One library per workspace</a></li>
<li><a href="#_adjust_the_top_namespace_at_build_time">Adjust the top namespace at build time</a></li>
<li><a href="#_conclusion">Conclusion</a></li>
</ul>
</li>
<li><a href="#_explore_the_workspace">Explore the Workspace</a></li>
</ul>
</li>
<li><a href="#_explore_the_workspace_2">Explore the Workspace</a>
<ul class="sectlevel1">
<li><a href="#_exploring_with_ws">Exploring With <code>ws</code></a>
<ul class="sectlevel2">
<li><a href="#_the_basics">The Basics</a></li>
<li><a href="#_digging_deeper">Digging Deeper</a></li>
<li><a href="#_learning_what_data_is_available">Learning What Data is Available</a></li>
<li><a href="#_fetching_library_usage">Fetching Library Usage</a></li>
<li><a href="#export-workspace">Saving the Workspace Structure</a></li>
</ul>
</li>
<li><a href="#ws-file">Referencing a Saved Workspace Structure</a></li>
<li><a href="#_referencing_a_workspace_in_another_dir">Referencing a Workspace in Another Dir</a></li>
<li><a href="#_polyx">Polyx</a></li>
</ul>
</li>
<li><a href="#_polyx_2">Polyx</a>
<ul class="sectlevel1">
<li><a href="#_install_via_polyx_alias">Install via <code>:polyx</code> alias</a>
<ul class="sectlevel2">
<li><a href="#_finding_your_git_sha">Finding your Git SHA</a>
<ul class="sectlevel3">
<li><a href="#_stable">Stable</a></li>
<li><a href="#_snapshot">SNAPSHOT</a></li>
<li><a href="#_from_command_line">From Command Line</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_using">Using</a>
<ul class="sectlevel2">
<li><a href="#_the_overview_command">The <code>overview</code> Command</a></li>
</ul>
</li>
<li><a href="#_naming">Naming</a></li>
</ul>
</li>
<li><a href="#_naming_2">Naming</a>
<ul class="sectlevel1">
<li><a href="#_git_hooks">Git Hooks</a></li>
</ul>
</li>
<li><a href="#_git_hook">Git Hook</a>
<ul class="sectlevel1">
<li><a href="#_colors">Colors</a></li>
</ul>
</li>
<li><a href="#_colors_2">Colors</a>
<ul class="sectlevel1">
<li><a href="#config">Config</a></li>
<li><a href="#_usage">Usage</a></li>
<li><a href="#_developing_polylith">Developing Polylith</a></li>
</ul>
</li>
<li><a href="#_developing_poly">Developing poly</a>
<ul class="sectlevel1">
<li><a href="#_contributing">Contributing</a>
<ul class="sectlevel2">
<li><a href="#_issues_first_please">Issues First Please</a></li>
<li><a href="#_include_tests_and_docs">Include Tests and Docs</a></li>
<li><a href="#_submitting_a_pull_request">Submitting a Pull Request</a></li>
</ul>
</li>
<li><a href="#_special_poly_arguments">Special <code>poly</code> Arguments</a>
<ul class="sectlevel2">
<li><a href="#all-shell"><code>all</code> - <code>shell</code></a></li>
<li><a href="#_changed_files"><code>changed-files</code></a></li>
<li><a href="#_fake_sha"><code>fake-sha</code></a></li>
<li><a href="#_fake_tag"><code>fake-tag</code></a></li>
<li><a href="#_fake_poly"><code>fake-poly</code></a></li>
<li><a href="#_hide_lib_size"><code>hide-lib-size</code></a></li>
<li><a href="#_latest_sha"><code>latest-sha</code></a></li>
<li><a href="#_no_changes"><code>no-changes</code></a></li>
<li><a href="#_no_exit"><code>no-exit</code></a></li>
<li><a href="#_replace"><code>replace</code></a></li>
</ul>
</li>
<li><a href="#_documentation_2">Documentation</a>
<ul class="sectlevel2">
<li><a href="#_diagrams">Diagrams</a></li>
<li><a href="#_cljdoc">Cljdoc</a></li>
<li><a href="#local-cljdoc">Previewing Cljdoc Locally</a></li>
<li><a href="#local">Poly Shell and Local Cljdoc</a></li>
<li><a href="#_refreshing_local_cljdoc_preview">Refreshing Local Cljdoc Preview</a></li>
<li><a href="#_open_page_source_in_github">Open Page Source in GitHub</a></li>
</ul>
</li>
<li><a href="#_referencing_a_local_poly">Referencing a Local <code>poly</code></a></li>
<li><a href="#_snapshot_releases_caching">SNAPSHOT Releases &amp; Caching</a></li>
<li><a href="#visualize-repo">Visualize the repo</a>
<ul class="sectlevel2">
<li><a href="#_install_3">Install</a></li>
<li><a href="#_generate">Generate</a></li>
<li><a href="#create-a-snapshot-release">Create a snapshot release</a></li>
<li><a href="#create-a-stable-release">Create a stable release</a></li>
</ul>
</li>
<li><a href="#_ci">CI</a>
<ul class="sectlevel2">
<li><a href="#_continuous_integration">Continuous Integration</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_continuous_integration_2">Continuous Integration</a>
<ul class="sectlevel1">
<li><a href="#_build_and_release_all">Build and Release All</a></li>
<li><a href="#_build_and_release_for_changed_projects_only">Build and Release for Changed Projects Only</a>
<ul class="sectlevel2">
<li><a href="#_polylith_ci_setup">Polylith CI Setup</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_the_polylith_ci_setup">The Polylith CI setup</a>
<ul class="sectlevel1">
<li><a href="#releases">Releases</a>
<ul class="sectlevel2">
<li><a href="#_final_release">Final release</a></li>
<li><a href="#_snapshot_release">Snapshot release</a></li>
</ul>
</li>
<li><a href="#_deploy_workflow">Deploy Workflow</a>
<ul class="sectlevel2">
<li><a href="#_jobs">Jobs</a>
<ul class="sectlevel3">
<li><a href="#_create_version_txt">create-version-txt</a></li>
<li><a href="#_check">check</a></li>
<li><a href="#_info">info</a></li>
<li><a href="#_test">test</a></li>
<li><a href="#_mark_as_stable">mark-as-stable</a></li>
<li><a href="#_add_version_tag">add-version-tag</a></li>
<li><a href="#_deploy">deploy</a></li>
<li><a href="#_create_artifacts">create-artifacts</a></li>
<li><a href="#_publish_github_release">publish-gitHub-release</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_reference">Reference</a>
<ul class="sectlevel2">
<li><a href="#_commands">Commands</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_commands_2">Commands</a>
<ul class="sectlevel1">
<li><a href="#_check_2">check</a></li>
<li><a href="#_create">create</a></li>
<li><a href="#_create_component">create component</a></li>
<li><a href="#_create_base">create base</a></li>
<li><a href="#_create_project">create project</a></li>
<li><a href="#_create_workspace">create workspace</a></li>
<li><a href="#_deps">deps</a></li>
<li><a href="#_deps_brick">deps :brick</a></li>
<li><a href="#_deps_project">deps :project</a></li>
<li><a href="#_deps_workspace">deps :workspace</a></li>
<li><a href="#_deps_project_brick">deps :project :brick</a></li>
<li><a href="#_diff">diff</a></li>
<li><a href="#_doc_2">doc</a></li>
<li><a href="#_info_2">info</a></li>
<li><a href="#_libs">libs</a></li>
<li><a href="#_overview">overview</a></li>
<li><a href="#_shell_3">shell</a></li>
<li><a href="#_switch_ws">switch-ws</a></li>
<li><a href="#_tap_3">tap</a></li>
<li><a href="#_test_2">test</a></li>
<li><a href="#_version">version</a></li>
<li><a href="#_ws">ws</a>
<ul class="sectlevel2">
<li><a href="#_workspace_structure">Workspace Structure</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_workspace_structure_2">Workspace Structure</a>
<ul class="sectlevel1">
<li><a href="#bases">bases</a></li>
<li><a href="#changes">changes</a></li>
<li><a href="#components">components</a></li>
<li><a href="#configs">configs</a></li>
<li><a href="#interfaces">interfaces</a></li>
<li><a href="#messages">messages</a></li>
<li><a href="#name">name</a></li>
<li><a href="#old">old</a></li>
<li><a href="#paths">paths</a></li>
<li><a href="#profiles">profiles</a></li>
<li><a href="#projects">projects</a></li>
<li><a href="#settings">settings</a></li>
<li><a href="#user-input">user-input</a></li>
<li><a href="#version">version</a></li>
<li><a href="#ws-dir">ws-dir</a></li>
<li><a href="#ws-local-dir">ws-local-dir</a></li>
<li><a href="#ws-reader">ws-reader</a></li>
<li><a href="#ws-type">ws-type</a></li>
<li><a href="#_versions">Versions</a></li>
</ul>
</li>
<li><a href="#_versions_2">Versions</a>
<ul class="sectlevel1">
<li><a href="#_contact">Contact</a></li>
</ul>
</li>
<li><a href="#_contact_2">Contact</a>
<ul class="sectlevel1">
<li><a href="#_license">License</a></li>
</ul>
</li>
<li><a href="#_license_2">License</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="images/logo.png" alt="logo" width="400">
</div>
</div>
<div class="paragraph">
<p><a href="https://cljdoc.org/d/polylith/clj-poly/0.2.20/doc/readme"><span class="image"><img src="https://badgen.net/badge/doc/0.2.20/blue" alt="blue"></span></a>
<a href="https://cljdoc.org/d/polylith/clj-poly/0.3.21-SNAPSHOT"><span class="image"><img src="https://badgen.net/badge/doc/0.3.21-SNAPSHOT%20%232/cyan" alt="cyan"></span></a>
<a href="https://clojurians.slack.com/messages/C013B7MQHJQ"><span class="image"><img src="https://badgen.net/badge/slack/join%20chat/green" alt="green"></span></a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_welcome_to_the_wonderful_world_of_polylith_for_clojure"><a class="link" href="#_welcome_to_the_wonderful_world_of_polylith_for_clojure">Welcome to the wonderful world of Polylith for Clojure!</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Polylith is made by developers for developers.
Our goal is to maximize productivity and increase the quality of the systems we create.
Although Polylith is not a build tool, it integrates into your build pipeline.</p>
</div>
<div class="paragraph">
<p>Polylith, as a concept, is documented <a href="https://polylith.gitbook.io/polylith">here</a>.</p>
</div>
<div class="paragraph">
<p>The documentation you are reading now describes the Polylith tool built for <a href="https://clojure.org/">Clojure</a>, a powerful and simple functional language for the <a href="https://en.wikipedia.org/wiki/Java_virtual_machine">JVM</a>.</p>
</div>
<div class="paragraph">
<p>Polylith introduces the architectural concept of service level building blocks which can be combined like LEGO bricks to build our services and systems.
Polyliths LEGO-like bricks are easy to reason about, test, refactor, and reuse.
They allow us to work with all our code in one place for maximum productivity, from a single <a href="https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop">REPL</a>.</p>
</div>
<div class="paragraph">
<p>We can easily assemble our Polylith bricks into different kinds of deployable artifacts, like services and tools, in the same way we put together LEGO when we were kids!
Not surprisingly, it&#8217;s just as simple and fun!</p>
</div>
<div class="paragraph">
<p>To better understand the principles and ideas behind this tool, we recommend you first read about <a href="https://polylith.gitbook.io/polylith">Polylith as a concept</a>.
At the very least, read <a href="https://polylith.gitbook.io/polylith/introduction/polylith-in-a-nutshell">Polylith in a Nutshell</a>, where concepts like interface, component, base, brick, project, and workspace are introduced.</p>
</div>
<div class="paragraph">
<p>You can then dig into the Clojure Polylith tool <a href="https://cljdoc.org/d/polylith/clj-poly/CURRENT/doc/introduction">introduction</a>.</p>
</div>
<div class="paragraph">
<p>Enjoy the ride!</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sponsor_polylith"><a class="link" href="#_sponsor_polylith">Sponsor Polylith</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Please <a href="https://github.com/sponsors/polyfy">sponsor</a> the important work of Polylith! </p>
</div>
<div class="paragraph">
<p>Iron, Bronze, Silver, Gold, and Platinum sponsors are also listed and on the <a href="https://polylith.gitbook.io/polylith">front page</a> of the Polylith docs.</p>
</div>
<div class="sect2">
<h3 id="_bronze_sponsors"><a class="link" href="#_bronze_sponsors">Bronze Sponsors</a></h3>
<div class="imageblock">
<div class="content">
<a class="image" href="https://www.scrintal.com"><img src="images/sponsors/scrintal.png" alt="scrintal.com" width="200"></a>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_iron_sponsors"><a class="link" href="#_iron_sponsors">Iron Sponsors</a></h3>
<div class="paragraph">
<p><span class="image"><a class="image" href="https://www.adgoji.com"><img src="images/sponsors/adgoji.png" alt="adgoji.com" width="200"></a></span></p>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="https://github.com/taehee-sp"><img src="images/sponsors/taehee-sp.png" alt="taehee sp" width="150"></a></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_polylith_fans"><a class="link" href="#_polylith_fans">Polylith Fans</a></h3>
<div class="paragraph">
<p><span class="image left"><a class="image" href="https://github.com/yyna"><img src="https://avatars.githubusercontent.com/u/18068051" alt="Jungin Kwon" width="32"></a></span>
<span class="image left"><a class="image" href="https://github.com/fluent-development"><img src="https://avatars.githubusercontent.com/u/59614667" alt="Multiply" width="32"></a></span>
<span class="image left"><a class="image" href="https://github.com/anieri"><img src="https://avatars.githubusercontent.com/u/6353427" alt="Anieri" width="32"></a></span>
<span class="image left"><a class="image" href="https://github.com/john-shaffer"><img src="https://avatars.githubusercontent.com/u/53870456" alt="John Shaffer" width="32"></a></span>
<span class="image left"><a class="image" href="https://github.com/tlonist-sang"><img src="https://avatars.githubusercontent.com/u/47784846?v=4" alt="Sanghyun Kim" width="32"></a></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_polylith_friends"><a class="link" href="#_polylith_friends">Polylith Friends</a></h3>
<div class="paragraph">
<p><span class="image left"><a class="image" href="https://github.com/seancorfield"><img src="https://avatars.githubusercontent.com/u/43875" alt="Sean Corfield" width="32"></a></span>
<span class="image left"><a class="image" href="https://github.com/namenu"><img src="https://avatars.githubusercontent.com/u/243097" alt="Hyunwoo Nam" width="32"></a></span>
<span class="image left"><a class="image" href="https://github.com/premiscale"><img src="https://avatars.githubusercontent.com/u/120519034?s=200&amp;v=4" alt="PremiScale" width="32"></a></span></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction"><a class="link" href="#_introduction">Introduction</a></h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_introduction_2"><a class="link" href="#_introduction_2">Introduction</a></h2>
<div class="sectionbody">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For a richer experience, we recommend reading on <a href="https://cljdoc.org/d/polylith/clj-poly/CURRENT/doc/introduction">cljdoc</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This documentation is a practical guide to the <code>poly</code> tool.</p>
</div>
<div class="paragraph">
<p>We include many code examples.
They act as an ongoing tutorial as you read sequentially through the documentation.
We encourage you to follow the tutorial examples and try them out yourself.
For your convenience, we provide the end result <a href="/examples/doc-example">here</a>.</p>
</div>
<div class="paragraph">
<p>We will guide you through the steps of creating a workspace with projects composed of components, bases, and libraries and how to work with them from the development environment and the interactive shell.</p>
</div>
<div class="paragraph">
<p>We will give a short introduction to tools.deps and how to use tools.build to create deployable artifacts.
We will explain how git is used to tag the code and how it enables us to test and release the code incrementally.</p>
</div>
<div class="paragraph">
<p>We will show how profiles will help us work from a single development environment for maximum efficiency and how dependencies and library usage can be displayed.</p>
</div>
<div class="paragraph">
<p>We will explain the value of components and how they bring context to our development experience, which will help us build decoupled and scalable systems from day one.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s begin!</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_install"><a class="link" href="#_install">Install</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_install_2" class="sect0"><a class="link" href="#_install_2">Install</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>There are two ways to install the <code>poly</code> tool:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 27.027%;">
<col style="width: 36.4864%;">
<col style="width: 36.4866%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">1. Stand-alone</th>
<th class="tableblock halign-left valign-top">2. <a href="#use-as-dependency">Clojure CLI dep</a></th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Example usage:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>poly help</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>clojure -M:poly help</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Installed via:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">Homebrew on macOS, otherwise via Nix or a manual download</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adding a <code>:poly</code> alias in <code>./deps.edn</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Can be invoked from:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any directory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Polylith <a href="#">workspace</a> directory</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Switch <code>poly</code> version via:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@&lt;version&gt;</code> if using HomeBrew</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Updating dependency for <code>:poly</code> alias in <code>./deps.edn</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-compiled for faster startup? <a href="#startup-time"><sup>1</sup></a></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table Notes:</p>
</div>
<div id="startup-time" class="olist arabic">
<ol class="arabic">
<li>
<p>If you follow our recommendation of using the <code>poly</code> <a href="#">shell</a>, startup time is not much of a concern.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="install-on-mac"><a class="link" href="#install-on-mac">Install as Stand-alone on macOS</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, ensure that you have <a href="https://clojure.org/guides/getting_started">Clojure CLI</a> and <a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">git</a> installed. If you are installing git for the first time, don&#8217;t forget to configure your git <a href="https://docs.github.com/en/get-started/getting-started-with-git/setting-your-username-in-git">user.name</a> and <a href="https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-personal-account-on-github/managing-email-preferences/setting-your-commit-email-address#setting-your-commit-email-address-in-git">user.email</a>.</p>
</div>
<div class="paragraph">
<p>To install the <code>poly</code> tool on macOS, run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">brew install polyfy/polylith/poly</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>poly</code> <a href="https://github.com/polyfy/polylith/blob/master/build/resources/brew/exec">script</a> is now installed and added to the system path.
The script uses Java to launch the poly tool.</p>
</div>
<div class="paragraph">
<p>If you get an error such as "openjdk-13.0.2.jdk could not be opened&#8230;&#8203;", try:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Open MacOS <code>System Preferences &gt; Security &amp; Privacy &gt; General</code>.</p>
</li>
<li>
<p>Click Allow at the bottom for <code>openjdk-13.0.2.jdk</code>.</p>
</li>
<li>
<p>Run <code>brew install polyfy/polylith/poly</code> again.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Verify the installation by running <code>poly help</code>.</p>
</div>
<div class="paragraph">
<p>You will soon create your first <a href="workspace.html">workspace</a> - for now, only <code>version</code>, <code>help</code>, <code>doc</code>, and <code>create workspace</code> commands will work.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="install-on-linux"><a class="link" href="#install-on-linux">Install as Stand-alone on Linux</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, ensure that you have <a href="https://clojure.org/guides/getting_started">Clojure CLI</a> and <a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">git</a> installed. If you are installing git for the first time, don&#8217;t forget to configure your git <a href="https://docs.github.com/en/get-started/getting-started-with-git/setting-your-username-in-git">user.name</a> and <a href="https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-personal-account-on-github/managing-email-preferences/setting-your-commit-email-address#setting-your-commit-email-address-in-git">user.email</a>.</p>
</div>
<div class="paragraph">
<p>To install the <code>poly</code> tool on Linux:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Download the <a href="https://github.com/polyfy/polylith/releases/latest">latest release</a> of the poly jar, e.g.: <code>poly-0.2.18.jar</code>.</p>
</li>
<li>
<p>Create a directory, e.g., <code>/usr/local/polylith</code>, and copy the jar file to that directory.</p>
</li>
<li>
<p>Create a file <code>poly</code> under e.g., <code>/usr/local/bin</code> containing:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#!/bin/sh

ARGS=""
while [ "$1" != "" ] ; do
 ARGS="$ARGS $1"
 shift
done

exec "/usr/bin/java" $JVM_OPTS "-jar" "/usr/local/polylith/poly-0.2.18.jar" $ARGS</code></pre>
</div>
</div>
</li>
<li>
<p>Make sure that:</p>
<div class="ulist">
<ul>
<li>
<p>You are referencing the correct jar file.</p>
</li>
<li>
<p>The path to <code>java</code> is correct (verify with <code>which java</code>).</p>
</li>
</ul>
</div>
</li>
<li>
<p>If you chose <code>/usr/local/bin</code>, it is probably already on your system path.
Otherwise, adjust your system path as necessary.</p>
</li>
<li>
<p>Make <code>poly</code> executable via <code>chmod +x /usr/local/bin/poly</code> (adjust path as necessary).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Verify the installation by running <code>poly help</code>.</p>
</div>
<div class="paragraph">
<p>You will soon create your first <a href="workspace.html">workspace</a> - for now, only <code>version</code>, <code>help</code>, <code>doc</code>, and <code>create workspace</code> commands will work.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="install-on-windows"><a class="link" href="#install-on-windows">Install Stand-alone on Windows</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, ensure that you have <a href="https://clojure.org/guides/getting_started">Clojure CLI</a> and <a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">git</a> installed. If you are installing git for the first time, don&#8217;t forget to configure your git <a href="https://docs.github.com/en/get-started/getting-started-with-git/setting-your-username-in-git">user.name</a> and <a href="https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-personal-account-on-github/managing-email-preferences/setting-your-commit-email-address#setting-your-commit-email-address-in-git">user.email</a>.</p>
</div>
<div class="sect2">
<h3 id="_troubleshooting_clojure_cli_install_on_windows"><a class="link" href="#_troubleshooting_clojure_cli_install_on_windows">Troubleshooting Clojure CLI Install on Windows</a></h3>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you are running on Windows, you might prefer to use the more user-friendly <a href="https://github.com/casselc/clj-msi">clj-msi</a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Windows users should also consider using WSL and then follow instructions under <a href="#install-on-linux">Install as Stand-alone on Linux</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you have installed Clojure&#8217;s Powershell module and see an error like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">clj : The 'clj' command was found in the module 'ClojureTools', but the module could not be loaded.
For more information, run 'Import-Module ClojureTools'.</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;and if you followed the instruction and executed this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">Import-Module ClojureTools</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;and got this error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">Import-Module : File C:\Users\Admin\Documents\WindowsPowerShell\Modules\ClojureTools\ClojureTools.psm1
cannot be loaded because running scripts is disabled on this system. For more information,
see about_Execution_Policies at https:/go.microsoft.com/fwlink/?LinkID=135170.</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;then try this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_install_the_poly_tool"><a class="link" href="#_install_the_poly_tool">Install the poly tool</a></h3>
<div class="ulist">
<ul>
<li>
<p>Download the <a href="https://github.com/polyfy/polylith/releases/latest">latest release</a> of the poly jar, e.g., <code>poly-0.2.18.jar</code>.</p>
</li>
<li>
<p>Create a <code>Polylith</code> directory, e.g., <code>C:\Program Files\Polylith</code>, and copy the poly jar file to that directory.</p>
</li>
<li>
<p>In the same directory, create file <code>poly.bat</code> containing:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">@echo off
start /wait /b java %JAVA_OPTS% -jar "C:\Program Files\Polylith\poly-0.2.18.jar" %*</code></pre>
</div>
</div>
<div class="paragraph">
<p>Double-check that it references the correct poly jar.</p>
</div>
</li>
<li>
<p>Add <code>C:\Program Files\Polylith</code> to the Windows <code>Path</code> environment variable.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Test the installation by typing <code>poly help</code> from the command line.</p>
</div>
<div class="paragraph">
<p>You will soon create your first <a href="workspace.html">workspace</a> - for now, only <code>version</code>, <code>help</code>, <code>doc</code>, and <code>create workspace</code> commands will work.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#">coloring</a> of text is not supported on Windows.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="install-via-nix"><a class="link" href="#install-via-nix">Install as Stand-alone via Nix</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, ensure that you have <a href="https://clojure.org/guides/getting_started">Clojure CLI</a> and <a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">git</a> installed. If you are installing git for the first time, don&#8217;t forget to configure your git <a href="https://docs.github.com/en/get-started/getting-started-with-git/setting-your-username-in-git">user.name</a> and <a href="https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-personal-account-on-github/managing-email-preferences/setting-your-commit-email-address#setting-your-commit-email-address-in-git">user.email</a>.</p>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool is installable from <a href="https://github.com/NixOS/nixpkgs/blob/master/pkgs/development/tools/misc/polylith/default.nix">nixpkgs</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">nix-shell -p polylith
# or
nix-env -iA 'nixos.polylith'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Test the installation by typing <code>poly help</code> from the command line.</p>
</div>
<div class="paragraph">
<p>You will soon create your first <a href="workspace.html">workspace</a> - for now, only <code>version</code>, <code>help</code>, <code>doc</code>, and <code>create workspace</code> commands will work.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="use-as-dependency"><a class="link" href="#use-as-dependency">Use as Dependency</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>An alternative way to run the <code>poly</code> tool is as a dependency from the <code>:poly</code> alias in your <code>./deps.edn</code> file.</p>
</div>
<div class="paragraph">
<p>First, ensure that you have <a href="https://clojure.org/guides/getting_started">Clojure CLI</a> and <a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">git</a> installed. If you are installing git for the first time, don&#8217;t forget to configure your git <a href="https://docs.github.com/en/get-started/getting-started-with-git/setting-your-username-in-git">user.name</a> and <a href="https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-personal-account-on-github/managing-email-preferences/setting-your-commit-email-address#setting-your-commit-email-address-in-git">user.email</a>.</p>
</div>
<div class="paragraph">
<p>After you have created a Polylith <a href="#">workspace</a>, you&#8217;ll notice a <code>./deps.edn</code> file was automatically generated.
It includes a <code>:poly</code> alias.
It will look something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure"> :aliases {:poly {:extra-deps {polylith/clj-poly {:mvn/version "0.2.18"}}
                  :main-opts  ["-m" "polylith.clj.core.poly-cli.core"]}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Feel free to adjust the <code>:mvn/version</code> to suit your needs.
For example, you might want to try out the latest <code>SNAPSHOT</code> version.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Docs for <code>SNAPSHOT</code> releases are also available on cljdoc.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Navigate to your newly created workspace directory and verify via <code>clojure -M:poly help</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you have no interest in using any stand-alone variant of <code>poly</code> and want to use <code>poly</code> only as a dependency, see <a href="#bootstrap">Bootstrapping a Workspace</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more details on how <code>poly</code> is released, see docs on <a href="#releases">releases</a>.</p>
</div>
<div class="sect2">
<h3 id="github-dependency"><a class="link" href="#github-dependency">Using a Git Dependency</a></h3>
<div class="paragraph">
<p>If you wish, you can specify a git dep revision from the GitHub Polylith project.
To do so, you&#8217;d adjust your <code>./deps.edn</code> <code>:poly</code> alias to something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure"> :aliases {:poly {:extra-deps {polylith/clj-poly
                               {:git/url   "https://github.com/polyfy/polylith.git"
                                :sha       "INSERT-SHA-HERE"
                                :deps/root "projects/poly"}}
                  :main-opts  ["-m" "polylith.clj.core.poly-cli.core"]}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Replace <code>INSERT-SHA-HERE</code> with a commit SHA from the Polylith repository, for example:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From the <a href="https://github.com/polyfy/polylith/commits/master">latest commit</a> from the <code>master</code> branch.
(Alternatively, you can specify the latest <code>SNAPSHOT</code> release as a maven dependency)</p>
</li>
<li>
<p>Or some commit SHA from a work-in-progress branch you want to try</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_specifying_logging_libraries"><a class="link" href="#_specifying_logging_libraries">Specifying Logging Libraries</a></h3>
<div class="paragraph">
<p>You can add in the logging libraries you&#8217;d like to use with <code>poly</code> by adjusting your <code>:poly</code> alias in your <code>./deps.edn</code> like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure"> :aliases {:poly {:extra-deps {polylith/clj-poly {:mvn/version "{poly-version}"}
                               ;; your logging libraries here:
                               org.apache.logging.log4j/log4j-api {:mvn/version "2.20.0"}
                               org.apache.logging.log4j/log4j-slf4j-impl {:mvn/version "2.20.0"}}
                  :main-opts  ["-m" "polylith.clj.core.poly-cli.core"]}}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_use_as_a_library"><a class="link" href="#_use_as_a_library">Use as a library</a></h2>
<div class="sectionbody">
<div id="use-as-a-library" class="paragraph">
<p>The <code>poly</code> functionality can also be accessed as a library.
The API is documented <a href="https://cljdoc.org/d/polylith/clj-poly/CURRENT/api/polylith">here</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jvm-options"><a class="link" href="#jvm-options">JVM options</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>You might want to specify more RAM to the <code>poly</code> tool and/or where the configuration file for logging is located.
These can be conveyed via the <code>JVM_OPTS</code> environment variable which <code>poly</code> will passes along to the Java runtime at launch of poly stand-alone.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_upgrade"><a class="link" href="#_upgrade">Upgrade</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_upgrade_2" class="sect0"><a class="link" href="#_upgrade_2">Upgrade</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>If the <code>poly</code> tool has been <a href="#">installed</a>, it can be upgraded.</p>
</div>
<div class="paragraph">
<p>Polylith&#8217;s releases are found and described on our <a href="https://github.com/polyfy/polylith/releases">releases page</a>.
We document our release strategy in detail <a href="#release">here</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stand_alone_macos"><a class="link" href="#_stand_alone_macos">Stand-alone macOS</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use standard brew package upgrade techniques.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">brew upgrade poly</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or, optionally, specify the tap:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">brew upgrade polyfy/polylith/poly</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stand_alone_linux"><a class="link" href="#_stand_alone_linux">Stand-alone Linux</a></h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download the <a href="https://github.com/polyfy/polylith/releases/latest">latest release</a>, e.g. <code>poly-0.2.18.jar</code>.</p>
</li>
<li>
<p>Update the <code>poly</code> shell script you created during <a href="#install-on-linux">installation</a> to reference the new jar.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stand_alone_windows"><a class="link" href="#_stand_alone_windows">Stand-alone Windows</a></h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download the <a href="https://github.com/polyfy/polylith/releases/latest">latest release</a>, e.g. <code>poly-0.2.18.jar</code>.</p>
</li>
<li>
<p>Update the <code>poly.bat</code> file you created during <a href="#install-on-windows">installation</a> to reference the new jar.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stand_alone_nix"><a class="link" href="#_stand_alone_nix">Stand-alone Nix</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use standard Nix upgrade techniques.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">nix-channel --update</code></pre>
</div>
</div>
<div class="paragraph">
<p>Followed by:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">nix-env -u polylith</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_as_dependency"><a class="link" href="#_as_dependency">As Dependency</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Update your <code>polylith/clj-poly</code> dependency in your <code>./deps.edn</code> to the current version.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_example_systems"><a class="link" href="#_example_systems">Example Systems</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_example_systems_2" class="sect0"><a class="link" href="#_example_systems_2">Example Systems</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>If you are curious about what a full-blown system looks like in Polylith, look at the examples listed here.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>info</code>, <code>deps</code>, and <code>libs</code> reports on this page were generated with <a href="#">polyx</a> and its <a href="#overview">overview</a> command.
We cover <code>polyx</code> and these reports later in the documentation.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_realworld"><a class="link" href="#_realworld">RealWorld</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="image"><a class="image" href="images/example-systems/realworld.png"><img src="images/example-systems/realworld.png" alt="realworld"></a></span></p>
</div>
<div class="paragraph">
<p><a href="https://github.com/furkan3ayraktar">Furkan Bayraktar</a> has made a full-blown <a href="https://github.com/furkan3ayraktar/clojure-polylith-realworld-example-app">RealWorld</a> web application, which can be compared with <a href="https://github.com/gothinkster/realworld">implementations made in other languages</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_usermanager"><a class="link" href="#_usermanager">Usermanager</a></h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<a class="image" href="images/example-systems/user-manager.png"><img src="images/example-systems/user-manager.png" alt="user manager"></a>
</div>
</div>
<div class="paragraph">
<p><a href="https://github.com/seancorfield">Sean Corfield</a> has made a full-blown <a href="https://github.com/seancorfield/usermanager-example/tree/polylith">usermanager</a> web application, which can be compared with non-Polylith systems living in other branches of the repository, .</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_demo_rama_electric"><a class="link" href="#_demo_rama_electric">Demo Rama Electric</a></h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<a class="image" href="images/example-systems/demo-rama-electric.png"><img src="images/example-systems/demo-rama-electric.png" alt="demo rama electric"></a>
</div>
</div>
<div class="paragraph">
<p><a href="https://github.com/jeans11">Jean Boudet</a> has made a <a href="https://github.com/jeans11/demo-rama-electric">demo web app</a> to show the use of Rama and Electric together.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="integrant-system"><a class="link" href="#integrant-system">Integrant system</a></h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<a class="image" href="images/example-systems/integrant-system.png"><img src="images/example-systems/demo-rama-electric.png" alt="demo rama electric"></a>
</div>
</div>
<div class="paragraph">
<p><a href="https://github.com/marksto">Mark Sto</a> has made a small <a href="https://github.com/polyfy/polylith/tree/master/examples/integrant-system">example system</a> to show how you can use <a href="https://github.com/weavejester/integrant">Integrant</a> in Polylith.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_game_of_life"><a class="link" href="#_game_of_life">Game of Life</a></h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<a class="image" href="images/example-systems/game-of-life.png"><img src="images/example-systems/game-of-life.png" alt="game of life"></a>
</div>
</div>
<div class="paragraph">
<p><a href="https://github.com/tengstrand">Joakim Tengstrand</a> has made a small Game of life <a href="https://github.com/tengstrand/game-of-life">example app</a> to show what a tiny Polylith system can look like.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_production_systems"><a class="link" href="#_production_systems">Production Systems</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_production_systems_2" class="sect0"><a class="link" href="#_production_systems_2">Production Systems</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>Here, we list some companies that use Polylith in production.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>info</code>, <code>deps</code>, and <code>libs</code> reports on this page were generated with <a href="#">polyx</a> and its <a href="#overview">overview</a> command.
We cover <code>polyx</code> and these reports later in the documentation.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scrintal"><a class="link" href="#_scrintal">Scrintal</a></h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<a class="image" href="images/production-systems/scrintal.png"><img src="images/production-systems/scrintal.png" alt="scrintal"></a>
</div>
</div>
<div class="paragraph">
<p><a href="http://scrintal.com">Scrintal&#8217;s</a> first commit dates back to April 2019 and the workspace has used Polylith since day one.
Polylith enabled us to experiment fast locally and ship features easily.
The complete buy-in to Polylith paid off when we started pivoting our product at the end of 2020, as even though we are changing it to a completely new product, most bricks can be shared and reused across all our products.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_world_singles_networks"><a class="link" href="#_world_singles_networks">World Singles Networks</a></h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<a class="image" href="images/production-systems/world-singles-networks.png"><img src="images/production-systems/world-singles-networks.png" alt="world singles networks"></a>
</div>
</div>
<div class="paragraph">
<p>Connecting hearts all over the world.</p>
</div>
<div class="paragraph">
<p><a href="https://worldsinglesnetworks.com">World Singles Networks</a> have helped make 4.9 million human connections, on more than 100 web properties, in every country on the planet.
The entire back end of our online dating platform is built with Clojure and we&#8217;ve been using it in production for over a decade.</p>
</div>
<div class="paragraph">
<p>Our migration to Polylith started in April, 2021 and completed in December, 2022.
Our codebase is 136K lines of Clojure.
Polylith has enabled us to increase modularity, reduce coupling, improve testability,
and focus more on the importance of naming&#8201;&#8212;&#8201;making it easier to find existing code and to decide where new code should live.</p>
</div>
<div class="paragraph">
<p>The concept of "swappable implementations" for component interfaces has allowed us to more easily share code between a variety of applications that need to run in difference contexts, such as running without a database, or on older JVMs.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_greenlabs"><a class="link" href="#_greenlabs">Greenlabs</a></h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<a class="image" href="images/production-systems/greenlabs.png"><img src="images/production-systems/greenlabs.png" alt="greenlabs"></a>
</div>
</div>
<div class="paragraph">
<p><a href="https://greenlabs.co.kr">Greenlabs</a> is an agtech startup located in Seoul, South Korea.</p>
</div>
<div class="paragraph">
<p>We have been using Clojure since 2020 and adopted Polylith in March 2022.
Our codebase is 93K lines of Clojure.
We have chosen an event-driven architecture for backend systems, with Kafka at the center and a bunch of AWS Lambdas around it.
Thanks to Polylith, we&#8217;ve been able to easily manage and deploy multiple serverless projects from a single repository. It&#8217;s especially helpful for modularizing code and understanding dependencies.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_polylith"><a class="link" href="#_polylith">Polylith</a></h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<a class="image" href="images/production-systems/polylith.png"><img src="images/production-systems/polylith.png" alt="polylith"></a>
</div>
</div>
<div class="paragraph">
<p>Polylith is mainly developed on a non-profit basis by Joakim Tengstrand with help from Furkan Bayraktar, James Trunk, and other contributors.</p>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/polyfy/polylith">polylith</a> codebase itself is structured as a Polylith workspace.
We made our initial commit on June 9, 2019.
The Polylith way of working gives us a range of benefits, such as decoupled building blocks that are easy to find, change, reuse, and reason about.
We combine these building blocks to create the <code>poly</code> and <code>polyx</code> command line tools, and the <code>clj-poly</code> library.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_add_your_company_here"><a class="link" href="#_add_your_company_here">Add your Company Here!</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Please get in touch with us if you use Polylith and don&#8217;t see your company here!</p>
</div>
<div class="paragraph">
<p>To be added, create an overview image with the <a href="#">polyx</a> command (from the workspace root):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">clojure -M:polyx overview out:yourcompanyname.png :no-changes</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;or export the workspace to a file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">clojure -M:poly ws out:yourcompanyname.edn :no-changes</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then email the file to joakim.tengstrand(at)gmail.com with a brief description of your experience with Polylith and a link to your company.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_workspace"><a class="link" href="#_workspace">Workspace</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_workspace_2" class="sect0"><a class="link" href="#_workspace_2">Workspace</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>The workspace directory is where all your code and most of your <a href="#">configuration</a> lives.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Unless otherwise noted, our examples assume <code>poly</code> is <a href="#">installed</a> as a stand-alone tool.
Adjust your command line if you&#8217;ve installed <code>poly</code> differently.</p>
</div>
<div class="paragraph">
<p>See also: <a href="#bootstrap">Bootstrapping a Workspace</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s start our <a href="#">tutorial</a> by creating an example workspace with a top namespace of <code>se.example</code> using the <a href="#create-workspace">create workspace</a> command.
By default, this command also creates a git repository, so execute it outside any existing git repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly create workspace name:example top-ns:se.example branch:main :commit</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool has created an <code>example</code> workspace in the <code>main</code> branch of a new git repository and committed all files.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>se.example</code> top namespace is just an example.
Stick with this name when following this example, but choose whatever name makes sense when creating your own Polylith workspaces.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the <code>branch</code> parameter is not provided, the default branch will be used. You can retrieve the default branch name using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">git var GIT_DEFAULT_BRANCH</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Your workspace directory structure should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example                # Workspace dir
 .git/              # Git repository dir
 .gitignore         # Files and dirs git should ignore
 .vscode/
    settings.json  # Configuration for Calva
 bases/             # Dir for poly bases
 components/        # Dir for poly components
 deps.edn           # Config for development project
 development/
    src/           # Development project sources
 logo.png           # Polylith logo
 projects/          # Dir for deployable projects
 readme.md          # Documentation
 workspace.edn      # Workspace config file</code></pre>
</div>
</div>
<div class="paragraph">
<p>We designed the directory structure for quick navigation and ease of use.
Your service-level building blocks are easy to find and understand, which helps you to reason about your system at a higher level.</p>
</div>
<div class="paragraph">
<p>Each top-level directory contains a specific Polylith concept:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <a href="#">base</a> is a building block that exposes a public API to the outside world, e.g., external systems and users.</p>
</li>
<li>
<p>A <a href="#">component</a> is a building block that encapsulates a specific domain or part of the system.</p>
</li>
<li>
<p>A <a href="#">project</a> specifies a deployable artifact and what components and bases it contains.</p>
</li>
<li>
<p>The <a href="#">development</a> project (<code>development/</code> + <code>deps.edn</code>) supports working on all code from one place.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure gives a consistent shape to all Polylith projects.
The familiar convention ensures that all developers, be they new or veterans, will quickly get started on Polylith systems that are new to them.
We think you will fall in love with the power and simplicity the Polylith structure gives to your projects!</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>The <code>bases</code>, <code>components</code>, and <code>projects</code> directories include a <code>.keep</code> file.
This file ensures that git tracks these otherwise empty directories.
You can delete the <code>.keep</code> files after you add other files.</p>
</div>
</div>
</div>
<div id="workspace-edn" class="paragraph">
<p>The <code>workspace.edn</code> file looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:top-namespace "se.example"
 :interface-ns "interface"
 :default-profile-name "default"
 :compact-views #{}
 :vcs {:name "git"
       :auto-add false}
 :tag-patterns {:stable "stable-*"
                :release "v[0-9]*"}
 :projects {"development" {:alias "dev"}}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>deps.edn</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:aliases  {:dev {:extra-paths ["development/src"] <i class="conum" data-value="1"></i><b>(1)</b>
                  :extra-deps {org.clojure/clojure {:mvn/version "1.11.1"}}}

            :test {:extra-paths []} <i class="conum" data-value="2"></i><b>(2)</b>

            :poly {:main-opts ["-m" "polylith.clj.core.poly-cli.core"] <i class="conum" data-value="3"></i><b>(3)</b>
                   :extra-deps {polyfy/clj-poly {:mvn/version "0.2.18"}}}}}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>:dev</code> alias supports your Polylith development environment</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>:test</code> alias supports your tests</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>:poly</code> alias allows you to run <code>poly</code> as a local dependency, e.g., <code>clj -M:poly version</code>, and isn&#8217;t used by <code>poly</code> stand-alone.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sub-workspaces"><a class="link" href="#sub-workspaces">Existing git Repository</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can also create a Polylith workspace inside an existing git repo.
There are two ways to do this.
Either you create the workspace directly at the root of the git repository (without giving a workspace name) by executing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">cd my-git-repo-dir
poly create workspace top-ns:com.mycompany</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;which results in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">my-git-repo-dir
 bases
 components
 deps.edn
 development
 projects
 workspace.edn</code></pre>
</div>
</div>
<div id="workspace-root-under-git-root" class="paragraph">
<p>&#8230;&#8203;or you create the workspace in a directory under the git repository root by executing e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">cd my-git-repo-dir
poly create workspace name:my-workspace top-ns:com.mycompany</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;which result in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">my-git-repo-dir
 my-workspace
     bases
     components
     deps.edn
     development
     projects
     workspace.edn</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the above examples you&#8217;ll notice we ommitted the <code>:commit</code> option.
It is not supported when creating a workspace in an existing git repository.
You&#8217;ll have to commit your new workspace files yourself.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To execute a command, you need to be at the root of your workspace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">cd my-workspace
poly info</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bootstrap"><a class="link" href="#bootstrap">Bootstrapping a Workspace</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you don&#8217;t have a stand-alone version of <code>poly</code> <a href="#">installed</a> and prefer to use <code>poly</code> <a href="#use-as-dependency">as a dependency</a>, you can bootstrap your workspace.</p>
</div>
<div class="paragraph">
<p>All techniques above still apply, but you will instead create a workspace like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">clojure -Sdeps '{:deps {polylith/clj-poly {:mvn/version "RELEASE"}}}' \
        -M -m  polylith.clj.core.poly-cli.core \
        create workspace name:example top-ns:se.example :commit</code></pre>
</div>
</div>
<div class="paragraph">
<p>And now you can use <code>poly</code> as a dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">cd example
clojure -M:poly info</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_development"><a class="link" href="#_development">Development</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_development_2" class="sect0"><a class="link" href="#_development_2">Development</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>When working with a Polylith codebase, you are free to choose any editor/IDE you like, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.gnu.org/software/emacs/">Emacs</a> with <a href="https://cider.mx/">Cider</a></p>
</li>
<li>
<p><a href="https://code.visualstudio.com/">VSCode</a> with <a href="https://marketplace.visualstudio.com/items?itemName=betterthantomorrow.calva">Calva</a></p>
</li>
<li>
<p><a href="https://www.jetbrains.com/idea/">IntelliJ IDEA</a> with <a href="https://cursive-ide.com/">Cursive</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_generic_setup"><a class="link" href="#_generic_setup">Generic Setup</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>We only currently specifically describe <a href="#idea-cursive">IntelliJ IDEA with Cursive Setup</a>.</p>
</div>
<div class="paragraph">
<p>If you are using a different IDE, here&#8217;s the generic goals:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Setup your IDE&#8217;s REPL to startup with <code>dev</code> and <code>test</code> aliases</p>
</li>
<li>
<p>Notice that your <code>./deps.edn</code> already has <code>development/src</code> on the path for the <code>dev</code> alias</p>
</li>
<li>
<p>Add sample source <code>development/src/dev/lisa.clj</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns dev.lisa)

(+ 1 2 3)</code></pre>
</div>
</div>
</li>
<li>
<p>Evaluate <code>dev.lisa</code> in your IDE REPL to test.</p>
</li>
<li>
<p>Celebrate a successful IDE setup!</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="idea-cursive"><a class="link" href="#idea-cursive">IntelliJ IDEA with Cursive Setup</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here, we share some specific setup instructions when using Cursive.</p>
</div>
<div class="sect2">
<h3 id="_cursive_setup"><a class="link" href="#_cursive_setup">Cursive Setup</a></h3>
<div class="paragraph">
<p>First, make sure you have <a href="https://cursive-ide.com/userguide/deps.html">tools.deps</a> configured correctly.</p>
</div>
<div class="paragraph">
<p>To import a Polylith <a href="#">workspace</a> as a project:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select <code>File &gt; New &gt; Project from Existing Sources&#8230;&#8203;</code> from the menu.</p>
</li>
<li>
<p>A wizard will guide you through the import:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Start with selecting the <code>./deps.edn</code> file</p>
</li>
<li>
<p>When asked, choose your desired version of the Java SDK</p>
</li>
<li>
<p>Otherwise, hit <code>Next</code> and finally <code>Create</code>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you are using Cursive <code>1.13.0</code> or later, follow the instructions <a href="https://cursive-ide.com/userguide/polylith.html">here</a>.</p>
</div>
<div class="paragraph">
<p>From the <code>Clojure Deps</code> tab (by default, it&#8217;s on the far right), enable <code>dev</code> under <code>Aliases</code>, then press the icon with two arrows to refresh:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/development/activate-dev-alias.png" alt="activate dev alias" width="250">
</div>
</div>
<div class="paragraph">
<p>To create a REPL, select <code>Current File &gt; Edit Configurations&#8230;&#8203;</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/development/edit-configuration.png" alt="edit configuration" width="200">
</div>
</div>
<div class="paragraph">
<p>Then click the <code>+</code> sign and select <code>Clojure REPL &gt; Local</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/development/create-local-repl.png" alt="create local repl" width="250">
</div>
</div>
<div class="paragraph">
<p>Configure like so:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Name:</code> type <code>REPL</code></p>
</li>
<li>
<p><code>Which type of REPL to run</code> choose <code>nREPL</code></p>
</li>
<li>
<p><code>How to run it</code> choose <code>Run with Deps</code></p>
<div class="ulist">
<ul>
<li>
<p><code>Options:</code> type <code>-A:dev:test</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>Common Options &gt; Module:</code> select your Polylith workspace directory, e.g., <code>example</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Press <code>OK</code>. Now start the REPL in debug mode by clicking the bug icon:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/development/debug.png" alt="debug" width="150">
</div>
</div>
<div class="paragraph">
<p>Under the <code>REPL</code> view, you should soon see something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">Clojure 1.11.1
nREPL server started on port 56855 on host localhost - nrepl://localhost:56855</code></pre>
</div>
</div>
<div class="paragraph">
<p>You have configured everything <a href="https://github.com/clojure/tools.deps">tools.deps</a> needs and are ready to write some Clojure code!</p>
</div>
</div>
<div class="sect2">
<h3 id="_trying_out_your_development_environment"><a class="link" href="#_trying_out_your_development_environment">Trying Out Your Development Environment</a></h3>
<div class="paragraph">
<p>Look at the generated <code>./deps.edn</code> file.
Notice that it already includes <code>development/src</code> on the path under the <code>:dev</code> alias:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell"> :aliases  {:dev {:extra-paths ["development/src"]</code></pre>
</div>
</div>
<div class="paragraph">
<p>(You might remember we had you enable the <code>dev</code> alias above under <code>Clojure Deps</code> and for the REPL via <code>-A:dev:test</code>.)</p>
</div>
<div class="paragraph">
<p>To get started, create a dev namespace.
We suggest you use <code>dev</code> as a top namespace here, not your <a href="#">workspace</a> top namespace.
This strategy keeps your production code entirely separate from your development code.</p>
</div>
<div class="paragraph">
<p>One way to structure dev code is to give each developer their own namespace under <code>dev</code>.
Following this pattern, create the namespace <code>dev.lisa</code>:<br>
Right-click on the <code>development/src</code> directory, select <code>New &gt; Clojure Namespace</code>, and type <code>dev.lisa</code>.</p>
</div>
<div id="cursive-enable-auto-add" class="paragraph">
<p>A dialog will pop up and ask you if you want to add the file to git:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/development/add-file-to-git.png" alt="add file to git" width="600">
</div>
</div>
<div class="paragraph">
<p>Check <code>Don&#8217;t ask again</code> and click the <code>Add</code> button.</p>
</div>
<div class="paragraph">
<p>If the namespace is not recognized, you may need to click the icon with two arrows under the <code>Clojure Deps</code> tab to refresh:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/development/refresh.png" alt="refresh" width="150">
</div>
</div>
<div class="paragraph">
<p>Now you can write some code in <code>lisa.clj</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns dev.lisa)

(+ 1 2 3)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Load the namespace by sending <code>(ns dev.lisa)</code> to the REPL.</p>
</div>
<div class="paragraph">
<p>Send <code>(+ 1 2 3)</code> to the REPL.
You should see <code>6</code> in the REPL view.</p>
</div>
<div class="paragraph">
<p>Congratulations, you now have a working development environment!</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_component"><a class="link" href="#_component">Component</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_component_2" class="sect0"><a class="link" href="#_component_2">Component</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>If you have been following our <a href="#">tutorial</a>, you should now have:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An example <a href="#">workspace</a></p>
</li>
<li>
<p>A working <a href="#">development</a> environment</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You will soon create your first component.
But before you do that, open <code>workspace.edn</code> in your editor and set <code>:auto-add</code> to <code>true</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure"> :vcs {:name "git"
       :auto-add true}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>:auto-add</code> option tells <code>poly</code> to automatically add files generated by the <a href="#create">create</a> command to <a href="#">git</a>.
This behavior will be helpful in the examples that follow.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>When <code>:auto-add</code> is <code>false</code>, you have to either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Manually <a href="https://git-scm.com/docs/git-add">git add</a> files generated by <a href="#create">create</a> commands yourself.</p>
</li>
<li>
<p>Or specify the <code>:git-add</code> option on <code>poly</code> <a href="#create">create</a> commands.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_execute_commands"><a class="link" href="#_how_to_execute_commands">How to Execute Commands</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you create a component, let&#8217;s recap the two ways of executing <code>poly</code> commands:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>poly help</code> - the stand-alone version of the tool.</p>
</li>
<li>
<p><code>clojure -M:poly help</code> - as a Clojure dep from the workspace directory.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Which forms are available depends on how you <a href="#">installed</a> <code>poly</code>.</p>
</div>
<div class="paragraph">
<p>All the documentation refers to the first form, even though the other form is also valid.</p>
</div>
<div class="paragraph">
<p>A third way to execute <code>poly</code> commands is through the <code>poly</code> shell.
You start the poly shell via the <a href="#shell">shell</a> command:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>poly shell</code></p>
</li>
<li>
<p><code>clojure -M:poly shell</code></p>
</li>
</ol>
</div>
<div id="shell-is-default" class="paragraph">
<p>The <a href="#shell">shell</a> command is the default command:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>poly</code></p>
</li>
<li>
<p><code>clojure -M:poly</code></p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/component/start-a-shell.png" alt="start a shell">
</div>
</div>
<div class="paragraph">
<p>From the poly shell, it&#8217;s enough to enter the name of the command, e.g.:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/component/shell-info.png" alt="shell info">
</div>
</div>
<div class="paragraph">
<p>In most cases, the poly shell is the most convenient way to execute commands.
It gives you instant feedback, history, and autocomplete.
Feel free to use the <a href="#">shell</a> from now on.
It will make you more productive and enhance your development experience!</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Type <a href="#quit"><code>quit</code></a> to end your <code>poly</code> shell session.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-component"><a class="link" href="#create-component">Creating a Component</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s continue with our example by executing the <a href="#create-component">create component</a> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly create component name:user</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your workspace directory structure will now look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example
 bases
 components
    user <i class="conum" data-value="1"></i><b>(1)</b>
        deps.edn
        resources
           user
        src
           se
               example
                   user
                       interface.clj
        test
            se
                example
                    user
                        interface_test.clj
 deps.edn
 development
    src
        dev
            lisa.clj
 logo.png
 projects
 readme.md
 workspace.edn</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>new <code>user</code> component</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You&#8217;ll notice the command also printed out this message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">  Remember to add :local/root dependencies to dev and project 'deps.edn' files.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a reminder to add the component to your <code>./deps.edn</code> file.
If you don&#8217;t, tools.deps and the development environment will not recognize your newly created component, which would be a pity!</p>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool leaves this task to you as a developer.
Our philosophy is to leave the editing of files to you.
While we are happy to generate files for you, we want to give you complete control over changing your files.</p>
</div>
<div id="add-to-deps-edn-component" class="paragraph">
<p>Let&#8217;s listen to the helpful reminder.
Add the <code>user</code> component to your <code>./deps.edn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:aliases  {:dev {:extra-paths ["development/src"]

                  :extra-deps {poly/user {:local/root "components/user"} <i class="conum" data-value="1"></i><b>(1)</b>

                               org.clojure/clojure {:mvn/version "1.11.1"}}}

            :test {:extra-paths ["components/user/test"]}}} <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add the <code>user</code> component as a dependency</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add the <code>user</code> component tests</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All dependency keys must be unique.
A good pattern is to prefix them with <code>poly/</code> followed by the brick name, e.g., <code>poly/user</code> as in this example.</p>
</div>
<div id="expose-code-outside-workspace" class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
If you expose your code outside your workspace, e.g. as a <a href="#">library</a>, then you should use a more unique prefix, e.g. <code>maven-group-id.workspace-name/</code>, see for example how <a href="https://github.com/imrekoszo/polylith-kaocha/blob/master/projects/example/deps.edn#L14">these</a> components are configured in the Kaocha test runner (You don&#8217;t need to include <code>.bases</code> and <code>.components</code> in the prefix, polylith-kaocha/kaocha-resource-config-loader` should be enough, because components and bases can&#8217;t share the same name).
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Most IDEs now support adding components as a <code>:local/root</code> dependency, but if you are not using Cider, Calva, or a current version of Cursive, please review <a href="#ide-local-root">IDE Support for <code>:local/root</code></a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Cursive users: After creating a component, you may need to refresh your IDE by clicking the <code>Import Changes</code> link:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/component/cursive-import-changes.png" alt="cursive import changes" width="400">
</div>
</div>
</td>
</tr>
</table>
</div>
<div id="generated-deps-edn" class="paragraph">
<p>The component has its own <code>deps.edn</code> file that looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:paths ["src" "resources"]
 :deps {}
 :aliases {:test {:extra-paths ["test"]
                  :extra-deps {}}}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It specifies a <code>src</code>, <code>resources</code>, and <code>test</code> directory.</p>
</div>
<div class="paragraph">
<p>The <a href="#create-component">create component</a> command created the user component <code>resources</code> directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example
 components
    user
        resources
           user</code></pre>
</div>
</div>
<div class="paragraph">
<p>This directory contains a <code>user</code> directory, which is the name of the component&#8217;s <a href="#">interface</a> and is where you put your resources, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example
 components
    user
        resources
           user
               myimage.png</code></pre>
</div>
</div>
<div class="paragraph">
<p>The reason you should put <code>myimage.png</code> under <code>resources/user</code> and not directly under <code>resources</code> is that you want to avoid name clashes.
This would happen if the same filename existed in more than one component in a <a href="#">project</a>.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t need the <code>resources</code> directory, you can delete it and remove it from the corresponding component <code>deps.edn</code> file.
That said, you should consider keeping it around.
It offers a deliberately clash-resistant naming convention for any resources you or your team might add in the future.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s continue by executing the <a href="#info">info</a> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/component/output/info.png" alt="info" width="350">
</div>
</div>
<div class="paragraph">
<p>The output tells you you have one <code>development</code> project, one <code>user</code> component, and one <code>user</code> <a href="#">interface</a> but no <a href="#">base</a> (yet).
We refer to components and bases as <em>bricks</em> (we will soon explain what a base is).
The cryptic <code>s--</code> and <code>st-</code> will be described in the <a href="#">flags</a> section.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If your <code>poly</code> output does not look as nice and colorful, see <a href="#">colors</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_add_an_implementation"><a class="link" href="#_add_an_implementation">Add an Implementation</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now, let&#8217;s add the <code>core</code> namespace to <code>user</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/component/add-user-namespaces.png" alt="add user namespaces" width="350">
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;and change it to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns se.example.user.core)

(defn hello [name]
  (str "Hello " name "!"))</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;and update the <code>interface</code> to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns se.example.user.interface
  (:require [se.example.user.core :as core]))

(defn hello [name]
  (core/hello name))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>interface</code> delegates the incoming call to the implementing <code>core</code> namespace, which is the most common way of structuring components in Polylith.</p>
</div>
<div class="paragraph">
<p>In this example, we had you put all your implementing code in one single namespace.
As a codebase grows, more namespaces can be added to the component as needed.
There is no rule that the implementing namespace must be named <code>core</code>, but this is what the <a href="#create-component">create component</a> command generates, and we stuck with this default for this example.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ide-local-root"><a class="link" href="#ide-local-root">IDE Support for <code>:local/root</code></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://github.com/clojure-emacs/cider">Cider</a>, <a href="https://marketplace.visualstudio.com/items?itemName=betterthantomorrow.calva">Calva</a>, and <a href="https://cursive-ide.com/">Cursive (v1.13.0 and later)</a> all include support <code>:local/root</code> dependencies.</p>
</div>
<div class="paragraph">
<p>If your IDE doesn&#8217;t include support for <code>:local/root</code> dependencies, and you are unable to switch to an IDE that has this support, then you have to add your components as <code>:extra-paths</code> instead of <code>:extra-deps</code> in your <code>./deps.edn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:aliases {:dev {:extra-paths ["development/src"
                               "components/user/src"  <i class="conum" data-value="1"></i><b>(1)</b>
                               "components/user/resources"]} <i class="conum" data-value="2"></i><b>(2)</b>

           :test {:extra-paths ["components/user/test"]}}}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>user</code> component <code>src</code> added as a path</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>user</code> component <code>resources</code> added as a path</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If at all possible, we recommend you add <a href="#add-to-deps-edn-component">components as dependencies</a> instead of paths for these reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It&#8217;s more readable.</p>
</li>
<li>
<p>It&#8217;s consistent with how <a href="#">projects</a> are specified.</p>
</li>
<li>
<p>You won&#8217;t have to duplicate the bricks library dependencies in your <code>./deps.edn</code>.</p>
</li>
<li>
<p>You can add or remove the <code>resources</code> directory from a brick without having to remember to update your <code>./deps.edn</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you want to compare the difference, take a look at how <code>article</code> was elegantly added as a single <a href="https://github.com/furkan3ayraktar/clojure-polylith-realworld-example-app/blob/5b6df23d63500a4540b75308379e06dfdeb8b767/deps.edn#L7">dependency</a> versus adding it as two <a href="https://github.com/furkan3ayraktar/clojure-polylith-realworld-example-app/blob/e6f7f200bc46e4e2595e123947eec442ad91c9ab/deps.edn#L7-L8">paths</a> in the RealWorld example app.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_interface"><a class="link" href="#_interface">Interface</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_interface_2" class="sect0"><a class="link" href="#_interface_2">Interface</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>Component interfaces give many benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Consistency</em>. Components can only be accessed through their interface, making them easy to find, use, and reason about.</p>
</li>
<li>
<p><em>Encapsulation</em>. You can change a component&#8217;s implementing namespaces without breaking the interface contract.</p>
</li>
<li>
<p><em>Composability</em>. All components have access to all other components via their interfaces, and you can replace them as long as they use the same interface.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you created the <code>user</code> <a href="#create-component">component</a> as part of our <a href="#">tutorial</a>, <code>poly</code> also created the <code>user</code> interface.</p>
</div>
<div class="paragraph">
<p>So what is an <code>interface</code>, and what is it good for?</p>
</div>
<div class="paragraph">
<p>An interface in the Polylith world is a namespace named <code>interface</code> that usually lives in one, but sometimes several, sub-namespaces within a component.</p>
</div>
<div class="paragraph">
<p>Looking at our example <code>user</code> component, if you exclude the top namespace, in Polylith we think of its interface namespace as <code>user.interface</code>.</p>
</div>
<div class="paragraph">
<p>The interface defines <code>def</code>, <code>defn</code>, or <code>defmacro</code> statements which form the contract that it exposes to other components and bases.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="one-interface-in-multiple-components"><a class="link" href="#one-interface-in-multiple-components">Declaring the Same Interface in Multiple Components</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s pretend we have the interface namespace <code>user.interface</code> containing the functions <code>fun1</code> and <code>fun2</code> and that two components <code>user</code> and <code>admin</code> implement this interface, e.g,:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text"> myworkspace
  ...
   components
     user <i class="conum" data-value="1"></i><b>(1)</b>
       src
         com
           mycompany
             user <i class="conum" data-value="2"></i><b>(2)</b>
                interface.clj
                  fun1
                  fun2
                ...
     admin <i class="conum" data-value="3"></i><b>(3)</b>
       src
         com
           mycompany
             user <i class="conum" data-value="4"></i><b>(4)</b>
                interface.clj
                  fun1
                  fun2
                ...
  ...</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>user</code> component</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>implements <code>user</code> interface</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>admin</code> component</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>also implements <code>user</code> interface</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Because we are free to edit the <code>interface.clj</code> file for both user and admin, they can get out of sync if we are not careful.
Luckily, the <code>poly</code> tool will help us keep them consistent and complain if they differ when we run the <a href="#check">check</a>, <a href="#info">info</a> or <a href="#test">test</a> commands:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Check</th>
<th class="tableblock halign-left valign-top">Example mismatch</th>
<th class="tableblock halign-left valign-top">To protect against</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of arguments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[a b]</code><br>
<code>[a b c]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Incompatible signatures</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Argument order</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[a b c]</code><br>
<code>[b c a]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Accidental argument call order mismatches</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type hints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[^String x y]</code><br>
<code>[x y]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Incompatible types and type confusion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Functions and macros</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(defn foo [])</code><br>
<code>(defmacro foo [])</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Incompatible composability: functions are composable, and macros are not</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_splitting_an_interface_into_sub_namespaces"><a class="link" href="#_splitting_an_interface_into_sub_namespaces">Splitting an Interface into Sub-Namespaces</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>We often choose to have a single <code>interface</code> namespace in a component, but dividing the interface into several sub-namespaces is possible.
To do so, create an <code>interface</code> package (directory) with the name <code>interface</code> at the component root and then add the sub-namespaces.</p>
</div>
<div class="paragraph">
<p>You can find an example in Polylith itself, where the <code>util</code> component divides its <a href="https://github.com/polyfy/polylith/tree/master/components/util/src/polylith/clj/core/util/interface">interface</a> into several sub-namespaces:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">util
 interface
     color.clj
     exception.clj
     os.clj
     str.clj
     time.clj</code></pre>
</div>
</div>
<div class="paragraph">
<p>Dividing an interface like this can be handy to group and sub-group the interface functions.
One typical usage is to place <a href="https://clojure.org/about/spec">clojure specs</a> in its own <code>spec</code> sub-namespace.
You can see an example of this in the <a href="https://github.com/furkan3ayraktar/clojure-polylith-realworld-example-app">RealWorld example app</a>, where the <code>article</code> component has both an <code>article.interface</code> and an <a href="https://github.com/furkan3ayraktar/clojure-polylith-realworld-example-app/blob/master/components/article/src/clojure/realworld/article/interface/spec.clj"><code>article.interface.spec</code></a> sub-interface.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of the sub-interface usage from the <a href="https://github.com/furkan3ayraktar/clojure-polylith-realworld-example-app/blob/master/bases/rest-api/src/clojure/realworld/rest_api/handler.clj">RealWorld example app handler</a> namespace in its <code>rest-api</code> <a href="#">base</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns clojure.realworld.rest-api.handler
  (:require ...
            [clojure.realworld.user.interface.spec :as user-spec]
            ...))

(defn login [req]
  (let [user (-&gt; req :params :user)]
    (if (s/valid? user-spec/login user)
      (let [[ok? res] (user/login! user)]
        (handle (if ok? 200 404) res))
      (handle 422 {:errors {:body ["Invalid request body."]}}))))</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Every time you are tempted to split up an interface into sub-namespaces, instead consider splitting the component into smaller components!
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_delegation"><a class="link" href="#_delegation">Delegation</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The most common way of structuring code in components is to delegate calls from the interface to one or more implementing namespaces.</p>
</div>
<div class="paragraph">
<p>There is one case where putting the implementation directly in the interface can be worth considering: if the functions are one-liners or tiny.
You can see an example of this in the <a href="https://github.com/polyfy/polylith/blob/master/components/path-finder/src/polylith/clj/core/path_finder/interface/criterias.clj">path-finder</a> component of the Polylith workspace.</p>
</div>
<div class="paragraph">
<p>Ultimately, it&#8217;s up to you to do what you think is best.</p>
</div>
<div class="paragraph">
<p>Our experience has shown us many advantages to keeping interfaces tiny and having them only expose what is needed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_interface_definitions"><a class="link" href="#_interface_definitions">Interface Definitions</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>So far, we have only used functions in the interface.
Polylith also supports having <code>def</code> and <code>defmacro</code> statements in the interface.
There is no magic here; just include the definitions you want, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns se.example.logger.interface
  (:require [se.example.logger.core :as core]))

(defmacro info [&amp; args]
  `(core/info ~args))</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;which delegates to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns se.example.logger.core
  (:require [taoensso.timbre :as timbre]))

(defmacro info [args]
  `(timbre/log! :info :p ~args))</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_more_about_interfaces"><a class="link" href="#_more_about_interfaces">More About Interfaces</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This list of tips makes more sense when you have used Polylith for a while, so bookmark this section for later:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The interface docstrings should focus on what problem each function/macro solves, while the implementation docstrings can focus on concrete details.</p>
</li>
<li>
<p>Consider sorting interface namespace functions in alphabetical order for easy lookup.
Order functions in implementation namespaces freely.</p>
</li>
<li>
<p>The interface can expose the entity&#8217;s name, e.g., <code>sell [car]</code>, while the implementing function can expose specific usage via destructuring, e.g., <code>sell [{:keys [model type color]}]</code>.</p>
</li>
<li>
<p>It sometimes makes sense for a <a href="http://clojure-doc.org/articles/language/functions.html#multi-arity-functions">multi-arity function</a> in an interface to delegate to a single arity function in the implementing namespace:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(defn foo
  ([a b c] (some-impl/foo a b c)
  ([a b] (foo a b nil)))</code></pre>
</div>
</div>
</li>
<li>
<p>It sometimes makes sense for a <a href="http://clojure-doc.org/articles/language/functions.html#variadic-functions">variadic functions</a> in an interface to delegate to function in the implementing namespace that accepts the variadic portion as a vector:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(defn foo [a b &amp; other]
  (some-impl/foo a b other))</code></pre>
</div>
</div>
</li>
<li>
<p>Polylith simplifies testing by allowing access to implementing namespaces from the <code>test</code> directory.
Polylith restricts the code under the <code>src</code> directory to only access the <code>interface</code> namespace.
The <code>poly</code> tool validates these restrictions when running the <a href="#check">check</a>, <a href="#info">info</a>, and <a href="#test">test</a> command.</p>
</li>
<li>
<p>Because Polylith only allows the code under <code>src</code> to call <code>interface</code> code, you can think of publicly declared implementation functions as protected (as in Java).
Because these "protected" functions are technically public, you can test and debug them more easily.
For example, when stopping at a breakpoint to evaluate a "protected" function, you don&#8217;t need to use the special syntax you would need to access a private function.</p>
</li>
</ul>
</div>
<div id="interface-ns" class="ulist">
<ul>
<li>
<p>Polylith will always recognize <code>interface</code> and <code>ifc</code> as interface namespace names.
By default, it will generate code using <code>interface</code> as the interface namespace name when you create a component.
You can override this default via <code>:interface-ns</code> in <code>./workspace.edn</code>.
Scenarios:</p>
<div class="ulist">
<ul>
<li>
<p>You want to share code between Clojure and ClojureScript via <code>.cljc</code> source files.
Since <code>interface</code> is a reserved word in ClojureScript, it will cause problems.
In this case, you can either:</p>
<div class="ulist">
<ul>
<li>
<p>set <code>:interface-ns</code> to <code>ifc</code>, <code>poly</code> will use <code>ifc</code> as the interface namespace name for generated code when you create a component</p>
</li>
<li>
<p>or leave <code>interface</code> as the default and override by specifying <code>interface:ifc</code> as an option to <a href="#create-component">create component</a> for components that will also run from ClojureScript.</p>
</li>
</ul>
</div>
</li>
<li>
<p>You want to consume Clojure code from another language on the JVM, e.g., Kotlin, where <code>interface</code> is a reserved word.
You could set <code>:interface-ns</code> to anything that won&#8217;t conflict, for the sake of this example, let&#8217;s say <code>api</code>.
The <code>poly</code> tool would now use <code>api</code> for the interface namespace name when it generates code when you create a component, but also recognize <code>interface</code> and <code>ifc</code> as interface names.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_base"><a class="link" href="#_base">Base</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_base_2" class="sect0"><a class="link" href="#_base_2">Base</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>A <code>base</code> is similar to a <a href="#">component</a> except for two things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It doesn&#8217;t have an <a href="#">interface</a>.</p>
</li>
<li>
<p>It exposes a public API to the outside world.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The lack of an <a href="#">interface</a> makes bases less composable than components.
This is fine; the sole purpose of a <code>base</code> is to act as a bridge between the real world and the <a href="#">components</a> it delegates to (via the components' interfaces).
This structure gives us the modularity we need to build simple, understandable services and tools.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s continue with our <a href="#">tutorial</a>.
The last thing you did was <a href="#create-component">create a component</a>.
Run the following <a href="#create-base">create base</a> command to create a <code>cli</code> base:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly create base name:cli</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your workspace should now look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example
 bases
    cli <i class="conum" data-value="1"></i><b>(1)</b>
        deps.edn
        resources
           cli
        src
           se
               example
                   cli
                       core.clj
        test
            se
                example
                    cli
                        core_test.clj
 components
    user
        deps.edn
        resources
           user
        src
           se
               example
                   user
                       core.clj
                       interface.clj
        test
            se
                example
                    user
                        interface_test.clj
 deps.edn
 development
    src
        dev
            lisa.clj
 logo.png
 projects
 readme.md
 workspace.edn</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>new <code>cli</code> base</td>
</tr>
</table>
</div>
<div id="add-to-deps-edn-base" class="paragraph">
<p>Edit your <code>./deps.edn</code> to add your newly created base:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure"> :aliases  {:dev {:extra-paths ["development/src"]

                  :extra-deps {poly/user {:local/root "components/user"}
                               poly/cli  {:local/root "bases/cli"}  <i class="conum" data-value="1"></i><b>(1)</b>

                               org.clojure/clojure {:mvn/version "1.11.1"}}}

            :test {:extra-paths ["components/user/test"
                                 "bases/cli/test"]} <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add the <code>cli</code> base as a dependency</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add the <code>cli</code> base tests</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Cursive users: refresh your IDE to pick up the updates.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now, add some code to the base:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns se.example.cli.core
  (:require [se.example.user.interface :as user])
  (:gen-class)) <i class="conum" data-value="1"></i><b>(1)</b>

(defn -main [&amp; args] <i class="conum" data-value="2"></i><b>(2)</b>
  (println (user/hello (first args)))
  (System/exit 0))</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="https://clojuredocs.org/clojure.core/gen-class">:gen-class</a> tells the Clojure compiler to generate a Java class</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>which allows the JVM to invoke <code>-main</code> when the <code>cli</code> base is invoked from the command line</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool generated a <code>deps.edn</code> file for the <code>cli</code> base:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:paths ["src" "resources"]
 :deps {}
 :aliases {:test {:extra-paths ["test"]
                  :extra-deps {}}}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is identical to the <a href="#generated-deps-edn">deps.edn poly generated when you created the user component</a>. It will soon be needed when we create a <a href="#">project</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
You never add a dependency from a base <code>deps.edn</code> to a component.
The <code>poly</code> tool will automatically wire the <code>cli</code> base to the <code>user</code> component via its <a href="#">interface</a> after you&#8217;ve added them to your <a href="#">project</a>.
Bases, or bricks for that matter, are unaware of concrete components; they only talk to <a href="#">interfaces</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We are getting closer to building a deployable <a href="#">artifact</a>, which will turn your code into something useable, a command-line tool.
To get there, you must first create a <a href="#">project</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_project"><a class="link" href="#_project">Project</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_project_2" class="sect0"><a class="link" href="#_project_2">Project</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>There are two kinds of <code>projects</code> in Polylith: development and deployable.</p>
</div>
<div class="paragraph">
<p><strong>The <a href="#">development</a> project</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Where you work with the code, often from a REPL.</p>
</li>
<li>
<p>Described in <code>./deps.edn</code> which:</p>
<div class="ulist">
<ul>
<li>
<p>Specifies all bricks and project libraries used by the project.</p>
</li>
<li>
<p>Optionally defines <a href="#">profiles</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Source code to support development (not part of any component or base) lives under the <code>./development</code> directory.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>A deployable project:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Used to build deployable <a href="#">artifacts</a>, e.g., lambda functions, REST APIs, tools, etc.</p>
</li>
<li>
<p>Has its own directory under the <code>./projects</code> directory (e.g., <code>my-project</code>), which:</p>
<div class="ulist">
<ul>
<li>
<p>Has a <code>deps.edn</code> specifying the bricks and libraries used by the deployable project.</p>
<div class="ulist">
<ul>
<li>
<p>If the referenced bricks contain any tests, they are run when you execute the <a href="#test">test</a> command.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Can optionally have a <code>resources</code> directory.</p>
</li>
<li>
<p>Can optionally have a <code>test</code> directory for project-specific tests.</p>
</li>
<li>
<p>Doesn&#8217;t have a <code>src</code> directory.
We discourage a <code>src</code> directory for deployable projects; all production code should normally only live in bricks.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>:project</code> key in <code>./workspace.edn</code> configures project aliases and, optionally, how <code>poly</code> should run your <a href="#">tests</a>.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s continue with our <a href="#">tutorial</a>.
The last thing you did was create a <code>cli</code> <a href="#create-component">base</a>.
Run the following <a href="#create-project">create project</a> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly create project name:command-line</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your workspace should now look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example
 bases
    cli
        deps.edn
        resources
           cli
        src
           se
               example
                   cli
                       core.clj
        test
            se
                example
                    cli
                        core_test.clj
 components
    user
        deps.edn
        resources
           user
        src
           se
               example
                   user
                       core.clj
                       interface.clj
        test
            se
                example
                    user
                        interface_test.clj
 deps.edn
 development
    src
        dev
            lisa.clj
 logo.png
 projects
    command-line <i class="conum" data-value="1"></i><b>(1)</b>
        deps.edn
 readme.md
 workspace.edn</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>new <code>command-line</code> project</td>
</tr>
</table>
</div>
<div id="project-alias" class="paragraph">
<p>The <code>poly</code> tool helpfully reminds us:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">  It's recommended to add an alias to :projects in ./workspace.edn for the command-line project.</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you don&#8217;t follow this advice, the <code>command-line</code> project heading will default to <code>?1</code> when running the <a href="#info">info</a> command.
Go ahead and add an alias in your <code>./workspace.edn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">  {...
   :projects {"development" {:alias "dev"}
              "command-line" {:alias "cl"}}} <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add the <code>cl</code> <code>alias</code> for the <code>command-line</code> project</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Add the <code>user</code> component and the <code>cli</code> base to your new project by editing <code>projects/command-line/deps.edn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:deps {poly/user {:local/root "../../components/user"} <i class="conum" data-value="1"></i><b>(1)</b>
        poly/cli  {:local/root "../../bases/cli"} <i class="conum" data-value="2"></i><b>(2)</b>

        org.clojure/clojure {:mvn/version "1.11.1"}}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add <code>user</code> component</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add <code>cli</code> base</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>The <code>:local/root</code> paths begin with <code>../../</code> because the <code>components</code> and <code>bases</code> directories are two levels up relative to <code>projects/command-line</code> directory.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>When you run the <a href="#test">test</a> command, <code>poly</code> will determine which tests should run.
If you want to run tests for each deployable project outside of <code>poly</code> using Clojure&#8217;s tools.deps, you must specify the test paths in your <code>./deps.edn</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Each <code>./projects/**/deps.edn</code> specifies what bricks to include via <code>:local/root</code> dependencies.
The <code>poly</code> <a href="#">test</a> command determines the appropriate test dependencies from each referenced brick&#8217;s <code>deps.edn</code>.</p>
</div>
<div class="paragraph">
<p>But Clojure&#8217;s tools.deps does not include test dependencies from <code>:local/root</code> dependencies.
To support IDEs and other tooling, you must compensate by adding your brick tests as separate paths in your <code>./deps.edn</code>, just as you did for your <a href="#add-to-deps-edn-component">user component</a> and <a href="#add-to-deps-edn-base">cli base</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Where you specify dependency to bricks differs based on the project type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For the development project: <code>./deps.edn &gt; :aliases &gt; :dev &gt; :extra-deps</code></p>
</li>
<li>
<p>For deployable projects: <code>./projects/PROJECT-DIR/deps.edn &gt; :deps</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_shell"><a class="link" href="#_shell">Shell</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_shell_2" class="sect0"><a class="link" href="#_shell_2">Shell</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>Not only does the <code>shell</code> make you more productive, but it&#8217;s also fun to use!
It takes full advantage of <a href="https://github.com/jline/jline3">jline3</a> under the hood, which supports macOS, Linux, FreeBSD, Solaris, and Windows.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s explore some shell features.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Our examples assume you are exploring from our ongoing <a href="#">tutorial</a> <code>example</code> <a href="#">workspace</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="launch"><a class="link" href="#launch">Launching</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Start a shell by typing <code>poly</code> from your workspace root directory (<a href="#shell-is-default">shell is the default command</a>):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-start.png" alt="shell start" width="600">
</div>
</div>
<div class="paragraph">
<p>Notice that the <code>example$</code> prompt includes your current workspace name.
From here, you can run commands and get instant feedback.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="quit"><a class="link" href="#quit">Quitting</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>To quit the shell, type <code>exit</code> or <code>quit</code> or press either of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>kbd:[Ctrl+C]</p>
</li>
<li>
<p>kbd:[Ctrl+D] (if not on Windows)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lets_play"><a class="link" href="#_lets_play">Let&#8217;s Play</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="#launch">Launch a poly shell</a> and play along.</p>
</div>
<div class="paragraph">
<p>Press kbd:[Tab] to see all available commands:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-all-commands.png" alt="shell all commands" width="600">
</div>
</div>
<div class="paragraph">
<p>Type <code>i</code> to match all commands starting with the letter <code>i</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-i.png" alt="shell i" width="600">
</div>
</div>
<div class="paragraph">
<p>Press kbd:[Tab] to autocomplete the <a href="#info">info</a> command and list valid arguments:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-info.png" alt="shell info" width="600">
</div>
</div>
<div class="paragraph">
<p>You can usually skip the leading colon character; for example, type <code>l</code> to match <code>:loc</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-info-loc.png" alt="shell info loc" width="600">
</div>
</div>
<div class="paragraph">
<p>Press kbd:[Tab] to autocomplete <code>:loc</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-info-loc-tab.png" alt="shell info loc tab" width="600">
</div>
</div>
<div class="paragraph">
<p>To distinguish <code>:project</code> from <code>project</code>, type the leading <code>:</code> (colon character):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-info-loc-p.png" alt="shell info loc p" width="600">
</div>
</div>
<div class="paragraph">
<p>Complete <code>:project</code> by pressing kbd:[Tab].
Type <code>p</code> then press kbd:[Tab] to autocomplete <code>project:</code>, and kbd:[Tab] again, to list all projects in the workspace:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-info-loc-project.png" alt="shell info loc project" width="600">
</div>
</div>
<div class="paragraph">
<p>When you have only one candidate, select it by pressing kbd:[Tab]:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-one-candidate.png" alt="shell one candidate" width="600">
</div>
</div>
<div class="paragraph">
<p>The trailing <code>:</code> (colon character) indicates a multi-select argument (you can select more than one project).
You can leave the multi-select input mode by pressing kbd:[Space]; this removes the trailing colon:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-leave-multi-select.png" alt="shell leave multi select" width="600">
</div>
</div>
<div class="paragraph">
<p>An alternative way of selecting a listed candidate is to press kbd:[Tab] twice and use the arrow keys to move the selection cursor around (kbd:[Tab] and kbd:[Shift+Tab] also work):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-move-cursor.png" alt="shell move cursor" width="600">
</div>
</div>
<div class="paragraph">
<p>Press kbd:[Enter] to choose the item at the cursor:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-move-cursor-and-select.png" alt="shell move cursor and select" width="600">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_dash_item"><a class="link" href="#_the_dash_item">The Dash Item</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>brick</code> argument shows you all available bricks.
Selecting the <code>-</code> (the dash character) tells <code>poly</code> you want no bricks selected (e.g., for testing):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-info-brick.png" alt="shell info brick" width="600">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_autocomplete_to_explore"><a class="link" href="#_using_autocomplete_to_explore">Using Autocomplete to Explore</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Autocomplete really shines when there are many available suggestions.
The <a href="#ws">ws</a> command offers a good example.
Instead of trying to remember all the different <code>get:</code> arguments, the <code>shell</code> lists them for you:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-ws-get.png" alt="shell ws get" width="600">
</div>
</div>
<div class="paragraph">
<p>After you select <code>components</code>, the <code>shell</code> lists valid arguments.
Sometimes, you encounter multiple matching suggestions.
When one of them is an exact match for what you have typed:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-ws-get-components-user.png" alt="shell ws get components user" width="600">
</div>
</div>
<div class="paragraph">
<p>You can select it by typing <code>:</code> (the colon character):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-ws-get-components-user-colon.png" alt="shell ws get components user colon" width="600">
</div>
</div>
<div class="paragraph">
<p>You can continue navigating down into the workspace structure to find the information you are interested in:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-ws-get-browse.png" alt="shell ws get browse" width="600">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_switching_workspace"><a class="link" href="#_switching_workspace">Switching Workspace</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you start a shell from a workspace root directory (where the <code>workspace.edn</code> file lives), the workspace is automatically loaded, and you can execute all available commands against it.</p>
</div>
<div class="paragraph">
<p>You can switch to a different workspace without leaving the poly shell.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#create">create</a> and <a href="#test">test</a> commands don&#8217;t work on workspaces you have switched to.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>If you want to play along, exit the shell, then clone <a href="https://github.com/furkan3ayraktar/clojure-polylith-realworld-example-app">clojure-polylith-realworld-example-app</a> under the same parent directory as your <code>example</code> workspace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">cd ..
git clone https://github.com/furkan3ayraktar/clojure-polylith-realworld-example-app.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>And relaunch the poly shell:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">cd example
poly</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can switch to another workspace using the <a href="#switch-ws">switch-ws</a> command in combination with its <code>dir</code> argument:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-switch-dir.png" alt="shell switch dir" width="600">
</div>
</div>
<div class="paragraph">
<p>The <code>shell</code> lists all directories and <code>.edn</code> files under the current directory.</p>
</div>
<div class="paragraph">
<p>Select the <code>clojure-polylith-realworld-example-app</code> directory by typing <code>.</code> followed by kbd:[Tab] to select <code>..</code> and then type <code>clo</code> (or something long enough) followed by kbd:[Tab] to select the workspace directory:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-switch-dir-realworld.png" alt="shell switch dir realworld" width="600">
</div>
</div>
<div class="paragraph">
<p>Switch workspace by pressing kbd:[Enter]:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-switched-dir.png" alt="shell switched dir" width="600">
</div>
</div>
<div class="paragraph">
<p>Notice the prompt has changed to show the currently selected workspace (by dir).
All commands will be run against this selected workspace.</p>
</div>
<div class="paragraph">
<p>You can go back to the <code>example</code> workspace by invoking <code>switch-ws</code> without arguments:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-switch-ws.png" alt="shell switch ws" width="600">
</div>
</div>
<div id="refresh-ws" class="paragraph">
<p>If you invoke <code>switch-ws</code> again when you are already on the root, this will read the workspace from disk again, which can be useful in some situations.</p>
</div>
<div class="sect2">
<h3 id="_switching_to_an_exported_workspace"><a class="link" href="#_switching_to_an_exported_workspace">Switching to an Exported Workspace</a></h3>
<div class="paragraph">
<p>You can switch to an exported workspace.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can export a workspace to a <code>.edn</code> file, e.g. via <code>poly ws out:usermanager.edn</code>.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>If you want to play along, exit the shell, then clone the <code>polylith</code> branch of <a href="https://github.com/seancorfield/usermanager-example/tree/polylith">usermanager-example</a> project under the same parent directory as your <code>example</code> workspace, and export its workspace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">cd ..
git clone --branch polylith https://github.com/seancorfield/usermanager-example.git
cd usermanager-example
poly ws out:usermanager.edn</code></pre>
</div>
</div>
<div class="paragraph">
<p>And relaunch the poly shell:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">cd ../example
poly</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Switch to the exported workspace using the <code>file</code> argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ switch-ws file:../usermanager-example/usermanager.edn
file:usermanager-example$</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that the prompt has changed to show the currently selected workspace (by export file).</p>
</div>
<div id="read-old-workspace" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>poly</code> tool supports reading old exported files, with older <a href="#">versions</a> of the workspace structure, which are automatically migrated to the current version.
This is also true when reading an older version of a workspace, e.g. if you go back in the git history with git <a href="https://git-scm.com/docs/git-checkout">checkout</a> or <a href="https://git-scm.com/docs/git-switch">switch</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="switch-workspace"><a class="link" href="#switch-workspace">Switching workspace by name</a></h3>
<div class="paragraph">
<p>If you have workspaces <a href="#sub-workspaces">within</a> your workspace, other cloned workspaces, or  workspaces exported to file, there is a convenient way to access these from the shell.</p>
</div>
<div class="paragraph">
<p>First you need to configure these in the <a href="#ws-shortcuts">:ws-shortcuts</a> key in your <a href="#user">user config</a> file (<code>~/.config/polylith/config.edn</code>).
A workspace that lives in a directory is specified with <code>:dir</code>, while exported workspaces are specified with <code>:file</code>. They are accessed by the name of the directory/file, or <code>:name</code> if given.</p>
</div>
<div class="paragraph">
<p>This example assumes that you have cloned the repos <a href="https://github.com/polyfy/polylith">polylith</a> and <a href="https://github.com/furkan3ayraktar/clojure-polylith-realworld-example-app">clojure-polylith-realworld-example-app</a>, and that you have <a href="#export-workspace">exported</a> "another-ws" to a file, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">{...
 :ws-shortcuts {:root-dir "/Users/joakimtengstrand/source/polylith"
                :paths [{:dir "examples/doc-example"}
                        {:dir "../clojure-polylith-realworld-example-app" :name "realworld"}
                        {:file "../sandbox/another-ws.edn"}]}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The value of <code>:root-dir</code> is added to each path to get a full path.</p>
</div>
<div class="paragraph">
<p>Now we can switch workspace from the <a href="#">shell</a> with <code>via:NAME</code>
where NAME is the name of the directory/file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">polylith$ switch-ws via:
another-ws                (../sandbox/another-ws.edn)
backend       (examples/multiple-workspaces2/backend)
doc-example                    (examples/doc-example)
realworld (../clojure-polylith-realworld-example-app)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we type <code>d</code> and press kbd:[Tab] followed by kbd:[Enter] we switch to the <code>examples/doc-example</code> workspace directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">polylith$ switch-ws via:doc
dir:doc-example$</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can always switch back to the root workspace with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">dir:backend$ switch-ws
polylith$</code></pre>
</div>
</div>
<div class="paragraph">
<p>A workspace that has been exported to a file, e.g. <code>poly ws out:another-ws.edn</code>, can be selected with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">polylith$ switch-ws via:another-ws
file:another-ws</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is equivalent to <code>switch-ws file:../sandbox/another-ws.edn</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_switch_at_launch"><a class="link" href="#_switch_at_launch">Switch at Launch</a></h3>
<div class="paragraph">
<p>You can launch a shell and immediately switch to a workspace:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-open-realworld.png" alt="shell open realworld" width="600">
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;or load a workspace from an export file, e.g.:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-open-usermanager.png" alt="shell open usermanager" width="600">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_workspace_switch_mechanics"><a class="link" href="#_workspace_switch_mechanics">Workspace Switch Mechanics</a></h3>
<div class="paragraph">
<p>Knowing how the shell supports workspace switching can be helpful.
It is pretty simple:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>After switching to workspace dir <code>D</code>, the shell silently appends <code>ws-dir:D</code> to each command before it runs it.</p>
</li>
<li>
<p>After switching to workspace export file <code>F</code>, the shell silently appends <code>ws-file:F</code> to each command before it runs it.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_autocomplete_examples"><a class="link" href="#_autocomplete_examples">Autocomplete Examples</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Autocomplete helps you execute different commands with the correct arguments:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All valid sub-commands are suggested for a command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ create
base        component   project</code></pre>
</div>
</div>
</li>
<li>
<p>All valid arguments are suggested for a command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ test
:all          :all-bricks   :dev          :loc          :project      :verbose
brick         project       since</code></pre>
</div>
</div>
</li>
<li>
<p>Browse your file system when selecting files and directories:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ switch-ws dir:
../             bases/          components/     deps.edn        development/
projects/       workspace.edn   ~/</code></pre>
</div>
</div>
</li>
<li>
<p>Browse outdated libraries via the <a href="#libs">libs</a> command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ libs library:
org.clojure/clojure   org.slf4j/slf4j-nop   zprint/zprint</code></pre>
</div>
</div>
</li>
<li>
<p>Browse your workspace structure via the <a href="#ws">ws</a> command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ ws get:interfaces:user:
definitions               implementing-components   name                      type</code></pre>
</div>
</div>
</li>
<li>
<p>Browse documentation with the <a href="#doc">doc</a> command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ doc help:
check                deps-brick           doc                  tap
create-base          deps-project-brick   info                 test
create-component     deps-project         libs                 version
create-project       deps-workspace       overview             ws
create-workspace     deps                 shell
create               diff                 switch-ws</code></pre>
</div>
</div>
</li>
<li>
<p>Tag patterns defined in <code>workspace.edn</code> are suggested for the <code>since:</code> argument:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ info since:
previous-release   previous-stable    release            stable</code></pre>
</div>
</div>
</li>
<li>
<p>Remote git branches are suggested for some commands for the <code>branch:</code> argument (for autocomplete to work here, you need to start your shell with <a href="#all-shell">:all</a> e.g., <code>poly :all</code>):</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">usermanager-example$ ws branch:
develop    master     polylith</code></pre>
</div>
</div>
</li>
<li>
<p>Only relevant bricks and projects are suggested for the <code>brick</code> and <code>project</code> arguments:</p>
<div class="ulist">
<ul>
<li>
<p>The shell only suggests projects marked for testing for the <a href="#info">info</a> and <a href="#test">test</a> commands:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">usermanager-example$ test project:
development   usermanager</code></pre>
</div>
</div>
</li>
<li>
<p>After you select a brick from the <a href="#deps">deps</a> command, only projects that contain that brick will be suggested:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">usermanager-example$ deps brick:database project:
development   usermanager</code></pre>
</div>
</div>
</li>
<li>
<p>After you select a project from the <a href="#deps">deps</a> command, only bricks from that project will be suggested:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">usermanager-example$ deps project:usermanager brick:
app-state        department       schema-fixture   web
database         schema           user             web-server</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_limitations"><a class="link" href="#_limitations">Limitations</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_browsing_directories"><a class="link" href="#_browsing_directories">Browsing Directories</a></h3>
<div class="paragraph">
<p>When browsing the file system from the <code>dir:</code> argument, there are a couple of things worth mentioning:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To go to the user home directory, you must type the full <code>~/</code> and not just <code>~</code> (this reflects a limitation in the underlying <a href="https://github.com/jline/jline3">jline3</a> integration):</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ switch-ws dir:~/
Public/                      Desktop/                     Templates/
proj/                        Documents/                   Videos/
Downloads/                   Dropbox/                     bin/
Music/                       Pictures/</code></pre>
</div>
</div>
</li>
<li>
<p>To navigate to a directory containing spaces, you must type the leading <code>"</code>.</p>
<div class="paragraph">
<p>Notice directory <code>"foo bar baz"</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ switch-ws dir:
"foo bar baz"/   bases/           deps.edn         projects/        ~/
../              components/      development/     workspace.edn</code></pre>
</div>
</div>
<div class="paragraph">
<p>To match it type the leading <code>"</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ switch-ws dir:"
"foo bar baz"/</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_workspace"><a class="link" href="#_creating_a_workspace">Creating a Workspace</a></h3>
<div class="paragraph">
<p>The poly shell will not suggest <code>workspace</code> for the <a href="#create">create</a> command when already associated with a workspace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ create
base        component   project</code></pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll typically run <a href="#create-workspace">create workspace</a> from your terminal shell (bash, PowerShell, zsh, etc) and then use the poly shell on that workspace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">$ poly create workspace name:myws top-ns:com.example
$ cd myws
$ poly</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you prefer to use the shell to create a workspace, run the poly shell outside of any workspace directory:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shell/shell-create-workspace.png" alt="shell create workspace" width="600">
</div>
</div>
<div class="paragraph">
<p>Notice the lack of a workspace name in the prompt.
After you create your workspace, exit the shell and relaunch it from the new workspace directory.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_documentation"><a class="link" href="#_documentation">Documentation</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_doc" class="sect0"><a class="link" href="#_doc">Doc</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>The <code>poly</code> tool includes a <a href="#doc">doc</a> command to open web-based documentation.
The <a href="#">shell</a>'s autocompletion support makes listing and accessing different parts of the documentation a breeze, so go ahead and <a href="#launch">start one up</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the <code>doc</code> command to open the start page of the <code>poly</code> tool documentation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ doc</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>example$</code> prompt shows that we are working from our <a href="#">tutorial</a> <code>example</code> <a href="#">workspace</a>, but you can experiment with the <code>doc</code> command from any workspace.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You should see the page open in your web browser:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/doc/top-doc.png" alt="top doc">
</div>
</div>
<div class="paragraph">
<p>The page has some helpful links:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Link</th>
<th class="tableblock halign-left valign-top">Links to:</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/doc/clj-poly-lib.png" alt="clj poly lib"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This documentation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/doc/clj-poly-doc.png" alt="clj poly doc"></span><br>
(the version of this documentation)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A page listing all the <a href="https://cljdoc.org/versions/polylith/clj-poly">different versions</a> of this documentation.
NOTE: Useful documentation starts at version <code>0.2.18</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/doc/clj-doc.png" alt="clj doc"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <a href="https://cljdoc.org/">cljdoc</a> home page.
Cljdoc is a central hub that hosts documentation for many Clojure libraries and tools (including clj-poly!).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/doc/polylith-repo.png" alt="polylith repo"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <a href="https://github.com/polyfy/polylith">polylith GitHub repo</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/doc/latest-doc-badge.png" alt="latest doc badge"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Documentation for the current <a href="https://github.com/polyfy/polylith/releases">release</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/doc/snapshot-doc-badge.png" alt="snapshot doc badge"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Documentation for the current <code>SNAPSHOT</code> release.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/doc/slack.png" alt="slack"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <a href="https://clojurians.slack.com/messages/C013B7MQHJQ">#polylith</a> channel on <a href="http://clojurians.net/">Clojurians Slack</a>.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We automatically build a <code>SNAPSHOT</code> release and its associated documentation for every commit to the <a href="https://github.com/polyfy/polylith">master</a> branch; see <a href="#releases">releases</a> for more details.</p>
</div>
<div class="paragraph">
<p>When you use a <code>SNAPSHOT</code> release via a <a href="#github-dependency">GitHub dependency</a>, you&#8217;ll be referring to its associated <code>SNAPSHOT</code> documentation.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Use the search box or the left menu to navigate to pages and explore API docs:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/doc/doc-overview.png" alt="doc overview">
</div>
</div>
<div class="paragraph">
<p>And if you scroll down to the bottom of the left menu:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/doc/doc-overview-scrolled.png" alt="doc overview scrolled">
</div>
</div>
<div class="paragraph">
<p>Return to the poly shell to explore, then open other available docs at any time.</p>
</div>
<div class="paragraph">
<p>From the poly shell, type <code>doc</code> followed by a space to see the different help categories:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ doc
help   more   page   ws</code></pre>
</div>
</div>
<div class="paragraph">
<p>Doc categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#page">page</a> - web pages constitute the <code>poly</code> tool user manual, which you are reading a page of right now!</p>
</li>
<li>
<p><a href="#help">help</a> - <code>poly</code> <a href="#">commands</a> docs</p>
</li>
<li>
<p><a href="#ws">ws</a> - <a href="#">workspace structure</a> docs</p>
</li>
<li>
<p><a href="#more">more</a> - various other information: conceptual docs, blog posts, videos, podcasts, example workspaces, and other links</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s dig into these categories.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="page"><a class="link" href="#page">page</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use the <code>page</code> argument to open a specific <code>poly</code> tool documentation page in your web browser.
Notice that the shell lists all pages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ doc page:
artifacts                flags                    readme
base                     git-hooks                shell
build                    git                      source-code
colors                   install                  state
component                interface                tagging
configuration            introduction             tap
contact                  libraries                test-runners
continuous-integration   license                  testing
dependencies             naming                   tools-deps
developing-poly          polylith-ci-setup        upgrade
development              polyx                    validations
doc                      production-systems       versions
example-systems          profile                  workspace
explore-the-workspace    project</code></pre>
</div>
</div>
<div class="paragraph">
<p>These are the same pages you see listed in the left menu in your web browser.</p>
</div>
<div class="paragraph">
<p>When you select a page, <code>poly</code> will open it in your web browser.
To open the <code>flags</code> page:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">doc page:flags</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="help"><a class="link" href="#help">help</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>help</code> argument takes you to the <code>poly</code> <a href="#">commands</a> documentation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ doc help</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ask the shell to list all command help with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ doc help:
check                deps-project         shell
create-base          deps-workspace       switch-ws
create-component     deps                 tap
create-project       diff                 test
create-workspace     doc                  version
create               info                 ws
deps-brick           libs
deps-project-brick   overview</code></pre>
</div>
</div>
<div class="paragraph">
<p>To open the <code>check</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ doc help:check</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool will open help for the <a href="#check">check</a> command in your web browser.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can get the same help at your terminal via:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ help check</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ws"><a class="link" href="#ws">ws</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>ws</code> argument takes you to the <a href="#">Workspace structure</a> documentation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ doc ws</code></pre>
</div>
</div>
<div class="paragraph">
<p>List all top keys via:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ doc ws:
bases          name           user-input
changes        old            version
components     paths          ws-dir
configs        profiles       ws-local-dir
interfaces     projects       ws-reader
messages       settings       ws-type</code></pre>
</div>
</div>
<div class="paragraph">
<p>Open the description for a specific top key in your web browser:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ doc ws:configs</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="more"><a class="link" href="#more">more</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>more</code> argument covers all other documentation and links that are not specifically about the <code>poly</code> tool:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ doc more:
blog-posts    python-tool
high-level    slack
in-japanese   videos
podcasts      workspaces</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s dig into the different categories:</p>
</div>
<div class="sect2">
<h3 id="_blog_posts"><a class="link" href="#_blog_posts">blog posts</a></h3>
<div class="paragraph">
<p>Open blog posts via:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ doc more:blog-posts:
a-fresh-take-on-monorepos-in-python
how-polylith-came-to-life
leveraging-polylith-to-improve-consistency-reduce-complexity-and-increase-changeability
the-micro-monolith-architecture
the-monorepos-polylith-series
the-origin-of-complexity
understanding-polylith-through-the-lens-of-hexagonal-architecture</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Blog post</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">What</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published</p>
<p class="tableblock"><a id="leveraging-polylith"></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://medium.com/qantas-engineering-blog/leveraging-polylith-to-improve-consistency-reduce-complexity-and-increase-changeability-2031dd3d5f3d">leveraging-polylith-to-improve-consistency-reduce-complexity-and-increase-changeability</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/xlfe">Felix Barbalet</a> explains how Poilylith helps reduce complexity in an existing production system.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2024</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://medium.com/@joakimtengstrand/understanding-polylith-through-the-lens-of-hexagonal-architecture-8e7c8757dab1">understanding-polylith-through-the-lens-of-hexagonal-architecture</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/tengstrand">Joakim Tengstrand</a> explains the differences between the Hexagonal architecture and Polylith.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2023</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://davidvujic.blogspot.com/2022/02/a-fresh-take-on-monorepos-in-python.html">a-fresh-take-on-monorepos-in-python</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/DavidVujic">David Vujic</a> explains what would happen if they had Polylith in the Python community.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2022</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://corfield.org/blog/2021/04/21/deps-edn-monorepo-2/">the-monorepos-polylith-series</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/seancorfield">Sean Corfield</a> describes his experience migrating a big production system to Polylith in a series of blog posts.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2021-2023</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://itnext.io/the-origin-of-complexity-8ecb39130fc">the-origin-of-complexity</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/tengstrand">Joakim Tengstrand</a> explains the foundational concepts that Polylith is built upon.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2019</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://medium.com/@joakimtengstrand/the-polylith-architecture-1eec55c5ebce">how-polylith-came-to-life</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/tengstrand">Joakim Tengstrand</a> explains how the Polylith architecture came to life.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2018</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://medium.com/@joakimtengstrand/the-micro-monolith-architecture-d135d9cafbe">the-micro-monolith-architecture</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/tengstrand">Joakim Tengstrand</a> explains the ideas behind Micro Monolith, a predecessor to Polylith.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2016</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_high_level"><a class="link" href="#_high_level">high-level</a></h3>
<div class="paragraph">
<p>Open <a href="https://polylith.gitbook.io/polylith">conceptual, high-level</a> documentation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example$ doc more:high-level</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can list all pages in the left menu with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example$ doc more:high-level:
advantages-of-polylith
base
bring-it-all-together
component
current-architectures
development-project
faq
polylith-in-a-nutshell
production-systems
project
sharing-code
simplicity
testing-incrementally
tool
transitioning-to-polylith
videos
who-made-this
why-the-name-polylith
workspace</code></pre>
</div>
</div>
<div class="paragraph">
<p>Open a specific page, for example, the <a href="https://polylith.gitbook.io/polylith/conclusion/faq">FAQ</a> page, via:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example$ doc more:high-level:faq</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_in_japanese"><a class="link" href="#_in_japanese">in japanese</a></h3>
<div class="paragraph">
<p><a href="https://x.com/shinseitaro">Shinsei Taro</a> () has translated and reworked version 0.2.19 of the <code>poly</code> tool in Japanese, <a href="https://zenn.dev/shinseitaro/books/clojure-polylith">here</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_podcasts"><a class="link" href="#_podcasts">podcasts</a></h3>
<div class="paragraph">
<p>You can open the <a href="https://podcasts.apple.com/se/podcast/s4-e21-polylith-with-joakim-james-and-furkan-part-1/id1461500416?i=1000505948894">first episode</a> of the only podcast we have with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example$ doc more:podcasts:polylith-with-joakim-james-and-furkan:part1</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Podcast</th>
<th class="tableblock halign-left valign-top">What</th>
<th class="tableblock halign-left valign-top">Published</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://podcasts.apple.com/se/podcast/s4-e21-polylith-with-joakim-james-and-furkan-part-1/id1461500416?i=1000505948894&amp;l=en">polylith-with-joakim-james-and-furkan:part1</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/jacekschae">Jacek Schae</a> discusses the Polylith architecture with the <a href="https://polylith.gitbook.io/polylith/conclusion/who-made-polylith">Polylith team</a> where they explain the ideas behind Polylith.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2021</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://podcasts.apple.com/se/podcast/s4-e22-polylith-with-joakim-james-and-furkan-part-2/id1461500416?i=1000507542984">polylith-with-joakim-james-and-furkan:part2</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The same people go deeper into the Polylith concepts, its benefits, and how it differs from other ways of working with code.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2021</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_python_tool"><a class="link" href="#_python_tool">python tool</a></h3>
<div class="paragraph">
<p><a href="https://github.com/DavidVujic">David Vujic</a> has created <a href="https://davidvujic.github.io/python-polylith-docs">Polylith tools for Python</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example$ doc more:python-tool</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_slack"><a class="link" href="#_slack">slack</a></h3>
<div class="paragraph">
<p>Reach out to the <a href="https://polylith.gitbook.io/polylith/conclusion/who-made-polylith">Polylith team</a>
in the <a href="https://clojurians.slack.com/archives/C013B7MQHJQ">#polylith</a> channel
in the Clojurians Slack:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example$ doc more:slack</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="videos"><a class="link" href="#videos">videos</a></h3>
<div class="paragraph">
<p>You can list available videos with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example$ doc more:videos:
a-fresh-take-on-monorepos-in-python
collaborative-learning-polylith
how-the-polylith-repo-has-evolved-over-time
polylith-in-a-nutshell
polylitha-software-architecture-based-on-lego-like-blocks
the-last-architecture-you-will-ever-need</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Video</th>
<th class="tableblock halign-left valign-top">What</th>
<th class="tableblock halign-left valign-top">Published</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.youtube.com/watch?v=cfVzy9iPpLg">how-the-polylith-repo-has-evolved-over-time</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An animation that visualizes the evolution of the Polylith repository from its inception in 2020 to mid-2024. Generated in <a href="https://gource.io">Gource</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2024</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.youtube.com/watch?v=HU61vjZPPfQ">a-fresh-take-on-monorepos-in-python</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/DavidVujic">David Vujic</a> explains how Polylith can be used in <a href="https://en.wikipedia.org/wiki/Python_(programming_language)">Python</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2023</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.youtube.com/watch?v=_tpNKAv4fro">collaborative-learning-polylith</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sean Corfield is interviewed by the <a href="https://www.youtube.com/@losangelesclojureusersgrou5432">Los Angeles Clojure Users Group</a> about his experience with Polylith and how he uses the <code>poly</code> tool in production at <a href="https://polylith.gitbook.io/polylith/conclusion/production-systems#world-singles-networks">World Singles Network</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2022</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.youtube.com/watch?v=pebwHmibla4">the-last-architecture-you-will-ever-need</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/tengstrand">Joakim Tengstrand</a> and <a href="https://github.com/furkan3ayraktar">Furkan Bayraktar</a> try to convince people why Polylith is the last architecture they will ever need!</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.youtube.com/watch?v=Xz8slbpGvnk">polylith-in-a-nutshell</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.linkedin.com/in/james-trunk/">James Trunk</a> explains the basic concepts of the Polylith architecture.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2019</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.youtube.com/watch?v=wy4LZykQBkY">polylitha-software-architecture-based-on-lego-like-blocks</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/tengstrand">Joakim Tengstrand</a> explains how Polylith is like building with LEGO bricks, at <a href="https://www.youtube.com/playlist?list=PLaSn8eiZ631nv68lHjZIfrSXOLIDsf726">ClojureD 2019</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2019</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_workspaces"><a class="link" href="#_workspaces">workspaces</a></h3>
<div class="paragraph">
<p>List example poly workspace with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example$ doc more:workspaces:
game-of-life
polylith
realworld
usermanager</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Workspace</th>
<th class="tableblock halign-left valign-top">What</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/tengstrand/game-of-life">game-of-life</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A tiny workspace that implements <a href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life">Game of Life</a>, created by <a href="https://github.com/tengstrand">Joakim Tengstrand</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/polyfy/polylith">polylith</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Polylith workspace, from which this <code>poly</code> tool itself is built, mainly maintained by <a href="https://github.com/tengstrand">Joakim Tengstrand</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/furkan3ayraktar/clojure-polylith-realworld-example-app/tree/master">realworld</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A full-fledged RealWorld server, built with Clojure, Polylith, and Ring, including CRUD operations, authentication, routing, pagination, and more.
Created and maintained by <a href="https://github.com/furkan3ayraktar">Furkan Bayraktar</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/seancorfield/usermanager-example/tree/polylith">usermanager</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A simple web application using Component, Ring, Compojure, and Selmer connected to a local SQLite database.
Created and maintained by <a href="https://github.com/seancorfield">Sean Corfield</a>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tap"><a class="link" href="#_tap">Tap</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_tap_2" class="sect0"><a class="link" href="#_tap_2">Tap</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>We created the <code>tap</code> command to support <a href="#">developing poly</a>, but
you might find it an interesting way to browse the internal <a href="#">workspace structure</a>.</p>
</div>
<div class="paragraph">
<p>This command opens a separate <a href="https://github.com/djblue/portal">portal</a> window.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Portal is an excellent Clojure tool that makes browsing data a joy.
Whether or not you use our <code>tap</code> command, we recommend you check out <a href="https://github.com/djblue/portal">portal</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>tap</code> command only works with the <code>poly</code> <a href="#">shell</a>.
You can invoke it in two different ways:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Via the <code>:tap</code> argument when <a href="#launching">launching a poly shell</a>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly :tap</code></pre>
</div>
</div>
</li>
<li>
<p>By running the <a href="#tap">tap</a> command from a <code>poly</code> shell:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">example$ tap</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>You&#8217;ll see a separate portal window open; here, we show it placed to the right of the <code>poly</code> shell:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/tap/tap-shell.png" alt="tap shell">
</div>
</div>
<div class="paragraph">
<p>Click on the <code>:worskpace</code> key to dig into the <a href="#">workspace structure</a>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/tap/tap-workspace.png" alt="tap workspace" width="400">
</div>
</div>
<div class="paragraph">
<p>Any time the <code>poly</code> tool invokes <a href="https://clojuredocs.org/clojure.core/tap%3E">tap&gt;</a>, you&#8217;ll see the output in the portal window.
Starting with version <code>0.2.18</code> of <code>poly</code>, we only <code>tap&gt;</code> the workspace structure to keep output to portal minimal and clean.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tools_deps"><a class="link" href="#_tools_deps">Tools.deps</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_tools_deps_2" class="sect0"><a class="link" href="#_tools_deps_2">Tools.deps</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>We created the <code>poly</code> tool on top of Clojure tools.deps.
If you are unfamiliar with tools.deps, we recommend that you read its <a href="https://github.com/clojure/tools.deps">documentation</a> and <a href="https://clojure.org/reference/deps_edn">deps.edn Reference</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_poly_alias"><a class="link" href="#_the_poly_alias">The <code>poly</code> Alias</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you <a href="#">create a workspace</a>, <code>poly</code> generates a <code>./deps.edn</code> that includes a <code>poly</code> alias.
We cover details in our <a href="#use-as-dependency">install docs</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_clojure_vs_clj"><a class="link" href="#_clojure_vs_clj">clojure vs clj</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use <code>clojure</code> instead of <code>clj</code> when launching a <code>poly</code> <a href="#">shell</a> as <a href="#use-as-dependency">a clojure dependency</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">clojure -M:poly</code></pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Why? There are two ways to run clojure:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>clojure</code> - runs clojure programs</p>
</li>
<li>
<p><code>clj</code> - the same, but provides REPL command history support via <code>rlwrap</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>As described by <a href="https://betweentwoparens.com/blog/what-are-the-clojure-tools/#clj%2Fclojure">a "Between Two Parens" blog post</a>, <code>rlwrap</code> can sometimes get in the way. This is the case for the <code>poly</code> shell.</p>
</div>
<div class="paragraph">
<p>If you use <code>clj</code> instead of <code>clojure</code>, things will still work, but you will sometimes see warnings from <code>rlwrap</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">clj -M:poly</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/toolsdeps/clj-poly-shell.png" alt="clj poly shell" width="600">
</div>
</div>
<div class="paragraph">
<p>You don&#8217;t need that noise and confusion, so use <code>clojure</code> when launching a <code>poly</code> shell.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_build"><a class="link" href="#_build">Build</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_build_2" class="sect0"><a class="link" href="#_build_2">Build</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>The <code>poly</code> tool doesn&#8217;t include any <code>build</code> commands.
That&#8217;s because we don&#8217;t want <code>poly</code> to restrict your build pipeline in any way.
Instead, <code>poly</code> lets you choose how to build your deployable artifacts for your particular pipeline.
Whether you choose simple build scripts or cloud-based build tools, <code>poly</code> doesn&#8217;t get in the way.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s continue with our <a href="#">tutorial</a>.
The last thing you did was <a href="#">create a command-line project</a>.
Let&#8217;s add build support to create an executable jar file for the <code>command-line</code> project.</p>
</div>
<div class="paragraph">
<p>Per its philosophy, you&#8217;ll notice that <code>poly</code> did not generate any build scripts for your <code>example</code> workspace.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll be using <a href="https://github.com/clojure/tools.build">Clojure tools.build</a> to build your jar.
This is a common choice for <a href="#">tools.deps</a> projects.
We&#8217;ve created a sample <a href="/examples/doc-example/build.clj">build.clj</a> for you.
Copy it to your <code>example</code> workspace root:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example
 build.clj
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the uberjar configuration expected by our <code>build.clj</code> to your <code>command-line</code> project by adding <code>:uberjar</code> alias to <code>projects/command-line/deps.edn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:deps {poly/user {:local/root "../../components/user"}
        poly/cli  {:local/root "../../bases/cli"}

        org.clojure/clojure {:mvn/version "1.11.1"}}

 :aliases {:test {:extra-paths []
                  :extra-deps  {}}

           :uberjar {:main se.example.cli.core}}} <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add <code>:uberjar</code> alias describing the main entry point</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Add a <code>:build</code> alias to your <code>./deps.edn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:aliases {...
           :build {:deps {io.github.clojure/tools.build {:mvn/version "0.9.6"} <i class="conum" data-value="1"></i><b>(1)</b>
                          org.clojure/tools.deps {:mvn/version "0.16.1281"}}  <i class="conum" data-value="2"></i><b>(2)</b>
                   :paths ["build/resources"] <i class="conum" data-value="3"></i><b>(3)</b>
                   :ns-default build} <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Clojure <code>tools.build</code> support</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Our <code>build.clj</code> happens to use <code>tools.deps</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>An example of adding some resources to our classpath</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Points to our <code>build.clj</code></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Cursive Users</strong>:
Select the <code>build</code> alias and refresh the IDE:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/build/aliases.png" alt="aliases" width="400">
</div>
</div>
<div class="paragraph">
<p>Add <code>build</code> to Options in the REPL settings + restart the REPL:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/build/add-build-to-repl-settings.png" alt="add build to repl settings" width="600">
</div>
</div>
<div class="paragraph">
<p><strong>Older Versions of Cursive</strong></p>
</div>
<div class="paragraph">
<p>If you are still using Cursive pre v1.13.0 we recommend that you upgrade.</p>
</div>
<div class="paragraph">
<p>If you are unable to upgrade, you&#8217;ll need to set Options to <code>dev,test,build</code> instead.</p>
</div>
<div class="paragraph">
<p>You may also need to add the workspace root dir to your paths in your <code>./deps.edn</code> if the IDE doesn&#8217;t recognize <code>build.clj</code> as source code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:aliases  {...
            :build {...
                    :extra-paths ["."] <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add workspace root dir to paths if necessary</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_try_it_out"><a class="link" href="#_try_it_out">Try it out</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that you have everything set up, build the <code>command-line</code> jar by executing the following from the <code>example</code> workspace root dir:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">clojure -T:build uberjar :project command-line</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see some output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">Compiling se.example.cli.core...
Building uberjar target/command-line.jar...
Uberjar is built.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Congratulations!
You&#8217;ve just built your first artifact from a deployable project.
Try running it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">cd projects/command-line/target
java -jar command-line.jar Lisa</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">Hello Lisa!</code></pre>
</div>
</div>
<div class="paragraph">
<p>Nice, it worked!</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_git"><a class="link" href="#_git">Git</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_git_2" class="sect0"><a class="link" href="#_git_2">Git</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>Here, we explore how <code>poly</code> works with <a href="https://git-scm.com/">git</a>.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s continue with our <a href="#">tutorial</a>.
The last thing we did in our tutorial was <a href="#">add build support</a>.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll start with the <a href="#info">info</a> command.
We have had you run this command without explaining everything it outputs.
Rerun <code>info</code> to see the current state of your workspace:</p>
</div>
<div id="info-all-changed-example" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/git/output/info.png" alt="info" width="400">
</div>
</div>
<div class="paragraph">
<p>At the top, you&#8217;ll notice <code>stable since: c91fdad</code> (your git short-SHA will differ from our <code>c91fdad</code>).
What does this mean?
Let&#8217;s start from the beginning.</p>
</div>
<div class="paragraph">
<p>When you specify <code>:commit</code> when <a href="#">creating a Polylith workspace</a>, <code>poly</code> executes these git commands on your behalf:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">git init
git add .
git commit -m "Workspace created."</code></pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>If you don&#8217;t specify <code>:commit</code> for the <a href="#create-workspace">create workspace</a> command, it is up to you to execute the above <code>git</code> commands (or the equivalent) manually.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Run <code>git log</code> from your <code>example</code> workspace root, and you&#8217;ll see something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">commit c91fdad4a34927d9aacfe4b04ea2f304f3303282 (HEAD -&gt; main)
Author: lisa &lt;lisa@gmail.com&gt;
Date:   Thu Sep 3 06:11:23 2020 +0200

    Workspace created.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is the first and only commit for this git repository.
Notice that the commit hash matches the short-SHA from the <code>info</code> command output: <code>stable since: c91fdad</code>.
This first commit is considered the first <em>stable point in time</em> for this workspace.</p>
</div>
<div class="paragraph">
<p>The <code>info</code> command calculates what has changed since the current <em>stable point in time</em>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<strong>Cursive users</strong>:
If you followed our <a href="#cursive-enable-auto-add">setup instructions</a>, Cursive will automatically add new files to the git repository.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If all files have not been added to git yet, add them now:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">git add --all</code></pre>
</div>
</div>
<div class="paragraph">
<p>Look at the <code>info</code> command output again:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/git/output/info.png" alt="info" width="400">
</div>
</div>
<div class="paragraph">
<p>Notice that <code>poly</code> has marked all projects (<code>command-line</code> and <code>development</code>) and all bricks (<code>user</code> and <code>cli</code>) with a trailing <code>*</code> (asterisk), meaning they have changed after the current <em>stable point in time</em> (as described by <code>stable since: c91fdad</code>).</p>
</div>
<div class="paragraph">
<p>Let&#8217;s dig into how <code>poly</code> determines this.
Run the <a href="#diff">diff</a> command to see all files that have been added since the last commit:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly diff</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see output like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">bases/cli/deps.edn
bases/cli/resources/cli/.keep
bases/cli/src/se/example/cli/core.clj
bases/cli/test/se/example/cli/core_test.clj
build.clj
components/user/deps.edn
components/user/resources/user/.keep
components/user/src/se/example/user/core.clj
components/user/src/se/example/user/interface.clj
components/user/test/se/example/user/interface_test.clj
deps.edn
development/src/dev/lisa.clj
projects/command-line/deps.edn
workspace.edn</code></pre>
</div>
</div>
<div class="paragraph">
<p>We expect you are starting to see how <code>poly</code> decides to mark items as changed with the <code>*</code> (asterisk):</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">The <code>poly</code> tool knows that there are changes in:</th>
<th class="tableblock halign-left valign-top">Because there are differences under dir:</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>command-line</code> project</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>projects/command-line/</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>development</code> project</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>development/</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>user</code> brick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>component/user/</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cli</code> brick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bases/cli/</code></p></td>
</tr>
</tbody>
</table>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Internally, the <code>diff</code> command runs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">git diff c91fdad4a34927d9aacfe4b04ea2f304f3303282 --name-only</code></pre>
</div>
</div>
<div class="paragraph">
<p>If your <a href="#workspace-root-under-git-root">workspace root isn&#8217;t the same as your git root</a>, the <code>diff</code> command will internally strip away the workspace directory.</p>
</div>
<div class="paragraph">
<p>The workspace directory is available via <code>poly get:ws-local-dir</code> and will return <code>nil</code> if your workspace is at the git root.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>When you created your <a href="#">workspace</a>, <code>poly</code> created a  <a href="https://git-scm.com/docs/gitignore">.gitignore</a> for you.
Now is a good time to add more rules to <code>/.gitignore</code> if needed.</p>
</div>
<div id="add-and-commit" class="paragraph">
<p>Add and commit any new and changed files:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">git add --all
git commit -m "Created the user and cli bricks."</code></pre>
</div>
</div>
<div class="paragraph">
<p>Have a look at our workspace repository commit history again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">git log --pretty=oneline</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your git SHAs will be different, but you&#8217;ll see something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">e7ebe683a775ec28b7c2b5d77e01e79d48149d13 (HEAD -&gt; main) Created the user and cli bricks.
c91fdad4a34927d9aacfe4b04ea2f304f3303282 Workspace created.</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you rerun the <a href="#info">info</a> command, it will return the same result as before.
This is because you haven&#8217;t moved your <em>stable point in time</em> yet.
We&#8217;ll dig into this in <a href="#">Tagging</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tagging"><a class="link" href="#_tagging">Tagging</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_tagging_2" class="sect0"><a class="link" href="#_tagging_2">Tagging</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>We touched on the concept of a <em>stable point in time</em> in our <a href="#">Git</a> docs.
Now, we&#8217;ll show how we use git tagging to mark and move a workspace&#8217;s <em>stable point in time</em>.</p>
</div>
<div class="paragraph">
<p>We consider a workspace stable when the whole workspace is in a valid state.
For example, when all code compiles, all tests pass, and the <a href="#check">check</a> command executes without error.</p>
</div>
<div class="paragraph">
<p>The <a href="#">test</a> command leverages the concept of stability to support running tests incrementally.
It can reduce a test run to only those tests affected by changes since the last known <em>stable point in time</em>.
As you can imagine, skipping unnecessary tests can significantly reduce test run times!</p>
</div>
<div class="paragraph">
<p>To mark a <em>stable point in time</em>, we use a <a href="https://git-scm.com/book/en/v2/Git-Basics-Tagging">git tag</a>.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s continue with our <a href="#">tutorial</a>.
We last left off by <a href="#add-and-commit">adding and committing your workspace files to git</a>.</p>
</div>
<div class="paragraph">
<p>Mark your <code>example</code> workspace as stable by tagging it with git:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">git tag -f stable-lisa <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>-f</code> tells git to move the tag if it already exists</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Run <code>git log --pretty=format'%h %d%n %s'</code>, you&#8217;ll see something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">e7ebe68  (HEAD -&gt; main, tag: stable-lisa)  <i class="conum" data-value="1"></i><b>(1)</b>
 Created the user and cli bricks.
c91fdad
 Workspace created.</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Notice the <code>stable-lisa</code> tag you added is on the second commit.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We used <code>git log --pretty=format'%h %d%n %s</code> for compact documentation-friendly output.
Feel free to use <code>git log --pretty=oneline</code> or even <code>git log</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Rerun the <code>poly <a href="#info">info</a></code> command, and you&#8217;ll see something like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/tagging/output/info-01.png" alt="info 01" width="400">
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Remember that git hashes (SHAs and short-SHAs) are globally unique.
Yours will differ from our <code>e7ebe68</code> and <code>c91fdad</code>.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Notice that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>stable since</code> line shows:</p>
<div class="ulist">
<ul>
<li>
<p>A short-SHA <code>e7ebe68</code> that matches the second commit.</p>
</li>
<li>
<p>The <code>stable-lisa</code> tag.</p>
</li>
</ul>
</div>
</li>
<li>
<p>All the <code>*</code> (asterisk) markers <a href="#info-all-changed-example">you saw in the previous info output</a> are gone because no brick (component or base) or project has changed since our new <em>stable point in time</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Run <code>poly diff</code>; you&#8217;ll see no output because nothing has changed.</p>
</div>
<div class="paragraph">
<p>Our example uses the git tag <code>stable-lisa</code>, but <code>poly</code> recognizes any tag that starts with <code>stable-</code> as a <em>stable point in time</em>.
We chose <code>stable-lisa</code> because Lisa is our name (let&#8217;s pretend, at least!).
This convention allows every developer to have their own unique <em>stable point in time</em>.</p>
</div>
<div class="paragraph">
<p>Your continuous integration (CI) build should use its own unique git tag pattern to mark successful builds (and, therefore, stable workspaces).
A convention like <code>stable-</code> plus branch name or <code>stable-</code> plus build number can work nicely.</p>
</div>
<div class="paragraph">
<p>We recommend that you start with <code>stable-</code> tags created by your CI server and add developer-specific <code>stable-</code> tags when needed.</p>
</div>
<div class="paragraph">
<p>We think that git tags that start with <code>stable-</code> is a magnificent naming convention, but if you really prefer something different, you can override this default in your <code>workspace.edn</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure"> :tag-patterns {:stable "stable-*" <i class="conum" data-value="1"></i><b>(1)</b>
                :release "v[0-9]*"}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Override the default <code>stable-*</code> regular expression to your own convention, if you wish</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Internally, <code>poly</code> finds the <em>stable point in time</em> commit via:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">git log --pretty=format:'%H %d'</code></pre>
</div>
</div>
<div class="paragraph">
<p>For our current example, this outputs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">e7ebe683a775ec28b7c2b5d77e01e79d48149d13 (HEAD -&gt; master, tag: stable-lisa)
c91fdad4a34927d9aacfe4b04ea2f304f3303282</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool parses the output for the first line that matches the <code>:stable</code> tag pattern (by default <code>stable-*</code>).
If it finds no matches, the first commit in the git repository is the <em>stable point in time</em> commit.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ve seen the <code>info</code> command <a href="#info-all-changed-example">output when all bricks and projects have changed</a> since the <em>stable point in time</em>; all bricks and projects showed a trailing <code>*</code> (asterisk).</p>
</div>
<div id="make-a-change" class="paragraph">
<p>What happens if only some bricks have changed?
Let&#8217;s find out.
Add a comment to the <code>user.core</code> namespace by editing <code>./components/user/src/se/example/user/core.clj</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns se.example.user.core)

; hi! <i class="conum" data-value="1"></i><b>(1)</b>
(defn hello [name]
  (str "Hello " name "!"))</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add a comment line</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Run <code>poly <a href="#info">info</a></code> again:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/tagging/output/info-02.png" alt="info 02" width="400">
</div>
</div>
<div class="paragraph">
<p>As expected, the <code>user</code> component now shows a trailing <code>*</code>.
Notice that both <code>command-line</code> and <code>development</code> projects show a trailing <code>&#43;</code>.
The <code>&#43;</code> indicates the projects have no changes, but at least one of their bricks has changed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="release"><a class="link" href="#release">Release</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you release, we recommend your CI server git tag the release.
But here, we&#8217;ll have you experiment from your command line shell.</p>
</div>
<div class="paragraph">
<p>Run <code>git log --pretty=format'%h %d%n %s</code> to look at your current commit history and tags:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">e7ebe68  (HEAD -&gt; master, tag: stable-lisa)
 Created the user and cli bricks.
c91fdad
 Workspace created.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Tag the first commit as <code>v1.1.0</code> and the second as <code>v1.2.0</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">git tag v1.1.0 c91fdad <i class="conum" data-value="1"></i><b>(1)</b>
git tag v1.2.0</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>replace <code>c91fdad</code> with your corresponding SHA for your first commit</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Rerun <code>git log --pretty=format'%h %d%n %s</code> to verify your new tags:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">e7ebe68  (HEAD -&gt; master, tag: v1.2.0, tag: stable-lisa)
 Created the user and cli bricks.
c91fdad  (tag: v1.1.0)
 Workspace created.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now run <code>poly info</code> against your latest release:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info since:release</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/tagging/output/info-03.png" alt="info 03" width="400">
</div>
</div>
<div class="paragraph">
<p>If you execute <code>poly info</code> against the previous release:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info since:previous-release</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/tagging/output/info-04.png" alt="info 04" width="400">
</div>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool has picked up the second latest release tag.</p>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool matches release tags as defined by your <code>workspace.edn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure"> :tag-patterns {:stable "stable-*"
                :release "v[0-9]*"} <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Default regular expression for git <code>:release</code> tags is <code>v[0-9]*</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can use the <code>since</code> argument on your CI server to run only the necessary tests since the previous release.
Unaffected code does not need to be retested.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly test since:previous-release</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You&#8217;ll use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>since:previous-release</code> if your release process adds a release tag before your build.</p>
</li>
<li>
<p><code>since:release</code> if it adds a release tag after your build</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If the <code>since</code> argument is not specified, <code>since:stable</code> is used by default.<br>
Other variants, like <code>since:e7ebe68v</code>, <code>since:head</code>, and <code>since:head~1</code> are also valid.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See <a href="#">Continuous Integration</a> for tagging and release strategies.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_flags"><a class="link" href="#_flags">Flags</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_flags_2" class="sect0"><a class="link" href="#_flags_2">Flags</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>You&#8217;ve seen output from the <a href="#info">info</a> command, but we haven&#8217;t explained flags:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/flags/info-flags.png" alt="info flags" width="475">
</div>
</div>
<div class="paragraph">
<p>There are four possible flags:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flag</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>s</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relates to source code</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>r</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relates to resources <a href="#r-flag">and is only shown when requested</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>t</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relates to tests</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>x</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Indicates <code>poly</code> will e<strong>x</strong>ecute tests</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Fun flag facts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Flags are booleans, <code>poly</code> shows:</p>
<div class="ulist">
<ul>
<li>
<p>the flag when <code>true</code>.</p>
</li>
<li>
<p>the <code>-</code> (dash) character when <code>false</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Flags always appear in order: <code>srtx</code>.</p>
</li>
<li>
<p>The <code>r</code> flag isn&#8217;t included by default.</p>
</li>
<li>
<p>The specific meaning of a flag depends on where it appears.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We&#8217;ll cover the <code>x</code> flag in more detail when we get to <a href="#">Testing</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For the sake of simplicity, we&#8217;ll describe the presence of sources as a single <code>src</code> directory and the presence of tests as a single <code>test</code> directory.
In reality, projects and bricks can choose to have multiple or different source and test paths.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_project_flags"><a class="link" href="#_project_flags">Project Flags</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>From our example above:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/flags/projects.png" alt="projects" width="299">
</div>
</div>
<div class="paragraph">
<p>The <code>info</code> command outputs a table summarizing <a href="#">projects</a>.
There is one row for each project and a <code>status</code> and <code>dev</code> column for flags.</p>
</div>
<div class="sect2">
<h3 id="_projects_status_column_flags"><a class="link" href="#_projects_status_column_flags">Projects <code>status</code> Column Flags</a></h3>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flag</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>s</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The project has a <code>src</code> directory.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>t</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The project has a <code>test</code> directory.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>x</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The <code>poly test</code> command will run tests for this project</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>From our example above:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/flags/projects-status.png" alt="projects status" width="350">
</div>
</div>
<div class="paragraph">
<p>The <code>status</code> flags <code>---</code> for <code>command-line</code> means <code>poly</code> sees:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>a <code>./projects/command-line</code> directory</p>
</li>
<li>
<p>no <code>./projects/command-line/src</code> directory</p>
</li>
<li>
<p>no <code>./projects/command-line/test</code> directory</p>
</li>
<li>
<p>no reason to run tests for this project</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The <code>status</code> flags <code>s--</code> for <code>development</code> means <code>poly</code> sees:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>a <code>./development/src</code> directory</p>
</li>
<li>
<p>no <code>./development/test</code> directory</p>
</li>
<li>
<p>no reasons to run tests for this project</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_projects_dev_column_flags"><a class="link" href="#_projects_dev_column_flags">Projects <code>dev</code> Column Flags</a></h3>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flag</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>s</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The <code>src</code> directory of the project is referenced by the <code>development</code> project</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>t</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The <code>test</code> directory of the project is referenced by the <code>development</code> project</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>x</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The <code>poly test</code> command will run tests for the project from the <code>development</code> project</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>From our example above:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/flags/projects-dev.png" alt="projects dev" width="350">
</div>
</div>
<div class="paragraph">
<p>The <code>dev</code> flags <code>---</code> for <code>command-line</code> means <code>poly</code> sees:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>./projects/command-line/src</code> isn&#8217;t referenced in <code>./deps.edn</code></p>
</li>
<li>
<p><code>./projects/command-line/test</code> isn&#8217;t referenced in <code>./deps.edn</code></p>
</li>
<li>
<p>no reason to run tests for the <code>command-line</code> project from the <code>development</code> project</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The <code>dev</code> flags <code>s---</code> for <code>development</code> means <code>poly</code> sees:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>./development/src</code> is referenced in <code>./deps.edn</code></p>
</li>
<li>
<p><code>./development/test</code> isn&#8217;t referenced in <code>./deps.edn</code></p>
</li>
<li>
<p>no reason to run tests for the <code>development</code> project</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You might wonder about the <code>development</code> row intersecting with the <code>dev</code> column:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Isn&#8217;t that talking about the <code>development</code> project referencing the <code>development</code> project?
Yes.</p>
</li>
<li>
<p>So wouldn&#8217;t <code>status</code> be the same as <code>dev</code> for the <code>development</code> row? Also, yes.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>development</code> project exists to support development.
It would be unusual for it to have tests of its own.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_brick_flags"><a class="link" href="#_brick_flags">Brick Flags</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>From our example above:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/flags/bricks.png" alt="bricks" width="299">
</div>
</div>
<div class="paragraph">
<p>The <code>info</code> command outputs a table summarizing bricks (<a href="#">components</a> and <a href="#">bases</a>).
There is one row for each brick and one column for each <a href="#">project</a>.
You&#8217;ll see one column for each deployable project and a <code>dev</code> column for the <code>development</code> project.
Our <code>example</code> workspace only has the <code>command-line</code> deployable project, <a href="#project-alias">which you&#8217;ll remember you aliased as cl</a>.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flag</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>s</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The brick&#8217;s <code>src</code> directory is referenced by the project in this column</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>t</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The brick&#8217;s <code>test</code> directory is referenced by the project in this column</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>x</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The <code>poly test</code> command will run tests for this brick from the project in this column</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_bricks_deployable_projects_columns"><a class="link" href="#_bricks_deployable_projects_columns">Bricks Deployable Projects Columns</a></h3>
<div class="paragraph">
<p>From our example above:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/flags/bricks-deployable-projects.png" alt="bricks deployable projects" width="299">
</div>
</div>
<div class="paragraph">
<p>We have a single deployable <code>command-line</code> project aliased as <code>cl</code>.</p>
</div>
<div class="paragraph">
<p>The <code>cl</code> flags <code>st-</code> for the <code>user</code> component means <code>poly</code> sees:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the <code>command-line</code> project references the <code>user</code> component, and the <code>user</code> component has:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>a <code>src</code> directory specified in its <code>deps.edn</code></p>
</li>
<li>
<p>a <code>test</code> directory specified in its <code>deps.edn</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>no reason to run tests for the <code>user</code> component for the <code>command-line</code> project</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The <code>cl</code> flags <code>st-</code> for the <code>cli</code> base follow the same pattern.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>A reminder of relevant <code>projects/command-line/deps.edn</code> configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:deps {poly/remote {:local/root "../../components/user"}
        poly/cli    {:local/root "../../bases/cli"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And, in turn, the relevant <code>components/user/deps.edn</code> and <code>bases/cli/deps.edn</code> configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:paths ["src" "resources"]
 :deps {}
 :aliases {:test {:extra-paths ["test"]
                  :extra-deps {}}}}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bricks_dev_project_column"><a class="link" href="#_bricks_dev_project_column">Bricks <code>dev</code> Project Column</a></h3>
<div class="paragraph">
<p>From our example above:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/flags/bricks-dev.png" alt="bricks dev" width="299">
</div>
</div>
<div class="paragraph">
<p>The <code>dev</code> flags <code>st-</code> for the <code>user</code> component means <code>poly</code> sees:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>./components/user/src</code> is referenced by the <code>development</code> project</p>
</li>
<li>
<p><code>./components/user/test</code> is referenced by the <code>development</code> project</p>
</li>
<li>
<p>no reason to run tests for this brick for this project</p>
</li>
</ol>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>To remind you of how <code>src</code> and <code>test</code> are referenced, the relevant portion of our <code>./deps.edn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure"> :aliases  {:dev {:extra-deps {poly/user {:local/root "components/user"} <i class="conum" data-value="1"></i><b>(1)</b>
  ...
            :test {:extra-paths ["components/user/test" <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Development project referencing user component src via <code>:local/root</code> dep</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Development project referencing user component test via <code>:extra-paths</code></td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="r-flag"><a class="link" href="#r-flag">The optional <code>r</code> flag</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you execute <code>poly info :resources</code> (or the shorter <code>poly info :r</code>):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/flags/output/info.png" alt="info" width="400">
</div>
</div>
<div class="paragraph">
<p>Notice that <code>poly</code> has included the <code>r</code> (resources) flag.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing"><a class="link" href="#_testing">Testing</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_testing_2" class="sect0"><a class="link" href="#_testing_2">Testing</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>Polylith encourages a test-centric approach when working with code.
New tests are easy to write, and you can avoid mocking in most cases because you can access all <a href="#">components</a> from your <a href="#">workspace</a>.</p>
</div>
<div class="paragraph">
<p>You write tests for your bricks (<a href="#">bases</a> and <a href="#">components</a>) and <a href="#">deployable projects</a>.
The <code>poly</code> tool always runs brick tests from the context of the deployable projects that reference them.
This convention verifies that the bricks tests pass using the classpath formulated from the project and all its referenced bricks.</p>
</div>
<div class="paragraph">
<p>The <code>development</code> project offers a way to run tests from your REPL and a temporary home (and test vehicle) for new bricks that aren&#8217;t yet part of any deployable project.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s continue with our <a href="#">tutorial</a>, we last left off exploring <a href="#">tagging</a>.</p>
</div>
<div class="paragraph">
<p>The <a href="#info">info</a> command provides a great way to see what tests <code>poly</code> will run.
Rerun <code>poly info</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/info-annotated.png" alt="info annotated" width="400">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the <a href="#">Flags</a> doc for a general description of flags.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Notice that <code>poly</code> has marked the <code>user</code> component with <code>*</code> (asterisk) because as part of our tutorial, <a href="#make-a-change">you changed its core namespace</a>.</p>
</div>
<div class="paragraph">
<p>Notice the <code>stx</code> flags under the <code>cl</code> column for both the <code>user</code> and <code>cli</code> bricks.
The <code>x</code> flags mean <code>poly <a href="#test">test</a></code> will run tests for these bricks from the <code>command-line</code> project.</p>
</div>
<div class="paragraph">
<p>There is no <code>*</code> after the <code>cli</code> brick, so why is it marked to be tested with the <code>x</code> flag?
Well, even though the <code>cli</code> brick hasn&#8217;t changed, it depends on the <code>user</code> brick, which has changed, so <code>poly</code> needs to retest it.</p>
</div>
<div class="paragraph">
<p>Notice the absence of the <code>x</code> flag in the <code>st-</code> flags under the <code>dev</code> column for both the <code>user</code> and <code>cli</code> bricks.
Bricks are not tested from the <code>development</code> by default.</p>
</div>
<div class="paragraph">
<p>Before you run the <a href="#test">test</a> command, edit the <code>interface-test</code> namespace in the <code>user</code> component.
Replace the <code>dummy-test</code> with a real test:</p>
</div>
<div class="listingblock">
<div class="title">components/user/test/se/example/user/interface_test.clj</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns se.example.user.interface-test
  (:require [clojure.test :refer :all]
            [se.example.user.interface :as user]))

(deftest hello--when-called-with-a-name--then-return-hello-phrase
  (is (= "Hello Lisa!"
         (user/hello "Lisa"))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>To explore how <code>poly</code> handles a failing test, change the <code>core</code> namespace in the <code>user</code> component:</p>
</div>
<div class="listingblock">
<div class="title">components/user/src/se/example/user/core.clj</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns se.example.user.core)

(defn hello [name]
  (str "Hello " name "!!")) <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add an extra <code>!</code></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Cursive users</strong>:
You can run the test from your IDE:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Make sure the namespace is loaded, e.g. via the menu (or keyboard shortcuts) <code>Tools &gt; REPL &gt; Load File in REPL</code>.</p>
</li>
<li>
<p>Or, place the cursor under the test and run: <code>Tools &gt; REPL &gt; Run Test under carret in REPL</code></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/failing-test.png" alt="failing test">
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Cursive users</strong>:</p>
</div>
<div class="paragraph">
<p>If you haven&#8217;t already, you need to instruct Cursive to run tests from the root module, see instructions <a href="https://cursive-ide.com/userguide/polylith.html">here</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In some of the examples that follow, the <code>poly</code> exit code is relevant.
In those cases, at the end of the output, we&#8217;ll show the exit code like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell"># Exit code: 0</code></pre>
</div>
</div>
<div class="paragraph">
<p>This line is not part of the actual <code>poly</code> output and is only a convention to convey the process exit code to you.
As is the standard convention, an exit code of <code>0</code> conveys success.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Run the <a href="#test">test</a> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly test</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see output like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">Projects to run tests from: command-line

Running tests for the command-line project using test runner: Polylith built-in clojure.test runner... <i class="conum" data-value="1"></i><b>(1)</b>
Running tests from the command-line project, including 2 bricks: user, cli <i class="conum" data-value="2"></i><b>(2)</b>

Testing se.example.cli.core-test

Ran 1 tests containing 1 assertions.
0 failures, 0 errors.

Test results: 1 passes, 0 failures, 0 errors.

Testing se.example.user.interface-test

FAIL in (hello--when-called-with-a-name--then-return-hello-phrase) (interface_test.clj:6) <i class="conum" data-value="3"></i><b>(3)</b>
expected: (= "Hello Lisa!" (user/hello "Lisa"))
  actual: (not (= "Hello Lisa!" "Hello Lisa!!"))

Ran 1 tests containing 1 assertions.
1 failures, 0 errors. <i class="conum" data-value="3"></i><b>(3)</b>

Test results: 0 passes, 1 failures, 0 errors. <i class="conum" data-value="3"></i><b>(3)</b>

# Exit code: 1 <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>poly</code> tool runs tests in the context of each project.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The referenced bricks are tested within the context of the project.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Notice evidence of the failing test</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Adapt your test to match the new behavior:</p>
</div>
<div class="listingblock">
<div class="title">components/user/test/se/example/user/interface_test.clj</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns se.example.user.interface-test
  (:require [clojure.test :refer :all]
            [se.example.user.interface :as user]))

(deftest hello--when-called-with-a-name--then-return-hello-phrase
  (is (= "Hello Lisa!!" <i class="conum" data-value="1"></i><b>(1)</b>
         (user/hello "Lisa"))))</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Edit to expect the extra <code>!</code> so the test will pass</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Cursive users</strong>:
If you rerun the test from the REPL, it will now turn green:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/successful-test.png" alt="successful test">
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Rerun <code>test</code> with poly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly test</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see output like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">Projects to run tests from: command-line

Running tests for the command-line project using test runner: Polylith built-in clojure.test runner...
Running tests from the command-line project, including 2 bricks: user, cli

Testing se.example.cli.core-test

Ran 1 tests containing 1 assertions.
0 failures, 0 errors.

Test results: 1 passes, 0 failures, 0 errors.

Testing se.example.user.interface-test

Ran 1 tests containing 1 assertions.
0 failures, 0 errors. <i class="conum" data-value="1"></i><b>(1)</b>

Test results: 1 passes, 0 failures, 0 errors. <i class="conum" data-value="1"></i><b>(1)</b>

Execution time: 1 seconds

# Exit code: 0 <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Notice evidence of the now-passing test</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Brick tests are not evaluated for execution from the <code>development</code> project by default.
Specify the <code>:dev</code> argument to include the <code>development</code> project.</p>
</div>
<div class="paragraph">
<p>Try it out with the <a href="#info">info</a> command to see the impact of what will be tested:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info :dev</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/info-dev-annotated.png" alt="info dev annotated" width="400">
</div>
</div>
<div class="paragraph">
<p>Notice under the <code>dev</code> column, <code>poly</code> marked both the <code>user</code> and the <code>cli</code> bricks for test execution with the <code>x</code> flag.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You don&#8217;t need to bring in <code>dev</code> for test execution when your projects reference all your bricks.
But sometimes, you&#8217;ll create a brick before a project.
In this case, you can include the brick for testing from <code>dev</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
When a brick is marked for testing from multiple projects, <code>poly</code> will run its tests in the context of each of those projects.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test_filters"><a class="link" href="#_test_filters">Test Filters</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="filter-projects"><a class="link" href="#filter-projects">Filter on Projects</a></h3>
<div class="paragraph">
<p>You can narrow the number of projects to test by specifying, e.g., <code>project:dev</code> or <code>project:cl:dev</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>You can use full project names or aliases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>project:development</code> is equivalent to <code>project:dev</code></p>
</li>
<li>
<p><code>project:command-line:development</code> is the same as <code>project:cl:dev</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>If you only specify <code>project:dev</code>, then <code>poly</code> only includes the <code>development</code> project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info project:dev</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/info-project-dev-annotated.png" alt="info project dev annotated" width="400">
</div>
</div>
<div class="paragraph">
<p>Notice:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the absence of <code>x</code> in the <code>st-</code> flags under the <code>cl</code> column</p>
</li>
<li>
<p>the presence of <code>x</code> in the <code>stx</code> flags under the <code>dev</code> column.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can consider <code>poly info :dev</code> as a shorthand for selecting all projects.
The equivalent, when specifying the <code>project</code> argument, requires specifying all projects:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info project:cl:dev</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/info-project-cl-dev-annotated.png" alt="info project cl dev annotated" width="400">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
We&#8217;ll show later that the <code>project</code> argument also applies to <a href="#project-tests">project tests</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="filter-bricks"><a class="link" href="#filter-bricks">Filter on Bricks</a></h3>
<div class="paragraph">
<p>You can also filter which bricks to include for test execution.
If you&#8217;ve been following the tutorial, your workspace looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/info-filter-on-bricks-annotated.png" alt="info filter on bricks annotated" width="400">
</div>
</div>
<div class="paragraph">
<p>The <code>x</code> flags under the <code>cl</code> column mean <code>poly</code> will test both bricks from the <code>command-line</code> project.</p>
</div>
<div class="paragraph">
<p>If you filter on the <code>cli</code> brick:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info brick:cli</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/info-brick-cli-annotated.png" alt="info brick cli annotated" width="400">
</div>
</div>
<div class="paragraph">
<p>Notice that <code>poly</code> has marked only the <code>cli</code> brick for testing.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s pretend that no bricks are marked by <code>poly</code> for testing:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/info-no-changes-annotated.png" alt="info no changes annotated" width="400">
</div>
</div>
<div class="paragraph">
<p>Rerunning <code>poly info brick:cli</code> again gives the exact same result:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/info-brick-cli-no-changes-annotated.png" alt="info brick cli no changes annotated" width="400">
</div>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool applies the <code>brick:cli</code> filter argument after it has evaluated <code>cli</code> for test execution.</p>
</div>
<div class="paragraph">
<p>If you want to force the <code>cli</code> brick tests to run, you need to pass in <code>:all-bricks</code> (or <code>:all</code>, if you also want to execute the project tests):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info brick:cli :all-bricks</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/info-brick-cli-no-changes-all-bricks-annotated.png" alt="info brick cli no changes all bricks annotated" width="400">
</div>
</div>
<div class="paragraph">
<p>Notice the <code>x</code> in <code>stx</code> flags; you have forced <code>poly</code> to mark the <code>cli</code> brick for testing.</p>
</div>
<div class="paragraph">
<p>You can specify multiple bricks, e.g., <code>brick:cli:user</code>.</p>
</div>
<div class="paragraph">
<p>You can exclude all bricks with the <code>brick:-</code> argument, which can be useful when combined with <code>:project</code> or <code>:all</code> to execute only the project tests.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="project-tests"><a class="link" href="#project-tests">Project Tests</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before we proceed, let&#8217;s add a test to the <code>command-line</code> project.</p>
</div>
<div class="paragraph">
<p>Add a <code>test</code> directory to the <code>command-line</code> project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example
 projects
    command-line
        test</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then add the <code>test</code> path to <code>projects/command-line/deps.edn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure"> :aliases {:test {:extra-paths ["test"] <i class="conum" data-value="1"></i><b>(1)</b>
                  :extra-deps  {}}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add <code>test</code> path</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now add this same path to your <code>./deps.edn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">            :test {:extra-paths ["components/user/test"
                                 "bases/cli/test"
                                 "projects/command-line/test"]} <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add <code>projects/command-line/test</code> path</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally, add a <code>project.command-line.dummy-test</code> namespace to the <code>command-line</code> project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example
 projects
    command-line
        test
            project
               command_line
                  dummy_test.clj</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns project.command-line.dummy-test <i class="conum" data-value="1"></i><b>(1)</b>
  (:require [clojure.test :refer :all]))

(deftest dummy-test
  (is (= 1 1)))</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If you&#8217;ve been following our tutorial, you might notice we did not begin with our top namespace <code>se.example</code>.
We could have chosen <code>se.example.project.command-line</code>, but note that this would conflict if we also had <code>project</code> brick.
To avoid conflicts with bricks and keep things short and simple, we&#8217;ve opted for <code>project.command-line</code> here.
Also, because <code>poly</code> executes each project in isolation, the choice of namespace is less critical.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Normally, when you write tests in Clojure, you match the test namespace to the namespace it is testing.
This strategy gives your tests access to private vars in the tested namespace.
The <code>poly</code> tool guarantees encapsulation, which makes the usage of private vars unnecessary, allowing for more flexibility in test namespace choices.
See <a href="#">Interface</a> for more details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Rerun <code>poly <a href="#info">info</a></code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/info-project-dir-annotated.png" alt="info project dir annotated" width="400">
</div>
</div>
<div class="paragraph">
<p>Notice <code>poly</code> has marked the <code>command-line</code> project as changed with a <code>*</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>status</code> flags of <code>-t-</code> to tell us that the project now has a <code>test</code> directory.</p>
</li>
<li>
<p><code>dev</code> flags of <code>-t-</code> mean the project is referenced by the <code>development</code> project</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>But why no <code>x</code> flag?
Well, <code>poly</code> doesn&#8217;t execute project tests to by default.
You must specify <code>:project</code> (or <code>:all</code>) to also include projects:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info :project</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/info-project-annotated.png" alt="info project annotated" width="400">
</div>
</div>
<div class="paragraph">
<p>Notice the <code>x</code> in the <code>-tx</code> flags under the <code>status</code> column; this means <code>poly</code> has marked the <code>command-line</code> project for testing.
Let&#8217;s verify by running the tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly test :project</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see output like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">Projects to run tests from: command-line

Running tests for the command-line project using test runner: Polylith built-in clojure.test runner...
Running tests from the command-line project, including 2 bricks and 1 project: user, cli, command-line <i class="conum" data-value="1"></i><b>(1)</b>

Testing se.example.cli.core-test

Ran 1 tests containing 1 assertions.
0 failures, 0 errors.

Test results: 1 passes, 0 failures, 0 errors.

Testing se.example.user.interface-test

Ran 1 tests containing 1 assertions.
0 failures, 0 errors.

Test results: 1 passes, 0 failures, 0 errors.

Testing project.command-line.dummy_test <i class="conum" data-value="2"></i><b>(2)</b>

Ran 1 tests containing 1 assertions.
0 failures, 0 errors.

Test results: 1 passes, 0 failures, 0 errors.

Execution time: 2 seconds

# Exit code: 0</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Notice <code>and 1 project</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Our <code>command-line</code> project tests are included!</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>They passed!</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test_approaches"><a class="link" href="#_test_approaches">Test approaches</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>As you have just seen, you can add tests at two levels: the brick and the project.</p>
</div>
<div class="paragraph">
<p>We recommend project tests for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Slower tests. Tests that take over 100 milliseconds (or whatever threshold you choose) are good candidates.</p>
</li>
<li>
<p>Tailor-made tests that are unique per project.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Brick tests are for faster tests.
Fast-running brick tests keep your feedback loop short during development.
Remember, <code>poly test</code> only runs brick tests, not project tests.</p>
</div>
<div class="paragraph">
<p>But does that mean we recommend only putting unit tests in your bricks?
No.
As long as the tests are fast (e.g., by using in-memory databases), you should put them in the bricks they belong to.</p>
</div>
<div class="paragraph">
<p>Before we continue, let&#8217;s commit the work we have done so far and mark our <code>example</code> workspace as <a href="#">stable</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">git add --all
git commit -m "Added tests"
git tag -f stable-lisa</code></pre>
</div>
</div>
<div class="paragraph">
<p>Rerun <code>poly <a href="#info">info</a></code>, you should see output like:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/output/info-added-tests.png" alt="info added tests" width="400">
</div>
</div>
<div class="paragraph">
<p>The <code>*</code> signs are gone, and no <code>x</code> flags means <code>poly</code> has marked nothing for testing.</p>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool only executes tests for a brick if it has directly or indirectly changed.
A way to force it to test all bricks is to pass in <code>:all-bricks</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info :all-bricks</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/info-all-bricks-annotated.png" alt="info all bricks annotated" width="400">
</div>
</div>
<div class="paragraph">
<p>Notice that <code>poly</code> has marked all the bricks for testing under deployable project <code>cl</code>.</p>
</div>
<div class="paragraph">
<p>To also run brick tests from the <code>development</code> project, specify <code>:dev</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info :all-bricks :dev</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/info-all-bricks-dev-annotated.png" alt="info all bricks dev annotated" width="400">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
This is for demonstration purposes only.
The <code>poly</code> tool has already marked all of your bricks for testing under the <code>command-line</code> (alias <code>cl</code>) project.
Retesting your bricks the <code>development</code> (alias <code>dev</code>) project is questionable.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To include all brick and project tests (except <code>development</code>) you can type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info :all</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/info-all-annotated.png" alt="info all annotated" width="400">
</div>
</div>
<div class="paragraph">
<p>To also include <code>development</code>, type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info :all :dev</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/testing/info-all-dev-annotated.png" alt="info all dev annotated" width="400">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Because projects and bricks were already marked for testing, adding <code>:dev</code> in this case is questionable.
You&#8217;ll typically use the <code>development</code> project to test new bricks you&#8217;ve not yet added to any deployable project.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now let&#8217;s see if it actually all works:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly test :all :dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">Projects to run tests from: command-line, development

Running tests for the command-line project using test runner: Polylith built-in clojure.test runner... <i class="conum" data-value="1"></i><b>(1)</b>
Running tests from the command-line project, including 2 bricks and 1 project: user, cli, command-line

Testing se.example.cli.core-test

Ran 1 tests containing 1 assertions.
0 failures, 0 errors.

Test results: 1 passes, 0 failures, 0 errors.

Testing se.example.user.interface-test

Ran 1 tests containing 1 assertions.
0 failures, 0 errors.

Test results: 1 passes, 0 failures, 0 errors.

Testing project.command-line.dummy_test

Ran 1 tests containing 1 assertions.
0 failures, 0 errors.

Test results: 1 passes, 0 failures, 0 errors.
Running tests for the development project using test runner: Polylith built-in clojure.test runner... <i class="conum" data-value="2"></i><b>(2)</b>
Running tests from the development project, including 2 bricks and 1 project: user, cli, command-line

Testing se.example.cli.core-test

Ran 1 tests containing 1 assertions.
0 failures, 0 errors.

Test results: 1 passes, 0 failures, 0 errors.

Testing se.example.user.interface-test

Ran 1 tests containing 1 assertions.
0 failures, 0 errors.

Test results: 1 passes, 0 failures, 0 errors.

Execution time: 1 seconds

# Exit code: 0</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Tests run from <code>command-line</code> project</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>And rerun from <code>development</code> project (notice absence of command-line project tests when run from <code>development</code>)</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Looks like it worked!</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="setup-and-teardown"><a class="link" href="#setup-and-teardown">Test Setup and Teardown</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes, tests require some setup before being run and some teardown (or cleanup) after being run.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>If multiple projects needed the same test setup/teardown, you&#8217;d put this support in a component to make it shareable.
We only have one project, so we&#8217;ll put the test setup/teardown in the <code>command-line</code> project.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s create a <code>test-setup</code> namespace in the <code>command-line</code> project&#8217;s test directory and add <code>setup</code> and <code>teardown</code> functions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example
 projects
    command-line
        test
            project
               command_line
                  test_setup.clj</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns project.command-line.test-setup
  (:require [clojure.test :refer :all]))

(defn setup [project-name]
  (println (str "--- test setup for " project-name " ---")))

(defn teardown [project-name]
  (println (str "--- test teardown for " project-name " ---")))</code></pre>
</div>
</div>
<div class="paragraph">
<p>You need to keep two things in mind:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Make sure your functions are accessible (in this case, from the <code>command-line</code> project)</p>
</li>
<li>
<p>Make sure the functions take exactly one argument, the project name</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Specify your new functions in <code>./workspace.edn</code> for the <code>command-line</code> project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure"> ...
 :projects {"development" {:alias "dev"}
            "command-line" {:alias "cl"
                            :test {:setup-fn project.command-line.test-setup/setup
                                   :teardown-fn project.command-line.test-setup/teardown}}}}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
In practice, if you don&#8217;t need a <code>:teardown-fn</code>, you can omit it.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Rerun your tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly test :all</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">Projects to run tests from: command-line

Running test setup for the command-line project: project.command-line.test-setup/test-setup
--- test setup for command-line --- <i class="conum" data-value="1"></i><b>(1)</b>

Running tests for the command-line project using test runner: Polylith built-in clojure.test runner...
Running tests from the command-line project, including 2 bricks and 1 project: user, cli, command-line

Testing se.example.cli.core-test

Ran 1 tests containing 1 assertions.
0 failures, 0 errors.

Test results: 1 passes, 0 failures, 0 errors.

Testing se.example.user.interface-test

Ran 1 tests containing 1 assertions.
0 failures, 0 errors.

Test results: 1 passes, 0 failures, 0 errors.

Testing project.command-line.test-setup

Ran 0 tests containing 0 assertions.
0 failures, 0 errors.

Test results: 0 passes, 0 failures, 0 errors.

Testing project.command-line.dummy_test

Ran 1 tests containing 1 assertions.
0 failures, 0 errors.

Test results: 1 passes, 0 failures, 0 errors.
Running test teardown for the command-line project: project.command-line.test-setup/test-teardown
--- test teardown for command-line --- <i class="conum" data-value="2"></i><b>(2)</b>


Execution time: 2 seconds

# Exit code: 0</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The setup</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The teardown</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Nice, it worked!</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="include-exclude"><a class="link" href="#include-exclude">Include and Exclude Bricks by Configuration</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>There is a way to restrict what tests to run for a project by giving a list of bricks to include and/or exclude in <code>workspace.edn</code>, e.g.:</p>
</div>
<div id="include-exclude" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{...
 :projects {"mytool" {:alias "t"
                      :test {:include []}}
            "myservice" {:alias "s"
                         :test {:exclude ["cli" "user"]}}
            ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>This configuration tells <code>poly</code> to include no brick tests for project <code>mytool</code> and exclude <code>cli</code> and <code>user</code> brick tests for project <code>myservice</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>:include</code> keyword is optional and assumed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You may wonder when this could be useful.
A good example is the polylith codebase itself, where the <code>workspace.edn</code> looks similar to this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">...
  :projects {"poly" {:alias "poly"} <i class="conum" data-value="1"></i><b>(1)</b>
             "polyx" {:alias "polyx" :test []} <i class="conum" data-value="2"></i><b>(2)</b>
             "development" {:alias "dev"} <i class="conum" data-value="3"></i><b>(3)</b>
             ...</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>all brick tests for deployable projects are included by default</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>all brick tests excluded via <code>:test []</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>no tests are included for the <code>development</code> project by default</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Our motivation is to speed up the test execution time.
We felt comfortable with this strategy because:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>poly</code> brick tests give full brick coverage</p>
</li>
<li>
<p><code>polyx</code> uses these bricks in the same way <code>poly</code> does</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
When you exclude a brick via configuration, <code>poly</code> will never include it for testing, even when you specify <code>:project</code> or <code>:all</code> arguments.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary"><a class="link" href="#_summary">Summary</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s summarise the different ways to run the tests.</p>
</div>
<div class="paragraph">
<p>By default, <code>poly test</code> runs tests for each deployable project&#8217;s bricks.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 23.8095%;">
<col style="width: 23.8095%;">
<col style="width: 23.8096%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Command</th>
<th class="tableblock halign-left valign-top">Brick tests? (once for each deployable project)</th>
<th class="tableblock halign-left valign-top">Deployable project tests?</th>
<th class="tableblock halign-left valign-top">Selection</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>poly test</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">only brick tests impacted by change</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>poly test :project</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">only brick and project tests impacted by change</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>poly test :allbricks</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">forces all brick tests</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>poly test :all</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">forces all brick and project tests</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>By specifying the <code>:dev</code> argument, you can also tell <code>poly</code> to include brick tests from the <code>development</code> project.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 23.8095%;">
<col style="width: 23.8095%;">
<col style="width: 23.8096%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Command</th>
<th class="tableblock halign-left valign-top">Brick tests? (once for each project including the <code>development</code> project)</th>
<th class="tableblock halign-left valign-top">Project tests? (including the <code>development</code> project <a href="#dev-project-tests"><sup>1</sup></a>)</th>
<th class="tableblock halign-left valign-top">Selection</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>poly test :dev</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">only brick tests impacted by change</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>poly test :project :dev</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">only brick and project tests impacted by change</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>poly test :allbricks :dev</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">forces all brick tests</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>poly test :all :dev</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">forces all brick and project tests</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table notes:</p>
</div>
<div id="dev-project-tests" class="olist arabic">
<ol class="arabic">
<li>
<p>The development project does not typically include any tests</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can explicitly <a href="#filter-projects">select projects</a> via e.g, <code>project:proj1</code> or <code>project:proj1:proj2</code>.</p>
</div>
<div class="paragraph">
<p>You can <a href="#filter-bricks">filter bricks</a> to run the tests for with e.g., <code>brick:b1</code> or <code>brick:b1:b2</code>.</p>
</div>
<div class="paragraph">
<p>Remember that the <a href="#info">info</a> command is an excellent way to get an overview of what tests <code>poly</code> will run.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_test_execution_works"><a class="link" href="#_how_test_execution_works">How Test Execution Works</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="from-the-repl"><a class="link" href="#from-the-repl">From the REPL</a></h3>
<div class="paragraph">
<p>The primary purpose of the <code>development</code> project is to allow you to work with all of your code from your IDE using a single REPL.
To meet that goal, you must set up your project in a way that is compatible with <a href="#">tool.deps</a> and your IDE integration.
One example of this compatibility setup is adding test paths explicitly in <code>./deps.edn</code> to give access to the tests from your REPL.</p>
</div>
<div class="paragraph">
<p>The <code>./deps.edn</code> config file sets up all your paths and dependencies.
The <code>:dev</code> and <code>:test</code> aliases (and sometimes <a href="#">profile</a> aliases) informs tools.deps what source code and libraries should be accessible from your IDE and REPL.
When you&#8217;ve set this up correctly, you can run your tests from your REPL, which will have access to all the <code>test</code> and <code>src</code> code.</p>
</div>
<div class="paragraph">
<p>Libraries you reference as default dependencies are automatically accessible when you run tests.
You should reference libraries you only need for testing under the <code>test</code> alias.</p>
</div>
</div>
<div class="sect2">
<h3 id="_from_poly"><a class="link" href="#_from_poly">From <code>poly</code></a></h3>
<div class="paragraph">
<p>When you run the <a href="#test">test</a> command, <code>poly</code> will detect which components, bases and projects have been affected since the last <a href="#">stable point in time</a>.
Based on this information, <code>poly</code> will:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for each affected project:</p>
<div class="ulist">
<ul>
<li>
<p>run tests for the affected bricks (components and bases) referenced by the project</p>
</li>
<li>
<p>run tests belonging to the project (if you&#8217;ve specified <code>:project</code> or <code>:all</code>)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool executes this set of tests in an isolated classloader, which speeds up the test execution and reflects the production classpath.
The <code>test</code> command includes libraries (and their transitive dependencies) from both default dependencies and <code>:test</code> aliases.
You can also run tests from the <code>development</code> project, but that&#8217;s not its <a href="#from-the-repl">primary purpose</a>.</p>
</div>
<div class="paragraph">
<p>Tests fail fast.
If you run tests on projects A, B, C, and D, when a test in project B fails, the whole test run stops at project B.
The <code>poly</code> tool won&#8217;t run tests for projects C and D.
Failing fast also applies to <a href="#setup-and-teardown">test setup and teardown</a>, should they fail for whatever reason.</p>
</div>
<div class="paragraph">
<p>The <code>poly test</code> command uses the sum of all library dependencies for components and bases, either indirectly via <code>:local/root</code> or directly via <code>:deps</code> and <code>:extra-deps</code>.
If a library is defined more than once in the set of bricks and projects, then the latest version of that library is used if not overridden by <code>:override-deps</code> in the project.</p>
</div>
<div class="paragraph">
<p>A project does not need to respecify libraries specified by its referenced bricks.
It will typically specify dependencies common to all bricks, e.g., <code>org.clojure/clojure</code>.</p>
</div>
<div class="paragraph">
<p>Sometimes, you&#8217;ll depend on libraries not hosted in the default Maven repositories.
You can specify custom maven repositories in a brick.
Everything that depends on the brick will pick up the custom Maven repositories.</p>
</div>
<div class="paragraph">
<p>For example, the <code>poly</code> tool&#8217;s <code>datomic-ions</code> brick <a href="https://github.com/polyfy/polylith/blob/edaef89207c2852010132e863ae87ebba5bedc5b/examples/local-dep/components/datomic-ions/deps.edn#L1">specifies a custom Maven repository for datomic libraries</a>.
You can verify that the brick picks up the maven repository by executing <code>poly ws get:components:datomic-ions:maven-repos</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{"datomic-cloud" {:url "s3://datomic-releases-1fc2183a/maven/releases"}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And that the <code>invoicing</code> project uses it by executing <code>poly ws get:projects:invoicing:maven-repos</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{"central" {:url "https://repo1.maven.org/maven2/"},
 "clojars" {:url "https://repo.clojars.org/"},
 "datomic-cloud" {:url "s3://datomic-releases-1fc2183a/maven/releases"}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Every project using the <code>datomic-ions</code> brick will inherit the <code>datomic-cloud</code> maven repository.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_troubleshooting"><a class="link" href="#_troubleshooting">Troubleshooting</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>If your tests don&#8217;t work for whatever reason, you can pass in <code>:verbose</code> to see the configuration and paths <code>poly</code> uses when executing the tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly test :verbose</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure"># config:
{:mvn/repos {"central" {:url "https://repo1.maven.org/maven2/"}, ...
# paths: <i class="conum" data-value="1"></i><b>(1)</b>
["bases/cli/resources" "bases/cli/src" "components/user-remote/resources" ...</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Represents the JVM classpath</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_long_lived_shell_sessions"><a class="link" href="#_long_lived_shell_sessions">Long-Lived Shell Sessions</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>For long-running <a href="#">shell</a> sessions, after running the <a href="#test">test</a> command many times, you may eventually get <code>classloader</code> errors.</p>
</div>
<div class="paragraph">
<p>Solutions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Quit, then restart the poly shell</p>
</li>
<li>
<p>Run tests outside of the shell, e.g, <code>poly test</code></p>
</li>
<li>
<p>Switch to an external <a href="#">test runner</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test_runners"><a class="link" href="#_test_runners">Test Runners</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_test_runners_2" class="sect0"><a class="link" href="#_test_runners_2">Test Runners</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>Starting with version <code>0.2.15</code>, the <code>poly</code> tool lets you choose your test runners.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Starting with version <code>0.2.19</code>, you need at least <code>0.8.4</code> of the Kaocha test runner, and <code>0.4.0</code> of the External test runner.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are two types of test runners: <a href="#in-process">in-process</a> and <a href="#external">external</a>.</p>
</div>
<div class="paragraph">
<p>Polylith comes bundled with an in-process <a href="https://github.com/polyfy/polylith/blob/9053b190d5f3b0680ac4fe5c5f1851f7c0d40830/components/clojure-test-test-runner/src/polylith/clj/core/clojure_test_test_runner/core.clj#L85-L99">test runner</a> that uses <a href="https://clojure.github.io/clojure/clojure.test-api.html">Clojure&#8217;s testing framework</a>.
This is the default test runner.</p>
</div>
<div class="paragraph">
<p>If you want to run tests with an external test runner, we recommend <a href="#sean-external-test-runner">Sean Corfield&#8217;s external test runner</a>.</p>
</div>
<div class="paragraph">
<p>You can also <a href="#write-your-own">write your own custom test runner</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="in-process"><a class="link" href="#in-process">In-Process Test Runner</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>As you have learned, the <code>poly</code> tool can run your tests incrementally.
It creates an isolated classloader for each project and runs your tests within that classloader.
An in-process runner avoids process startup time costs.
It runs all tests in the same process.</p>
</div>
<div class="paragraph">
<p>For in-process test runners, the <code>poly</code> tool determines which bricks and projects are affected, calculates the classpath for each project, creates an isolated classloader, and passes it to the test runner for execution.</p>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool, by default, uses an in-process test-runner.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="external"><a class="link" href="#external">External Test Runner</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The alternative to the in-process isolated classloader approach is to execute each project&#8217;s tests in a separate external Java subprocess.
The advantage of this approach is that you have complete control of the test execution, and memory is released after each project when the subprocess terminates.
Use an external test runner if you have issues with the in-process test-runner.</p>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool will still determine the changed bricks and projects and calculate the classpath for each project.
However, the external test runner will launch a subprocess to run the tests.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The <code>poly</code> tool will not run the <a href="#setup-and-teardown">test setup and teardown</a> functions for external test runners.
The external test runner must run these functions within the external process it creates.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_in_process_vs_external_test_runner"><a class="link" href="#_in_process_vs_external_test_runner">In-process vs. External Test Runner</a></h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">What</th>
<th class="tableblock halign-left valign-top">In-Proces Test Runner</th>
<th class="tableblock halign-left valign-top">External Test Runner</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Context</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Isolated to project</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Isolated to project</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Approach</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Isolated in-process classloaders</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Isolated Java subprocesses</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Speed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fast</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process startup overhead per project</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Memory usage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Memory is released when the whole test run has finished</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Memory is released after each project test run</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Setup &amp; Teardown</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Handled by the <code>poly</code> tool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Handled by the test runner</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Special arguments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>class-loader</code>, <code>eval-in-project</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>process-ns</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional functions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>N/A</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>external-process-namespace</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_use_a_custom_test_runner"><a class="link" href="#_use_a_custom_test_runner">Use a Custom Test Runner</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use a custom test runner, add it to your <code>poly</code> tool classpath.
An ideal place to do this is the <code>:poly</code> alias in your <code>./deps.edn</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:aliases
 {:poly
  {:extra-deps
   {polylith/clj-poly
    {:mvn/version "0.2.18"}

    io.github.seancorfield/polylith-external-test-runner <i class="conum" data-value="1"></i><b>(1)</b>
    {:git/tag "v0.4.0" :git/sha "eb954fe"
     :deps/root "projects/runner"}

    io.github.imrekoszo/polylith-kaocha <i class="conum" data-value="2"></i><b>(2)</b>
    {:git/tag "v0.8.4" :git/sha "f096de8"}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We&#8217;ve added <a href="#sean-external-test-runner">Sean Corfield&#8217;s external test runner</a>, as one example</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>And <a href="#imre-kaocha-test-runner">Imre Imre Ksz&#8217;s Kaocha test runner</a> as another example. Don&#8217;t forget to configure the kaocha-wrapper at the project level, see the documentation or <a href="https://github.com/polyfy/polylith/tree/master/examples/test-runners">this</a> example project.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can also have your custom test runner within the same Polylith workspace and depend on it via <code>:local/root</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once you have your test runner on the classpath, add it to our workspace configuration so that the <code>poly</code> tool can use it instead of the default test runner.</p>
</div>
<div class="paragraph">
<p>You can override the default global test runner under the <code>:test</code> key in your <code>workspace.edn</code>. Here are three examples:</p>
</div>
<div id="create-test-runner" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{...
 ; Global test configuration, used as default for every project.
 :test {:create-test-runner [org.corfield.external-test-runner.interface/create]} <i class="conum" data-value="1"></i><b>(1)</b>

 ; Project specific configurations
 :projects {"foo" {:alias "foo"}
            "bar" {:alias "barr"}
            "baz" {:alias "baz"}}}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Override default global test runner</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can specify multiple test runners.
The <code>poly</code> tool will run each test runner for each tested project.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can override the global test runner for a project.
Add a <code>:test</code> key in the project&#8217;s configuration in your <code>workspace.edn</code> to select project-specific test runners:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{...
 ; Global test configuration, used as default for every project.
 :test {:create-test-runner [org.corfield.external-test-runner.interface/create]}

 ; Project specific configurations
 :projects {"foo" {:alias "foo"
                   ; Use another test runner only for this project
                   :test  {:create-test-runner [polylith-kaocha.test-runner/create]}}

            "bar" {:alias "bar"
                   ; Use the poly default test runner instead of the global test-runner
                   :test  {:create-test-runner [:default]}}

            "baz" {:alias "bz"
                   ; Use both the poly default and the example test runner for this project
                   :test {:create-test-runner [:default
                                               org.corfield.external-test-runner.interface/create]}}}}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="write-your-own"><a class="link" href="#write-your-own">Implement Your Own Custom Test Runner</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Polylith supports writing test runners with two protocols: <code>TestRunner</code> and <code>ExternalTestRunner</code>.
You can use these protocols to easily plugin custom test runner(s) into the <code>poly</code> tool.</p>
</div>
<div class="paragraph">
<p>See our relevant API docs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://cljdoc.org/d/polylith/clj-poly/CURRENT/api/polylith.clj.core.test-runner-contract.interface#TestRunner">TestRunner</a></p>
</li>
<li>
<p><a href="https://cljdoc.org/d/polylith/clj-poly/CURRENT/api/polylith.clj.core.test-runner-contract.interface#ExternalTestRunner">ExternalTestRunner</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To implement your custom test runner, create a single-arity constructor function that reifies the <code>TestRunner</code> protocol.
Optionally, reify the <code>ExternalTestRunner</code> protocol to make an external test runner.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns se.example.example-test-runner)

...

(defn create [{:keys [workspace project test-settings is-verbose color-mode changes]}]
  ...

  (reify
    test-runner-contract/TestRunner
    (test-runner-name [this] ...)

    (test-sources-present? [this] ...)

    (tests-present? [this runner-opts] ...)

    (run-tests [this runner-opts] ...)

    ; Optional, only if you want an external test runner
    test-runner-contract/ExternalTestRunner
    (external-process-namespace [this] ...)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool will call your constructor function to get an instance of your test runner for each project test run.
The constructor function will receive a map as the single argument:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:workspace</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The workspace map.
This map contains <code>:user-input</code>, which you can use to specify additional arguments for runtime configuration.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:project</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A map containing details for the project that <code>poly</code> is currently testing.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:test-settings</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test settings for the project that <code>poly</code> is currently testing.
The <code>poly</code> tool extracts this information from <code>workspace.edn</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:is-verbose</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>When <code>true</code> the <code>poly</code> tool is running tests in verbose mode.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:color-mode</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The color mode under which the <code>poly</code> tool is currently running.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:changes</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A map of changes since the last stable point in time.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="test-configuration"><a class="link" href="#test-configuration">Test configuration</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you create your own test runner or use one from the community, it can be useful to add snippets of test configuration when running the <a href="#test">test</a> command.</p>
</div>
<div class="paragraph">
<p>The test snippets can be configured in workspace.edn under <code>:test-configs</code> (see the <a href="https://github.com/polyfy/polylith/blob/master/examples/test-runners/workspace.edn">test-runners</a> example):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{
 ...

 :test {:create-test-runner org.corfield.external-test-runner.interface/create}

 :test-configs {:default-test-runner  {:create-test-runner [:default]}
                :external-test-runner {:create-test-runner [org.corfield.external-test-runner.interface/create]}
                :kaocha-test-runner   {:create-test-runner [polylith-kaocha.test-runner/create]}
                :exclude-dummy        {:org.corfield/external-test-runner {:focus {:exclude [:dummy]}}}
                :exclude-integration  {:org.corfield/external-test-runner {:focus {:exclude [:integration]}}}}}
...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we run the test command, e.g. <code>poly test</code>, then the test configuration specified by the <code>:test</code> key will be passed to the test runner(s). Let&#8217;s start a shell and verify this, from the <a href="https://github.com/polyfy/polylith/tree/master/examples/test-runners">examples/test-runners</a> directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can check the content of the <code>:test</code> key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">test-runners$ ws get:settings:test</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:create-test-runner org.corfield.external-test-runner.interface/create}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Yes, it looked the same. Let&#8217;s use the default test runner:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">test-runners$ ws get:settings:test with:default-test-runner</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:create-test-runner [:default]}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The old <code>org.corfield.external-test-runner.interface/create</code> value was replaced by <code>[:default]</code>.</p>
</div>
<div class="paragraph">
<p>If the old value instead was set to <code>[org.corfield.external-test-runner.interface/create]</code> then the two vectors would instead been merged into <code>[org.corfield.external-test-runner.interface/create :defalt]</code>.</p>
</div>
<div class="paragraph">
<p>Both <code>default-test-runner</code> and <code>kaocha-test-runner</code> store their values in a vector, and if we select both, the result will be merged:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">test-runners$ ws get:settings:test with:default-test-runner:kaocha-test-runner</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:create-test-runner [:default polylith-kaocha.test-runner/create]}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is another example, where <code>:integration</code> and <code>:dummy</code> are concatenated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">test-runners$ ws get:settings:test with:exclude-integration:exclude-dummy</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:create-test-runner org.corfield.external-test-runner.interface/create,
 :org.corfield/external-test-runner {:focus {:exclude [:integration :dummy]}}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now when we understand how test configuration can be added, we can run the test command using the default test runner:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">test-runners$ test with:default-test-runner</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test_runners_from_the_community"><a class="link" href="#_test_runners_from_the_community">Test Runners from the Community</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default test runner works fine in most cases and is simple and fast.
Sometimes, using the same classloader for all your tests in the workspace doesn&#8217;t give enough isolation.
In this case, the External Test Runner is a good choice.
If you switch to the Kaocha Test Runner, you will get more options for running your tests.</p>
</div>
<div class="sect2">
<h3 id="imre-kaocha-test-runner"><a class="link" href="#imre-kaocha-test-runner">Kaocha Test Runner</a></h3>
<div class="paragraph">
<p>A simple <a href="https://github.com/lambdaisland/kaocha/">Kaocha</a>-based test runner implementation for the <code>poly</code> tool.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Type
</td>
<td class="hdlist2">
<p>in-process</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Repository
</td>
<td class="hdlist2">
<p><a href="https://github.com/imrekoszo/polylith-kaocha">imrekoszo/polylith-kaocha</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
Author
</td>
<td class="hdlist2">
<p><a href="https://github.com/imrekoszo">@imrekoszo</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
License
</td>
<td class="hdlist2">
<p>MIT</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sean-external-test-runner"><a class="link" href="#sean-external-test-runner">External Test Runner</a></h3>
<div class="paragraph">
<p>An external (subprocess) test runner for Polylith.
Avoids classloader, daemon thread, and memory usage issues by running tests in a subprocess with only Clojure itself as a dependency.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Type
</td>
<td class="hdlist2">
<p>external</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Repository
</td>
<td class="hdlist2">
<p><a href="https://github.com/seancorfield/polylith-external-test-runner">seancorfield/polylith-external-test-runner</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
Author
</td>
<td class="hdlist2">
<p><a href="https://github.com/seancorfield">@seancorfield</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
License
</td>
<td class="hdlist2">
<p>Apache-2.0</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_profile"><a class="link" href="#_profile">Profile</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_profile_2" class="sect0"><a class="link" href="#_profile_2">Profile</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>In production, your deployable <a href="#">projects</a>, by their nature, run in separate processes.
In development, you are running from a single REPL process, which can lead to classpath issues you will never encounter in production.
Profiles allow you to work on all your projects from the <code>development</code> project without classpath issues.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You likely don&#8217;t need profiles if your <a href="#">workspace</a> does not <a href="#one-interface-in-multiple-components">re-specify one interface</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_an_example_scenario"><a class="link" href="#_an_example_scenario">An Example Scenario</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>In our ongoing <a href="#">tutorial</a>, we last left off exploring <a href="#">testing</a>.
If you&#8217;ve been following along, your <code>development</code> project currently mirrors the <code>command-line</code> project:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/profile/prod-mirrors-dev.png" alt="prod mirrors dev">
</div>
</div>
<div class="paragraph">
<p>The <code>cli</code> <a href="#">base</a> references the <code>user</code> <a href="#">component</a> in both <a href="#">projects</a>.
Let&#8217;s pretend that we have discovered performance problems in the <code>user</code> component and have learned that distributing the load by delegating to a new service should solve the problem:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/profile/new-service-in-prod.png" alt="new service in prod">
</div>
</div>
<div class="paragraph">
<p>The <code>cli</code> base now references a new <code>user-remote</code> component, which calls a new <code>user-api</code> base in a new <code>user-service</code> project, which references our original <code>user</code> component.</p>
</div>
<div class="paragraph">
<p>The production environment looks good, but how about the <code>development</code> environment?
We have a problem.
The <code>user</code> and <code>user-remote</code> components both specify the <code>user</code> <a href="#one-interface-in-multiple-components">interface</a>, resulting in two <code>se.example.user.interface</code> namespaces on the classpath.
Duplicate items on the classpath will confuse classloaders and IDEs.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Classloader issues are only a <code>development</code> project concern.
We don&#8217;t have classloader issues:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in production because <code>command-line</code> and <code>user-service</code> projects naturally run in separate processes.</p>
</li>
<li>
<p>when <a href="#">testing</a> via <code>poly</code> because <a href="#">test-runners</a> provide classpath isolation at the project level.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_profiles_to_the_rescue"><a class="link" href="#_profiles_to_the_rescue">Profiles to the Rescue</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>poly</code> solution is to use profiles:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/profile/profiles-in-dev.png" alt="profiles in dev">
</div>
</div>
<div class="paragraph">
<p>We can add <code>default</code> and <code>remote</code> profiles to avoid duplication on the classpath, allowing us to develop all our code and projects from a single place without issues.</p>
</div>
<div class="paragraph">
<p>If no other profiles are selected, <code>poly</code> automatically merges the <code>default</code> profile into the <code>development</code> project.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>The name <code>default</code> is specified by <code>:default-profile-name</code> in <a href="#workspace-edn">workspace.edn</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_planning_a_solution"><a class="link" href="#_planning_a_solution">Planning a Solution</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s move from our current design:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/profile/prod-mirrors-dev.png" alt="prod mirrors dev">
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;to our new one:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/profile/target-design.png" alt="target design">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation"><a class="link" href="#_implementation">Implementation</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s continue with our <a href="#">tutorial</a> <code>example</code> workspace; we last left off exploring <a href="#">testing</a>.</p>
</div>
<div class="paragraph">
<p>First, we need some mechanism for the <code>command-line</code> tool to communicate over the wire with the <code>user-service</code>.
After some searching, we found the <a href="https://github.com/sunng87/slacker">slacker</a> library.
It supports simple <a href="https://en.wikipedia.org/wiki/Remote_procedure_call">remote procedure calls</a>.
Perfect for our tutorial.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s a checklist to implement our design:</p>
</div>
<div class="paragraph">
<p><a href="#create-user-api-base">1. Create the <code>user-api</code> base</a><br>
<a href="#create-user-remote-component">2. Create the <code>user-remote</code> component</a><br>
<a href="#adjust-command-line-project">3. Switch from <code>user</code> to <code>user-remote</code> in the <code>command-line</code> project</a><br>
<a href="#create-user-service-project">4. Create the <code>user-service</code> project</a><br>
<a href="#build-user-service">5. Build the <code>user-service</code></a></p>
</div>
<div class="sect2">
<h3 id="create-user-api-base"><a class="link" href="#create-user-api-base">1. Create the <code>user-api</code> base</a></h3>
<div class="paragraph">
<p><a href="#create-user-api-base2">a. Create the <code>user-api</code> base</a><br>
<a href="#add-slacker-library-to-user-api">b. Add the <code>slacker</code> library to the <code>user-api</code> base</a> <br>
<a href="#add-user-api-to-dev-deps">c. Add  <code>user-api</code> base to <code>./deps.edn</code>:</a><br>
<a href="#implement-user-api">d. Implement the server for the <code>user-api</code> base</a><br></p>
</div>
<div class="sect3">
<h4 id="create-user-api-base2"><a class="link" href="#create-user-api-base2">a. Create the <code>user-api</code> base</a></h4>
<div class="paragraph">
<p>Run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">poly create base name:user-api</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="add-slacker-library-to-user-api"><a class="link" href="#add-slacker-library-to-user-api">b. Add the <code>slacker</code> library to the <code>user-api</code> base</a></h4>
<div class="paragraph">
<p>Edit <code>user-api</code> base <code>deps.edn</code>:</p>
</div>
<div class="listingblock">
<div class="title">./bases/user-api/deps.edn</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:paths ["src" "resources"]
 :deps {slacker/slacker {:mvn/version "0.17.0"}} <i class="conum" data-value="1"></i><b>(1)</b>
 :aliases {:test {:extra-paths ["test"]
                  :extra-deps {}}}}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add <code>slacker</code> library dependency for server-side communication support</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="add-user-api-to-dev-deps"><a class="link" href="#add-user-api-to-dev-deps">c. Add  <code>user-api</code> base to <code>./deps.edn</code>:</a></h4>
<div class="paragraph">
<p>Adjust <code>./deps.edn</code> like so:</p>
</div>
<div class="listingblock">
<div class="title">./deps.edn</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure"> :aliases  {:dev {:extra-deps [...
                               poly/user-api {:local/root "bases/user-api"} <i class="conum" data-value="1"></i><b>(1)</b>
                               ...]

            :test {:extra-paths [...
                                 "bases/user-api/test" <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add <code>user-api</code> source dep under <code>:dev</code> alias</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add <code>user-api</code> test path under <code>:test</code> alias</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="implement-user-api"><a class="link" href="#implement-user-api">d. Implement the server for the <code>user-api</code> base</a></h4>
<div class="paragraph">
<p>Create the <code>api</code> namespace in the <code>user-api</code> base:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example
 bases
    user-api
        src
            se.example.user_api.api.clj <i class="conum" data-value="1"></i><b>(1)</b>
            se.example.user_api.core.clj</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create the new <code>api.clj</code> file</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Set the content of <code>api.clj</code> to:</p>
</div>
<div class="listingblock">
<div class="title">./bases/user-api/src/se/example/user_api/api.clj</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns se.example.user-api.api
  (:require [se.example.user.interface :as user]))

(defn hello-remote [name]
  (user/hello (str name " - from the server")))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Update <code>core.clj</code> to:</p>
</div>
<div class="listingblock">
<div class="title">./bases/user-api/src/se/example/user_api/core.clj</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns se.example.user-api.core
  (:require [se.example.user-api.api]
            [slacker.server :as server])
  (:gen-class))

(defn -main [&amp; args]
  (server/start-slacker-server [(the-ns 'se.example.user-api.api)] 2104)
  (println "server started: http://127.0.0.1:2104"))</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create-user-remote-component"><a class="link" href="#create-user-remote-component">2. Create the <code>user-remote</code> component</a></h3>
<div class="paragraph">
<p><a href="#create-user-remote-component2">a. Create the <code>user-remote</code> component</a><br>
<a href="#add-slacker-library-to-user-remote">b. Add the <code>slacker</code> library to <code>user-remote</code> component</a><br>
<a href="#remove-user-from-dev-deps">c. Remove the <code>user</code> component from <code>./deps.edn</code>:</a><br>
<a href="#add-profiles-to-dev-deps">d. Add the <code>default</code> and <code>remote</code> profiles to <code>./deps.edn</code>:</a><br>
<a href="#activate-remote-profile-in-ide">e. Activate the <code>remote</code> profile in your IDE</a><br>
<a href="#implement-user-remote">f. Implement <code>user-remote</code></a><br>
<a href="#activate-default-profile">g. Activate the <code>default</code> profile in your IDE</a></p>
</div>
<div class="sect3">
<h4 id="create-user-remote-component2"><a class="link" href="#create-user-remote-component2">a. Create the <code>user-remote</code> component</a></h4>
<div class="paragraph">
<p>Run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly create component name:user-remote interface:user</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="add-slacker-library-to-user-remote"><a class="link" href="#add-slacker-library-to-user-remote">b. Add the <code>slacker</code> library to <code>user-remote</code> component</a></h4>
<div class="paragraph">
<p>Edit <code>user-remote</code> component <code>deps.edn</code>:</p>
</div>
<div class="listingblock">
<div class="title">./components/user-remote/deps.edn</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:paths ["src" "resources"]
 :deps {slacker/slacker {:mvn/version "0.17.0"}} <i class="conum" data-value="1"></i><b>(1)</b>
 :aliases {:test {:extra-paths ["test"]
                  :extra-deps {}}}}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add <code>slacker</code> lib dependency for client-side communication support</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="remove-user-from-dev-deps"><a class="link" href="#remove-user-from-dev-deps">c. Remove the <code>user</code> component from <code>./deps.edn</code>:</a></h4>
<div class="listingblock">
<div class="title">./deps.edn</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:aliases  {:dev {...
                  :extra-deps {poly/user {:local/root "components/user"} <i class="conum" data-value="1"></i><b>(1)</b>
                               poly/cli  {:local/root "bases/cli"}
                               poly/user-api {:local/root "bases/user-api"}

                               org.clojure/clojure {:mvn/version "1.11.1"}}}

            :test {:extra-paths ["components/user/test" <i class="conum" data-value="2"></i><b>(2)</b>
                                 "bases/cli/test"
                                 "projects/command-line/test"
                                 "bases/user-api/test"]}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Delete <code>poly/user {:local/root "components/user"}</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Delete <code>"components/user/test"</code></td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="add-profiles-to-dev-deps"><a class="link" href="#add-profiles-to-dev-deps">d. Add the <code>default</code> and <code>remote</code> profiles to <code>./deps.edn</code>:</a></h4>
<div class="listingblock">
<div class="title">./deps.edn</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">:aliases  {...

           :+default {:extra-deps {poly/user {:local/root "components/user"}} <i class="conum" data-value="1"></i><b>(1)</b>
                      :extra-paths ["components/user/test"]}

           :+remote {:extra-deps {poly/user-remote {:local/root "components/user-remote"}} <i class="conum" data-value="2"></i><b>(2)</b>
                     :extra-paths ["components/user-remote/test"]}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Respecify your deleted <code>user</code> component under the <code>default</code> profile alias</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Specify your new <code>user-remote</code> component under the <code>remote</code> profile alias</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Notice that profile aliases are prefixed with a <code>+</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="activate-remote-profile-in-ide"><a class="link" href="#activate-remote-profile-in-ide">e. Activate the <code>remote</code> profile in your IDE</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
At the time of this writing, we only have instructions for Cursive.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Cursive users</strong>: Activate the <code>remote</code> profile in your IDE:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/profile/activate-remote-profile.png" alt="activate remote profile" width="200">
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="implement-user-remote"><a class="link" href="#implement-user-remote">f. Implement <code>user-remote</code></a></h4>
<div class="paragraph">
<p>Create the <code>core</code> namespace in the <code>user-remote</code> component:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example
 components
    user-remote
        src
            se.example.user.core.clj <i class="conum" data-value="1"></i><b>(1)</b>
            se.example.user.interface.clj</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create new <code>core.clj</code> file</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Set <code>core.clj</code> content to:</p>
</div>
<div class="listingblock">
<div class="title">./components/user-remote/src/se/example/user/core.clj</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns se.example.user.core
  (:require [slacker.client :as client]))

(declare hello-remote)

(defn hello [name]
  (let [connection (client/slackerc "localhost:2104")
        _ (client/defn-remote connection se.example.user-api.api/hello-remote)]
    (hello-remote name)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>And update the <code>interface.clj</code> content to:</p>
</div>
<div class="listingblock">
<div class="title">./components/user-remote/src/se/example/user/interface.clj</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns se.example.user.interface
  (:require [se.example.user.core :as core]))

(defn hello [name]
  (core/hello name))</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="activate-default-profile"><a class="link" href="#activate-default-profile">g. Activate the <code>default</code> profile in your IDE</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
At the time of this writing, we only have instructions for Cursive users.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Cursive users</strong>: Edit the REPL configuration:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/profile/edit-repl-config.png" alt="edit repl config" width="250">
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;and add the <code>default</code> profile to Options: <code>-A:dev:test:build:+default</code></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>We had you add <code>-A:dev:test</code> <a href="#idea-cursive">during initial setup</a>.
Alternatively, you could have initially added <code class="nowrap">-A:dev:test:build:+default</code>.
Tools.deps ignores unused aliases.
The extra alias, while unused (until now), would have been harmless.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>We now need to include the <code>+default</code> alias because we moved the <code>user</code> component from a default <a href="#">tools.deps</a> dependency to a <code>default</code> polylith dependency.</p>
</div>
<div class="paragraph">
<p>We have segregated the two components that specify a <code>user</code> interface via profiles.
You might wonder why we chose the <code>user</code> component to be in the <code>default</code> profile and <code>user-remote</code> in the <code>remote</code> profile.
Our rationale is that we wanted something simple by default.
The <code>user</code> component only communicates in-process, whereas the <code>user-remote</code> component communicates out-of-process over-the-wire.</p>
</div>
<div class="paragraph">
<p>For the changes to take effect, you need to restart the REPL.
Normally, a REPL restart is not required, but when adding profiles, it&#8217;s necessary.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adjust-command-line-project"><a class="link" href="#adjust-command-line-project">3. Switch from <code>user</code> to <code>user-remote</code> in the <code>command-line</code> project</a></h3>
<div class="paragraph">
<p><a href="#replace-user-with-user-remote-in-command-line">a. Replace <code>user</code> with <code>user-remote</code> in <code>command-line</code> project</a><br>
<a href="#create-command-line-uberjar">b. Create <code>command-line</code> uberjar</a></p>
</div>
<div class="sect3">
<h4 id="replace-user-with-user-remote-in-command-line"><a class="link" href="#replace-user-with-user-remote-in-command-line">a. Replace <code>user</code> with <code>user-remote</code> in <code>command-line</code> project</a></h4>
<div class="paragraph">
<p>Make the following changes to the <code>command-line</code> project <code>deps.edn</code>:</p>
</div>
<div class="listingblock">
<div class="title">./projects/command-line/deps.edn</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:deps {poly/user {:local/root "../../components/user-remote"} <i class="conum" data-value="1"></i><b>(1)</b>
        poly/cli  {:local/root "../../bases/cli"}

        org.clojure/clojure {:mvn/version "1.11.1"}
        org.slf4j/slf4j-nop {:mvn/version "2.0.9"}} <i class="conum" data-value="2"></i><b>(2)</b>

 :aliases {:test {:extra-paths ["test"]
                  :extra-deps  {}}

           :uberjar {:main se.example.cli.core}}}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Rename <code>components/user</code> to <code>components/user-remote</code>.
It&#8217;s okay to leave <code>poly/user</code> as is; it&#8217;s unique within the project.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add logging library (slacker lib does some logging that we&#8217;ll ignore)</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="create-command-line-uberjar"><a class="link" href="#create-command-line-uberjar">b. Create <code>command-line</code> uberjar</a></h4>
<div class="paragraph">
<p>Run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">clojure -A:deps -T:build uberjar :project command-line</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create-user-service-project"><a class="link" href="#create-user-service-project">4. Create the <code>user-service</code> project</a></h3>
<div class="paragraph">
<p><a href="#create-user-service-project2">a. Create the <code>user-service</code> project:</a><br>
<a href="#configure-user-service">b. Configure the <code>user-service</code></a><br>
<a href="#add-user-service-project-alias">c. Add a <code>poly</code> alias for the <code>user-service</code></a></p>
</div>
<div class="sect3">
<h4 id="create-user-service-project2"><a class="link" href="#create-user-service-project2">a. Create the <code>user-service</code> project:</a></h4>
<div class="paragraph">
<p>Run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly create project name:user-service</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configure-user-service"><a class="link" href="#configure-user-service">b. Configure the <code>user-service</code></a></h4>
<div class="paragraph">
<p>Set the <code>user-service</code> project <code>deps.edn</code> content to:</p>
</div>
<div class="listingblock">
<div class="title">./projects/user-service/deps.edn</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:deps {poly/user {:local/root "../../components/user"} <i class="conum" data-value="1"></i><b>(1)</b>
        poly/user-api {:local/root "../../bases/user-api"} <i class="conum" data-value="2"></i><b>(2)</b>

        org.clojure/clojure {:mvn/version "1.11.1"}
        org.slf4j/slf4j-nop {:mvn/version "2.0.9"}} <i class="conum" data-value="3"></i><b>(3)</b>

 :aliases {:test {:extra-paths []
                  :extra-deps  {}}

           :uberjar {:main se.example.user-api.core}}} <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add <code>user</code> component</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add <code>user-api</code> base</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Add logging library (slacker lib does some logging that we&#8217;ll ignore)</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Specify main for uberjar artifact</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="add-user-service-project-alias"><a class="link" href="#add-user-service-project-alias">c. Add a <code>poly</code> alias for the <code>user-service</code></a></h4>
<div class="listingblock">
<div class="title">./workspace.edn</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure"> :projects {"development" {:alias "dev"}
            "command-line" {:alias "cl"}
            "user-service" {:alias "user-s"}}} <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add <code>user-s</code> alias for your new <code>user-service</code></td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="build-user-service"><a class="link" href="#build-user-service">5. Build the <code>user-service</code></a></h3>
<div class="paragraph">
<p>Create an uberjar for the <code>user-service</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">clojure -A:deps -T:build uberjar :project user-service</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_verifying_our_work"><a class="link" href="#_verifying_our_work">Verifying our Work</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Phew, that should be it!
Now, let&#8217;s test if it works.</p>
</div>
<div class="paragraph">
<p>From a separate terminal, launch the <code>user-service</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">cd projects/user-service/target
java -jar user-service.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see the following output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">server started: http://127.0.0.1:2104</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Cursive users:</strong>
Now that you have a running service, you can test if you can call it from the REPL.
You activated the remote profile in your IDE earlier, which made the <code>user-remote</code> component active.</p>
</div>
<div class="paragraph">
<p>Note that this only instructs the IDE to treat <code>user-remote</code> as source code:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/profile/user-and-user-remote.png" alt="user and user remote" width="200">
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;but it <strong>doesn&#8217;t</strong> automatically load its source code into the REPL!</p>
</div>
<div class="paragraph">
<p>You can verify this by adding this code to <code>development/src/dev/lisa.clj</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">(ns dev.lisa
  (:require [se.example.user.interface :as user]))

(user/hello "Lisa")</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;and if you execute the <code>hello</code> function, you will see that the loaded <code>user</code> component is called (not the <code>user-remote</code> component):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">"Hello Lisa!!"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Remember, <a href="#activate-default-profile">you set your REPL configuration</a> to include the <code>default</code> profile.
Because <a href="#add-profiles-to-dev-deps">you configured</a> the <code>user</code> component to be in the <code>default</code> profile, it will get loaded every time you start or restart your REPL.
As mentioned earlier, we typically recommend placing your simpler component in the <code>default</code> profile.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s create a REPL configuration that includes the remote profile:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/profile/prod-repl.png" alt="prod repl" width="600">
</div>
</div>
<div class="paragraph">
<p>This REPL will use the <code>user-remote</code> component and can be used to emulate a production-like environment.</p>
</div>
<div class="paragraph">
<p>But let&#8217;s continue with the REPL that is already running and see if we can switch to <code>user-remote</code> without restarting the REPL.</p>
</div>
<div class="paragraph">
<p>Open the <code>core</code> namespace of the <code>user-remote</code> component and select <code>Tools &gt; REPL &gt; Load file in REPL</code>.
You have just replaced the <code>user</code> component implementation with <code>user-remote</code>, which works because both share the same <code>se.example.user.core</code> and <code>se.example.user.interface</code> namespaces.</p>
</div>
<div class="paragraph">
<p>If you execute the <code>hello</code> function again from <code>dev.lisa</code>, you should see:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">Hello Lisa - from the server!!</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now, let&#8217;s continue with our example.
From another terminal (not the one from which you started the <code>user-service</code>) from your <code>example</code> workspace root dir:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">cd projects/command-line/target
java -jar command-line.jar Lisa</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">Hello Lisa - from the server!!</code></pre>
</div>
</div>
<div class="paragraph">
<p>If your output matches, congratulations, you&#8217;ve successfully exercised <code>poly</code> profiles!</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can find the complete tutorial code <a href="/examples/doc-example">here</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now execute the <a href="#info">info</a> command (<code>+</code> deactivates all profiles, and makes the <code>default</code> profile visible):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">cd ../../.. <i class="conum" data-value="1"></i><b>(1)</b>
poly info +</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Navigate back to the workspace root dir</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>&#8230;&#8203;and compare the <code>info</code> output with our target design:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/profile/compare-with-target-design-annotated.png" alt="compare with target design annotated">
</div>
</div>
<div class="paragraph">
<p>Great! Reality now matches our plan!</p>
</div>
<div class="paragraph">
<p>Notice that profile flags only include the <code>st</code> <a href="#">flags</a> and never the <code>x</code> flag.
Whether or not to run tests is not tied to profiles.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This example was quite simple, but if your project is more complicated, you may want to manage state during development with a tool like <a href="https://github.com/tolitius/mount">Mount</a>, <a href="https://github.com/stuartsierra/component">Component</a>, or <a href="https://github.com/weavejester/integrant">Integrant</a>.
You could also create your own helper functions in your development project namespace (<code>dev.lisa</code>, in our <a href="#">tutorial</a>) to help you switch profiles with a library like <a href="https://github.com/clojure/tools.namespace">tools.namespace</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exploring_with_poly_info"><a class="link" href="#_exploring_with_poly_info">Exploring with <code>poly info</code></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, the <code>default</code> profile is active:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">poly info</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/profile/info-after-adding-profiles-annotated.png" alt="info after adding profiles annotated" width="500">
</div>
</div>
<div class="paragraph">
<p>Notice:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>default</code> is listed for <code>active profiles</code></p>
</li>
<li>
<p>the <code>dev</code> project column:</p>
<div class="ulist">
<ul>
<li>
<p>includes the <code>user</code> brick (which is in the <code>default</code> profile)</p>
</li>
<li>
<p><strong>doesn&#8217;t</strong> include the <code>user-remote</code> brick (which is in the <code>remote</code> profile)</p>
</li>
</ul>
</div>
</li>
<li>
<p>columns for the inactive <code>remote</code> profile are shown</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Profiles can also contain dependencies and paths to projects, but we&#8217;ve done no such thing in our example; therefore, you&#8217;ll see all profile flags as <code>--</code> in the project section.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can override the default profile by specifying a profile:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">poly info +remote</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/profile/info-with-remote-profile-annotated.png" alt="info with remote profile annotated" width="500">
</div>
</div>
<div class="paragraph">
<p>Notice:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>remote</code> is listed for <code>active profiles</code></p>
</li>
<li>
<p>that the <code>dev</code> project column:</p>
<div class="ulist">
<ul>
<li>
<p><strong>doesn&#8217;t</strong> include the <code>user</code> brick (which is in the <code>default</code> profile)</p>
</li>
<li>
<p>includes the <code>user-remote</code> brick (which is in the <code>remote</code> profile)</p>
</li>
</ul>
</div>
</li>
<li>
<p>columns for the inactive <code>default</code> profile are shown</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can specify more than one profile:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">poly info +default +remote</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/profile/info-multiple-profiles-annotated.png" alt="info multiple profiles annotated" width="600">
</div>
</div>
<div class="paragraph">
<p>Notice:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>default</code> and <code>remote</code> are listed as <code>active profiles</code></p>
</li>
<li>
<p>that the <code>dev</code> project column:</p>
<div class="ulist">
<ul>
<li>
<p>includes the <code>user</code> brick (which is in the <code>default</code> profile)</p>
</li>
<li>
<p>includes the <code>user-remote</code> brick (which is in the <code>remote</code> profile)</p>
</li>
</ul>
</div>
</li>
<li>
<p>no inactive profile columns are shown</p>
</li>
<li>
<p><code>poly</code> tells us that it does not like that we included both <code>user</code> and <code>user-remote</code> in the <code>development</code> project</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s see how many lines of code we have by specifying the <code>:loc</code> argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">poly info :loc</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/profile/output/info-loc.png" alt="info loc" width="600">
</div>
</div>
<div class="paragraph">
<p>Under bricks, each project column tallies the lines of code for its bricks <code>src</code> code.
The <code>loc</code> column counts the number of lines of codes for <code>src</code> directories, while <code>(t)</code> counts for the <code>test</code> directories.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Our tutorial <code>example</code> is small, but your real-world systems will likely reach thousands of lines of code.
When that happens, you may want to <a href="#user">reconfigure the thousand delimiter</a>, which is <code>,</code> by default.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing_with_poly_test"><a class="link" href="#_testing_with_poly_test">Testing with <code>poly test</code></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s run all the tests to verify that everything works:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">poly test :project</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/profile/test.png" alt="test">
</div>
</div>
<div class="paragraph">
<p>If your output matches, all that green is a very good sign; pat yourself on the back!</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dependencies"><a class="link" href="#_dependencies">Dependencies</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_dependencies_2" class="sect0"><a class="link" href="#_dependencies_2">Dependencies</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>When we talk about <code>poly</code> dependencies, we refer to dependencies between bricks (<a href="#">components</a> and <a href="#">bases</a>).
For 3rd-party library dependencies, see <a href="#">Libraries</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="setup"><a class="link" href="#setup">Setup for Tutorial</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>We&#8217;ll switch from our <code>example</code> <a href="#">tutorial</a> to the <a href="https://github.com/furkan3ayraktar/clojure-polylith-realworld-example-app">RealWorld example app</a> to explore dependencies.</p>
</div>
<div class="paragraph">
<p>If you&#8217;ve been following our ongoing <code>example</code> tutorial, first take a moment to ensure you aren&#8217;t currently in the <code>example</code> workspace directory.
Change directory, e.g., to the parent folder of your example workspace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">clone-from-here
 example
 clojure-polylith-realworld-example-app</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">git clone https://github.com/furkan3ayraktar/clojure-polylith-realworld-example-app.git
cd clojure-polylith-realworld-example-app</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_digging_in"><a class="link" href="#_digging_in">Digging In</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Have a look at the Realworld example app workspace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/dependencies/output/info.png" alt="info" width="400">
</div>
</div>
<div class="paragraph">
<p>Look at all those lovely bricks we have to play with!</p>
</div>
<div class="paragraph">
<p>List all <code>poly</code> dependencies by running the <a href="#deps">deps</a> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly deps</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/dependencies/deps-interfaces-annotated.png" alt="deps interfaces annotated" width="650">
</div>
</div>
<div class="paragraph">
<p>This is a summary of all brick dependencies in the workspace.
<a href="#">Interfaces</a> are shown in yellow, <a href="#">components</a> in green, and <a href="#">bases</a> in blue.</p>
</div>
<div class="paragraph">
<p>Notice the headers across the top are yellow (interfaces).</p>
</div>
<div class="paragraph">
<p>Each <code>x</code> is a <code>src</code> dependency, <code>t</code> is a <code>test</code> only dependency (code that lives in any of the directories specified in <code>:aliases &gt; :test &gt; :extra-paths</code>).</p>
</div>
<div class="paragraph">
<p>Reading the <code>article</code> component row, left to right, we see it <em>uses</em> <code>database</code>, <code>profile</code>, and <code>spec</code> interfaces (and the <code>user</code> interface, but only for testing).
Reading the <code>article</code> interface column, top to bottom, we see it <em>is used by</em> the <code>comment</code> component and <code>rest-api</code> base.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Our example here does not show it, but <a href="#">bases</a> can also depend on other bases.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can ask poly to hone in on the dependencies for a single brick.
Ask <code>poly</code> to report on the <code>article</code> brick:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly deps brick:article</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/dependencies/output/deps-interface.png" alt="deps interface" width="350">
</div>
</div>
<div class="paragraph">
<p>We&#8217;ve looked at brick  interface dependencies.
To examine brick  brick dependencies, you need to specify a project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly deps project:rb</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/dependencies/output/deps-components.png" alt="deps components" width="350">
</div>
</div>
<div class="paragraph">
<p>The header across the top is now green (components) instead of yellow (interfaces).
This component reporting is possible because <code>poly</code> is aware of all the implementing components within the selected project.</p>
</div>
<div class="paragraph">
<p>This report has extra symbols.
The <code>+</code> sign indicates an indirect dependency, and the <code>-</code> sign indicates indirect test dependencies (not present in our example output).
An example is the <code>article</code> component using the <code>log</code> component indirectly: <code>article</code> uses <code>database</code>, and <code>database</code> uses <code>log</code>.</p>
</div>
<div id="compact-view" class="paragraph">
<p>If you have many brick dependencies, you might prefer the compact format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly deps project:rb :compact</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/dependencies/output/deps-components-compact.png" alt="deps components compact" width="300">
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>You tell <code>poly</code> to always use the compact format for <code>deps</code> for your workspace by setting <code>:compact-views #{"deps"}</code> in your <a href="#workspace-edn">workspace.edn</a>.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>We can also show brick  brick dependencies for a specific brick within a project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly deps project:rb brick:article</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/dependencies/output/deps-component.png" alt="deps component" width="350">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_swap_axes"><a class="link" href="#_swap_axes">Swap axes</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>For large workspaces, it can sometimes make reading the diagram easier if you swap the axes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly deps :swap-axes</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/dependencies/deps-swapped-axes.png" alt="deps swapped axes" width="350">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_accessibility"><a class="link" href="#_accessibility">Accessibility</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>poly</code> tool restricts what can access what:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 23.8095%;">
<col style="width: 23.8095%;">
<col style="width: 38.0953%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Entity</th>
<th class="tableblock halign-left valign-top">From the <code>:src</code> context</th>
<th class="tableblock halign-left valign-top">From the <code>:test</code> context</th>
<th class="tableblock halign-left valign-top">Caution</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#">Component</a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Can <strong>only</strong> access:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#">interface</a> namespaces.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can access any namespace.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If component <code>x</code> test code accesses test code from component <code>y</code>, it is harder to swap out (replace) component <code>x</code>; you must also implement all component <code>y</code> tests for the replacement.<br>
A better strategy is to put any shared test code in a separate test helper component and depend on that component&#8217;s interface.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#">Base</a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Can <strong>only</strong> access:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#">interface</a> namespaces</p>
</li>
<li>
<p>any <a href="#">base</a> namespace</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can access any namespace.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#">Project</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can access any namespace.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can access any namespace.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">While tests are fine, we recommend against including <code>src</code> for deployable <code>./projects</code>; the <code>poly</code> tool does no checks on deployable project source code.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_circular_dependencies"><a class="link" href="#_circular_dependencies">Circular dependencies</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>poly</code> tool reports on circular brick dependencies.
If you have a dependency chain like A &gt; B &gt; A, or A &gt; B &gt; C &gt; A, then <code>poly</code> will show <code>Error 104 - Circular dependencies</code>.
To read more about this and other errors, see the <a href="#check">check</a> command.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_libraries"><a class="link" href="#_libraries">Libraries</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_libraries_2" class="sect0"><a class="link" href="#_libraries_2">Libraries</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>When we talk about <code>poly</code> libraries, we refer to 3rd-party library dependencies used by <a href="#">components</a>, <a href="#">bases</a>, and <a href="#">projects</a>.
For <code>poly</code> brick dependencies, see <a href="#">Dependencies</a>.</p>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool parses <code>deps.edn</code> files throughout your workspace to resolve 3rd-party library dependencies, which it uses for the <a href="#libs">libs</a> and <a href="#test">test</a> commands.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tutorial_setup"><a class="link" href="#_tutorial_setup">Tutorial Setup</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>We explored <a href="#setup">brick dependencies using the Realworld example app</a>; we&#8217;ll continue with the same workspace to explore <code>libraries</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reporting"><a class="link" href="#reporting">Reporting</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ask <code>poly</code> to report on 3rd-party libraries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly libs</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/libraries/output/libs.png" alt="libs">
</div>
</div>
<div class="paragraph">
<p>Notice that <code>poly</code> has reported on library usage across all:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#">projects</a> in purple - <code>rb</code> is the alias for the <code>realworld-backend</code> project, and <code>dev</code> is the alias for the <code>development</code> project.
The dependencies for a project also include the dependencies for its bricks.
If different versions of a library are referenced, <code>poly</code> will use the latest version of that library.</p>
</li>
<li>
<p><a href="#">components</a> in green</p>
</li>
<li>
<p><a href="#">bases</a> in blue</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An <code>x</code> means that the library is used from the <code>src</code> context, and <code>t</code> means that it&#8217;s only used from the <code>test</code> context.</p>
</div>
<div class="paragraph">
<p>The <code>type</code> column describes where the library is hosted. See <a href="#lib-dep-types">Library Dependency Types</a>.</p>
</div>
<div class="paragraph">
<p>The <code>KB</code> column shows the size of each library in kilobytes.
A <code>-</code> means <code>poly</code> could not calculate the library size because either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the library has not been downloaded yet</p>
</li>
<li>
<p>its <a href="#key-path">key path is wrong</a></p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>One way to force libraries to download is to run the following from your workspace root:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">clojure -A:dev:test -P</code></pre>
</div>
</div>
</div>
</div>
<div id="compact-view" class="paragraph">
<p>If your workspace has many bricks, you may prefer a more compact report format.
You can either set <code>:compact-views</code> to <code>#{"libs"}</code> in your <a href="#workspace-edn">workspace.edn</a> or specify the <code>:compact</code> argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly libs :compact</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/libraries/output/libs-compact.png" alt="libs compact">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_updating"><a class="link" href="#_updating">Updating</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can list outdated libraries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly libs :outdated</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your output will differ.
Here&#8217;s an example output where some libraries were out of date:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/libraries/libs-outdated.png" alt="libs outdated">
</div>
</div>
<div id="update" class="paragraph">
<p>You can ask <code>poly</code> to update all libraries to the <code>latest</code> version in all <code>deps.edn</code> for all bricks and projects via:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly libs :update</code></pre>
</div>
</div>
<div class="paragraph">
<p>To update specific <code>libraries:</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly libs :update libraries:djblue/portal:com.taoensso/timbre</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
When using the <a href="#">shell</a>, <code>poly</code> will, after a short pause, offer autocomplete suggestions for <code>libraries</code>!
</td>
</tr>
</table>
</div>
<div id="keep-lib-versions" class="paragraph">
<p>To skip updating specific libraries, specify <code>:keep-lib-versions</code> in your <a href="#workspace-edn">workspace.edn</a>, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{...
 :bricks {"article" {:keep-lib-versions [djblue/portal]}}}
 :projects {"realworld-backend" {:alias "rb"
                                 :keep-lib-versions [clj-jwt/clj-jwt clj-time/clj-time]}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lib-dep-types"><a class="link" href="#lib-dep-types">Library Dependency Types</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can specify libraries in three ways in <a href="#">tools.deps</a> <code>deps.edn</code> files:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maven</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>As a Maven dependency, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">clj-time/clj-time {:mvn/version "0.15.2"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The key is the Maven <code>groupId/artifactId</code>.
Maven artifacts are stored by default under <code>~/.m2/repositories/</code> (<a href="#user">configured</a> via <code>:m2-dir</code>).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>As a local dependency, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">clj-time {:local/root "/local-libs/clj-time-0.15.2.jar"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The key is an arbitrary identifier.
A local dependency is a path to a local jar file or directory.</p>
</div>
<div class="paragraph">
<p>See also: <a href="#local-deps">Local Dependencies</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Git</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>As a Git dependency, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">clj-time/clj-time {:git/url "https://github.com/clj-time/clj-time.git",
                   :sha "d9ed4e46c6b42271af69daa1d07a6da2df455fab"}</code></pre>
</div>
</div>
<div id="key-path" class="paragraph">
<p>The <code>poly</code> tool will calculate the <code>KB</code> column for a Git dependency, only if the key path matches the path for the libary under <code>~/.gitlibs/libs</code> (the Git owner and repo from the <code>:git/url</code>).</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_configuration"><a class="link" href="#_configuration">Configuration</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>3rd-party library dependencies are specified in <code>deps.edn</code> for each component, base, and project:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Entity</th>
<th class="tableblock halign-left valign-top">File</th>
<th class="tableblock halign-left valign-top">Scope</th>
<th class="tableblock halign-left valign-top">Location in File</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Components</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><code class="nowrap">components/<em>COMPONENT-DIR</em>/deps.edn</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:deps</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="nowrap">:aliases &gt; :test &gt; :extra-deps</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Bases</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><code class="nowrap">bases/<em>BASE-DIR</em>/deps.edn</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:deps</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="nowrap">:aliases &gt; :test &gt; :extra-deps</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Deployable projects</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><code class="nowrap">projects/<em>PROJECT-DIR</em>/deps.edn</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:deps</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="nowrap">:aliases &gt; :test &gt; :extra-deps</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Development project</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><code>./deps.edn</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="nowrap">:aliases &gt; :dev &gt; :extra-deps</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="nowrap">:aliases &gt; :test &gt; :extra-deps</code></p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="local-deps"><a class="link" href="#local-deps">Local Dependencies</a></h3>
<div class="sect3">
<h4 id="_distinguishing_from_bricks"><a class="link" href="#_distinguishing_from_bricks">Distinguishing from Bricks</a></h4>
<div class="paragraph">
<p>You&#8217;ll remember that you also specify bricks and projects as <code>:local/root</code> dependencies.
The <code>poly</code> tool distinguishes brick dependencies from local 3rd-party library dependencies by their paths.
The <code>poly</code> tool understands that when a <code>:local/root</code> path starts with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>../../bases/</code> or <code>../../components/</code> for deployable projects</p>
</li>
<li>
<p>or <code>bases/</code> or <code>components/</code> for the development project</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>that it is a <code>poly</code> brick <a href="#">dependency</a>; otherwise, it is considered a 3rd-party library dependency.</p>
</div>
</div>
<div class="sect3">
<h4 id="_differences_from_tools_deps"><a class="link" href="#_differences_from_tools_deps">Differences from Tools.deps</a></h4>
<div class="paragraph">
<p>When using the <a href="#">tools.deps</a> CLI (i.e. <code>clojure</code> or <code>clj</code>), <code>:local/root</code> dependencies only inherit <code>:src</code> dependencies; <code>:test</code> dependencies are ignored.
The <code>poly</code> tool builds upon tools.deps but has its own <a href="#">test runner</a> that it invokes for the <a href="#test">test</a> command.
Unlike the tools.deps CLI, the <code>poly</code> also inherits dependencies from the test context for <code>:local/root</code> dependencies.</p>
</div>
<div class="paragraph">
<p>If you want to run your tests directly from a project using the tools.deps CLI tool, you must duplicate test library dependencies from the bricks to the project&#8217;s <code>deps.edn</code> file under <code>:aliases &gt; :test &gt; :extra-deps</code>.
If you only run tests with the built-in <a href="#test">test</a> command, you don&#8217;t have to worry about this.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_project_library_dependencies"><a class="link" href="#_project_library_dependencies">Project Library Dependencies</a></h3>
<div class="paragraph">
<p>The library dependencies for a project are the sum of all library dependencies that are indirectly included via its bricks, together with dependencies declared by the project itself.
If different versions of the same library dependency exist, then <code>poly</code> will use the latest version.</p>
</div>
<div class="paragraph">
<p>You can override the library version used for a project in its <code>deps.edn</code> file.
For example:</p>
</div>
<div class="listingblock">
<div class="title">./projects/realworld-backend/deps.edn</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{...
 :deps {poly/article  {:local/root "../../components/article"}
        poly/comment  {:local/root "../../components/comment"}
        poly/database {:local/root "../../components/database"}
        ...

 :override-deps {clj-time/clj-time {:mvn/version "0.15.1"}} <i class="conum" data-value="1"></i><b>(1)</b>
 ...
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Override version of <code>clj-time/clj-time</code> for this project</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you re-run the libs command:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/libraries/output/libs-override.png" alt="libs override">
</div>
</div>
<div class="paragraph">
<p>Notice that two versions of <code>clj-time</code> are listed and that the <code>realworld-backend</code> project now uses version <code>0.15.1</code>.</p>
</div>
<div class="paragraph">
<p>You can override project library dependencies for <a href="#">projects</a> via <code>:override-deps</code> in the following places:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Entity</th>
<th class="tableblock halign-left valign-top">File</th>
<th class="tableblock halign-left valign-top">Scope</th>
<th class="tableblock halign-left valign-top">Location in File</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Deployable projects</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><code class="nowrap">projects/<em>PROJECT-DIR</em>/deps.edn</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:override-deps</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="nowrap">:aliases &gt; :test &gt; :override-deps</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Development project</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><code>./deps.edn</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="nowrap">:aliases &gt; :dev &gt; :override-deps</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="nowrap">:aliases &gt; :test &gt; :override-deps</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Overriding a library in the <code>src</code> scope will also affect the <code>test</code> scope.
If you override a library in the <code>test</code> scope, it will only affect the <code>test</code> scope.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_2"><a class="link" href="#_configuration_2">Configuration</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_configuration_3" class="sect0"><a class="link" href="#_configuration_3">Configuration</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>We have three categories of configuration:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Category</th>
<th class="tableblock halign-left valign-top">File(s)</th>
<th class="tableblock halign-left valign-top"><a href="#">Workspace Structure</a> <code>:configs</code> key(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>poly</code> workspace</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>workspace.edn</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:workspace</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#">tools.deps</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>deps.edn</code> files in projects and bricks</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:projects</code> <code>:bases</code> <code>:components</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>poly</code> user</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>~/.config/polylith/config.edn</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:user</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are following along from our <code>example</code> workspace <a href="#">tutorial</a>, you might notice some output does not exactly match what we show here.
In some cases, we added a bit of config just to show what it would look like.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_poly_workspace_edn"><a class="link" href="#_poly_workspace_edn">Poly <code>workspace.edn</code></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>An initial <code>workspace.edn</code> is automatically generated when you <a href="#">create a workspace</a>.
You make changes by editing the <code>workspace.edn</code> file directly.</p>
</div>
<div class="paragraph">
<p>You can list workspace configs with the <a href="#ws">ws</a> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:configs:workspace</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:bricks {"user-remote" {:keep-lib-versions [ring/ring slacker/slacker]}}
 :compact-views #{},
 :default-profile-name "default",
 :interface-ns "interface",
 :projects {"command-line" {:alias "cl",
                            :test {:setup-fn project.command-line.test-setup/setup,
                                   :teardown-fn project.command-line.test-setup/teardown}},
            "development" {:alias "dev"},
            "user-service" {:alias "user-s"}},
 :tag-patterns {:release "v[0-9]*", :stable "stable-*"},
 :top-namespace "se.example",
 :vcs {:auto-add true, :name "git"}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The workspace map keys are:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:bricks</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Brick-specific configuration where the map key is the brick name.
Specify <code>:keep-lib-versions</code> to tell <code>libs :update</code> to <a href="#keep-lib-versions">skip specified libraries</a>.<br>
<strong>Default:</strong> absent, effectively <code>{}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:compact-view</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Can tell <code>poly</code> to use a compact format for <a href="#deps">deps</a> command <a href="#compact-view">output</a> and <a href="#libs">libs</a> command <a href="#compact-view">output</a>.
For example, to turn compact format on for both <code>deps</code> and <code>libs</code>, set to <code>#{"deps" "libs"}</code>.<br>
<strong>Default:</strong> <code>#{}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code class="nowrap">:default-profile-name</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The name of the profile that <code>poly</code> automatically merges into the <a href="#">development</a> project when using <a href="#">profiles</a>, and no profile is specified.<br>
<strong>Default:</strong> <code>"default"</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:interface-ns</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Tells <code>poly</code> when to consider a namespace an interface and what naming convention the <a href="#create-component">create component</a> command should use.
See <a href="#interface-ns">Interface</a> for important details.<br>
<strong>Default:</strong> <code>"interface"</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:projects</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>See <a href="#ws-projects">projects</a> below.<br>
<strong>Default:</strong> see below</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:tag-patterns</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies the <a href="https://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html">regex</a> patterns used when searching for the most recent tag in git.
As explained in <a href="#">Tagging</a>, <code>poly</code> uses this pattern to calculate the latest committed sha that is considered the <em>latest stable point in time</em>.<br>
<strong>Default:</strong> <code>{:stable "stable-*" :release "v[0-9]*"}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:test</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>See <a href="#test-configuration">Test configuration</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:top-namespace</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The top namespace used throughout the workspace in components and bases, specified by you when you create your <a href="#">workspace</a>.<br>
<strong>Default:</strong> none, must be specified</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:vcs</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A map with two keys describing your <a href="https://en.wikipedia.org/wiki/Version_control">version control system</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>:name</code> at this time, always <code>"git"</code></p>
</li>
<li>
<p><code>:auto-add</code> a boolean, when <code>true</code>, tells <code>poly</code> to automatically add directories and files to git that are generated by the <a href="#create">create</a> command.<br></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Default:</strong> <code>{:name "git" :auto-add false}</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="ws-projects"><a class="link" href="#ws-projects">Projects</a></h3>
<div class="paragraph">
<p>You configure individual <a href="#">projects</a> under the <code>:projects</code> key.
You can retrieve projects config via:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:configs:workspace:projects</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{"command-line" {:alias "cl",
                 :test {:setup-fn project.command-line.test-setup/setup,
                        :teardown-fn project.command-line.test-setup/teardown}},
 "development" {:alias "dev"},
 "user-service" {:alias "user-s"
                 :test {:exclude ["mybrick"]}
                 :keep-lib-versions [org.slf4j/slf4j-nop]
                 :necessary ["helper"]}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The keys are the full project names.</p>
</div>
<div class="paragraph">
<p>The default alias for the <code>development</code> project is created for you when your <a href="#">create your workspace</a>.
Deployable projects get no automatically generated config under <code>:projects</code>.</p>
</div>
<div class="paragraph">
<p>Project map keys are:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:alias</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies a short name for a project.
You can use the alias instead of the full project name for various <code>poly</code> commands.
If not specified, the <a href="#info">info</a> and <a href="#">libs</a> commands emit a <code>?</code> followed by a number (e.g. <code>?1</code>) for project column headings.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code class="nowrap">:keep-lib-versions</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Tells <code>libs :update</code> to <a href="#keep-lib-versions">skip specified libraries</a> for the project.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code class="nowrap">:necessary</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Supports turning off <code>Warning 207</code> for one or more bricks.
See <a href="#warning207">Validations</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:test</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>See next table below.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You specify <a href="#">test</a> configuration under the <code>:test</code> key for a specific project:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:exclude</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Lists the bricks to exclude when running tests for the project.
<sup><a href="#include-exclude">1</a></sup></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:include</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Lists the bricks to include when running tests for the project.
<sup><a href="#include-exclude">1</a></sup></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:setup-fn</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The function name (including namespace) to call before <code>poly</code> runs tests.
<sup><a href="#setup-teardown">2</a></sup></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code class="nowrap">:teardown-fn</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The function name (including namespace) to call after <code>poly</code> runs tests.
<sup><a href="#setup-teardown">2</a></sup></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table notes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a id="include-exclude"></a> See <a href="#include-exclude">Include and Exclude Bricks by Configuration</a>.</p>
</li>
<li>
<p><a id="setup-teardown"></a> See <a href="#setup-and-teardown">Test Setup and Teardown</a>.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tools_deps_deps_edn_files"><a class="link" href="#_tools_deps_deps_edn_files">Tools.deps <code>deps.edn</code> Files</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The various <code>poly create</code> commands create initial <code>deps.edn</code> files.
You make changes via manual edits or the <a href="#update">libs :update</a> command.</p>
</div>
<div class="sect2">
<h3 id="_projects"><a class="link" href="#_projects">Projects</a></h3>
<div class="paragraph">
<p>Each <a href="#">project</a> has its own <code>deps.edn</code> configuration file.</p>
</div>
<div class="paragraph">
<p>You&#8217;ll find:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="#">development</a> project config in <code>./deps.edn</code>.
The <a href="#create-workspace">create workspace</a> command creates the initial file.</p>
</li>
<li>
<p>Deployable <a href="#">projects</a> are configured in <code>projects/<em>PROJECT-DIR</em>/deps.edn</code> where <code><em>PROJECT-DIR</em></code> is the deployable project&#8217;s directory (and name).
The <a href="#create-project">create project</a> command creates the initial file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can retrieve a project&#8217;s tools.deps config via, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:configs:projects:command-line</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:deps {:aliases {:test {:extra-deps {}, :extra-paths ["test"]},
                  :uberjar {:main se.example.cli.core}},
        :deps {org.apache.logging.log4j/log4j-core {:mvn/version "2.13.3"},
               org.apache.logging.log4j/log4j-slf4j-impl {:mvn/version "2.13.3"},
               org.clojure/clojure {:mvn/version "1.11.1"},
               poly/cli {:local/root "../../bases/cli"},
               poly/user-remote {:local/root "../../components/user-remote"}}},
 :name "command-line",
 :type "project"}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:deps</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Content of project <code>deps.edn</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:name</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(derived) The project name</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:type</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(derived) Always <code>"project"</code> for projects</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_bases"><a class="link" href="#_bases">Bases</a></h3>
<div class="paragraph">
<p>Each <a href="#">base</a> tools.deps config is found in <code>bases/<em>BASE-DIR</em>/deps.edn</code> where <code><em>BASE-DIR</em></code> is the base&#8217;s directory (and name).
The <a href="#create-base">create base</a> command creates the initial file.</p>
</div>
<div class="paragraph">
<p>You can retrieve a base&#8217;s tools.deps config via, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:configs:bases:cli</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:deps {:aliases {:test {:extra-deps {}, :extra-paths ["test"]}},
        :deps {},
        :paths ["src" "resources"]},
 :name "cli",
 :type "base"}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:deps</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Content of base <code>deps.edn</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:name</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(derived) The base name.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:type</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(derived) Always <code>"base"</code> for bases.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_components"><a class="link" href="#_components">Components</a></h3>
<div class="paragraph">
<p>Each <a href="#">component</a> tools.deps config is found in <code>components/<em>COMPONENT-DIR</em>/deps.edn</code> where <code><em>COMPONENT-DIR</em></code> is the component&#8217;s directory (and name).</p>
</div>
<div class="paragraph">
<p>You can retrieve a component&#8217;s tools.deps config via, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:configs:components:user</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:deps {:aliases {:test {:extra-deps {}, :extra-paths ["test"]}},
        :deps {},
        :paths ["src" "resources"]},
 :name "user",
 :type "component"}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:deps</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The content of <code>deps.edn</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:name</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(derived) The component name.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:type</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(derived) Always <code>"component"</code> for components.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="user"><a class="link" href="#user">Poly User <code>config.edn</code></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>You specify your user preferences in <code>~/.config/polylith/config.edn</code>.
If it does not already exist, the <a href="#create-workspace">create workspace</a> automatically creates this file for you.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>If you started using the <code>poly</code> tool from version <code>0.2.14-alpha</code> or earlier, then the settings may be stored in <code>~/.polylith/config.edn</code>:</p>
</div>
</div>
</div>
<div class="paragraph">
<p>You can retrieve the config via:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:configs:user</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:color-mode "dark", :empty-character ".", :thousand-separator ","}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="color-mode"></a> <code>:color-mode</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Valid values are <code>"none"</code>, <code>"light"</code> and <code>"dark"</code>; see the <a href="#">Colors</a>.
You can override when running <code>poly</code> <a href="#">commands</a> with e.g.: <code>poly info color-mode:none</code>.<br>
<strong>Default:</strong> <code>"none"</code> on Windows, <code>"dark"</code> on other operating systems.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:empty-character</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The <code>poly</code> tool uses this character in output for the <a href="#deps">deps</a> and <a href="#libs">libs</a> commands.<br>
<strong>Default:</strong> <code>"."</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code class="nowrap">:thousand-separator</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The thousands separator for <code>:loc</code> for the <a href="#info">info</a> command.<br>
<strong>Default:</strong> <code>","</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:m2-dir</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Tells the <a href="#libs">libs</a> where it can find your local Maven repository, which it uses to calculate library <code>KB</code> sizes.<br>
<strong>Default:</strong> <code>~/.m2</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:ws-shortcuts</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Contains a map with the keys <code>:root-dir</code> and <code>:paths</code> which are used by the <a href="#switch-workspace">switching workspace</a> functionality in the shell. The <code>:root-dir</code> stores the root of the paths specified in <code>:paths</code> and is prepended to the paths. Each map in <code>:paths</code> has either a <code>:dir</code> or <code>:file</code> key which specifies a path for a workspace. The name of the directory or file will be used by the <code>via:NAME</code> argument, but can be overridden by <code>:name</code>.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="custom"><a class="link" href="#custom">Custom configuration</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you have custom configuration data, then we suggest that you put it in a <code>:custom</code> key in <code>workspace.edn</code> at the root and/or under each brick/project. If you put your custom data there, it will not collide with future keys introduced by the tool.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_validations"><a class="link" href="#_validations">Validations</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_validations_2" class="sect0"><a class="link" href="#_validations_2">Validations</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>Each time you execute the <a href="#check">check</a>, <a href="#info">info</a>, or <a href="#test">test</a> command, your workspace is validated.</p>
</div>
<div class="paragraph">
<p>For a list of validations, see the <a href="#check">check</a> command.
You can show the same help at your terminal via:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly help check</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>check</code> command returns a non-zero exit code on errors only (not warnings).
See <a href="#check">check</a> for details.</p>
</div>
<div class="paragraph">
<p>The <a href="#test">test</a> command fails fast on any <a href="#check">check</a> errors.
Warnings do not affect <code>test</code> outcome.</p>
</div>
<div class="paragraph">
<p>The <a href="#info">info</a> command shows errors and warnings, but they do not affect its exit code.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
By default, <a href="#check">check</a> only runs against projects under the <code>projects</code> directory.
Specify the <code>:dev</code> argument, and <code>poly</code> will also check your <code>development</code> project.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_viewing_all_errors_and_warnings"><a class="link" href="#_viewing_all_errors_and_warnings">Viewing All Errors and Warnings</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>poly</code> tool stores all errors and warnings in the <a href="#">workspace structure</a>; you can list them via the <a href="#ws">ws</a> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:messages</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example output:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/validations/messages-example.png" alt="messages example" width="600">
</div>
</div>
<div class="paragraph">
<p>If your workspace doesn&#8217;t have any active warnings or errors, you will see an empty result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">[]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="warning207"><a class="link" href="#warning207">Marking a Brick as Necessary to Suppress Warning 207</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="#check">check</a> command generates a <code>Warning 207 - Unnecessary components were found in project</code> when it finds components unused by any bricks in a project.</p>
</div>
<div class="paragraph">
<p>Suppose you get warning 207 for a project but know the component is needed (e.g., it is used dynamically but not explicitly called).
In that case, you can suppress the warning by specifying that it is <code>:necessary</code> to the project in your <code>workspace.edn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{...
 :projects {"poly" {:alias "poly"
                    :necessary ["api" "clojure-test-test-runner"] <i class="conum" data-value="1"></i><b>(1)</b>
                    :test {:setup-fn project.poly.hto/activate!}}
            "polyx" {:alias "polyx" :test [] :necessary ["clojure-test-test-runner"]} <i class="conum" data-value="1"></i><b>(1)</b>
            "development" {:alias "dev"}}
...}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Example usages from the <code>poly</code> tool <a href="https://github.com/polyfy/polylith/blob/969d3beea27e754fcaccbf52631449774a4d7e7c/workspace.edn#L9-L13">itself</a></td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="error111"><a class="link" href="#error111">Workspace Structure Reflects Error 111</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>If <code>poly</code> finds that a <code>.clj</code> or <code>.cljc</code> source file is unreadable or its namespace is missing, you will see <code>Error 111: Unreadable namespace</code>.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s explore this error with our <code>example</code> <a href="#">tutorial</a> workspace.
The <code>example</code> workspace source is <a href="/examples/doc-example">here</a> if you have not been following along.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you follow along, remember to revert your changes to your <code>example</code> workspace afterward.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Comment out the <code>se.example.user.core</code> namespace declaration in the <code>user</code> component:</p>
</div>
<div class="listingblock">
<div class="title">./components/user/src/se/example/user/core.clj</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">;(ns se.example.user.core) <i class="conum" data-value="1"></i><b>(1)</b>

(defn hello [name]
  (str "Hello " name "!!"))</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Comment this line out</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly check</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see this error:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/validations/missing-or-unreadable-namespace.png" alt="missing or unreadable namespace">
</div>
</div>
<div class="paragraph">
<p>Have a look at the namespace with the <a href="#ws">ws</a> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:components:user:namespaces:src:core</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that <code>poly</code> has marked it as invalid:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:file-path "components/user/src/se/example/user/core.clj",
 :imports [],
 :is-invalid true, <i class="conum" data-value="1"></i><b>(1)</b>
 :name "core",
 :namespace ""}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Marked as invalid</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_state"><a class="link" href="#_state">State</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_state_2" class="sect0"><a class="link" href="#_state_2">State</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>Managing the lifecycle and dependencies of stateful parts of your system can be complex and error-prone. State management tools like <a href="https://github.com/stuartsierra/component">Component</a>, <a href="https://github.com/weavejester/integrant">Integrant</a>, and <a href="https://github.com/tolitius/mount">Mount</a> can help you with this by providing a structured way to handle initialization, configuration, and dependencies.</p>
</div>
<div class="paragraph">
<p>Here is a list with examples that uses Polylith:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 18.75%;">
<col style="width: 18.75%;">
<col style="width: 31.25%;">
<col style="width: 31.25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Library</th>
<th class="tableblock halign-left valign-top">Example</th>
<th class="tableblock halign-left valign-top">Author</th>
<th class="tableblock halign-left valign-top">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/stuartsierra/component">Component</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/seancorfield/usermanager-example">usermanager-example</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/seancorfield">Sean Corfield</a></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/weavejester/integrant">Integrant</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/polyfy/polylith/tree/master/examples/integrant-system">integrant-system</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/marksto">Mark Sto</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See also <a href="https://clojurians.slack.com/archives/C013B7MQHJQ/p1719864242173699">this</a> thread in Slack.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mount</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An example in Mount will soon be available!</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_source_code"><a class="link" href="#_source_code">Source Code</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_source_code_2" class="sect0"><a class="link" href="#_source_code_2">Source code</a></h1>
<div class="sect1">
<h2 id="_paths"><a class="link" href="#_paths">Paths</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>In all our examples thus far, we&#8217;ve shown source code stored in two directories: <code>src</code> and <code>test</code>.
<a href="#">Tools.deps</a> supports splitting source and test code into several directories, as does <code>poly</code>.</p>
</div>
<div class="paragraph">
<p>We&#8217;ve only shown <code>.clj</code> files in our examples, but <code>poly</code> also recognizes <code>.cljc</code> files, which you can use to share code between Clojure and ClojureScript.
(See <a href="#frontend">Frontend Code Options</a> below.)</p>
</div>
<div class="paragraph">
<p>We&#8217;ll contrive an example of splitting source code over multiple directories by exploring two ways of storing <code>.clj</code> and <code>.cljc</code> files.
Imagine a <code>company</code> component that contains both <code>.clj</code> and <code>.cljc</code> files.
You can choose to store both types of files in the same <code>src</code> directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell"> components
    company
       src</code></pre>
</div>
</div>
<div class="paragraph">
<p>For this strategy, you&#8217;d configure the component&#8217;s <code>deps.edn</code> file like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:paths ["src"]
 ....</code></pre>
</div>
</div>
<div class="paragraph">
<p>An alternative is to store the source code in two separate directories:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell"> components
    company
       clj
       cljc</code></pre>
</div>
</div>
<div class="paragraph">
<p>And configure <code>:paths</code> in the component&#8217;s <code>deps.edn</code> file as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:paths ["clj" "cljc"]
 ....</code></pre>
</div>
</div>
<div class="paragraph">
<p>Some prefer this scheme, as it clearly shows where all the <code>.cljc</code> code resides.
We are not recommending one strategy over the other.
Our focus is to illustrate splitting source code over multiple paths.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources"><a class="link" href="#_resources">Resources</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>resources</code> directory stores non-source files, e.g., images or data, and lives in bricks and, optionally, projects.
To keep resource paths unique on the classpath, <code>poly</code> creates a sub-directory under <code>resources</code> when creating a brick.
For <a href="#">components</a>, the sub-directory name is the component&#8217;s <a href="#">interface</a> name, and for <a href="base.asdoc">bases</a>, it&#8217;s the base name, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell"> bases
    worker
       resources
          worker
              mydata.edn
 components
    creator
       resources
          creator <i class="conum" data-value="1"></i><b>(1)</b>
              logo.png</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>By default, the interface names match component names</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you have resource files that are only used in the test context, then they can be put in a <code>test-resources</code> directory.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="frontend"><a class="link" href="#frontend">Frontend Code Options</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>poly</code> tool doesn&#8217;t understand <a href="https://clojurescript.org/">ClojureScript</a> <code>.cljs</code> files, but it recognizes <code>.cljc</code> files, which you can use to share code between your backend and frontend.</p>
</div>
<div class="paragraph">
<p>Three frontend code organization alternatives are:</p>
</div>
<div class="sect2">
<h3 id="_1_frontend_in_base_or_components"><a class="link" href="#_1_frontend_in_base_or_components">1. Frontend in Base or Components</a></h3>
<div class="paragraph">
<p>This option puts all your frontend code in a <a href="#">base</a>.</p>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool recognizes <code>.cljc</code> files in the base, resulting in a ClojureScript view of the component when used from the frontend.</p>
</div>
<div class="paragraph">
<p>If you want to share the <code>.cljc</code> code with the backend, you would put that code in one or more <a href="#">components</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_2_frontend_in_a_non_poly_directory"><a class="link" href="#_2_frontend_in_a_non_poly_directory">2. Frontend in a Non-<code>poly</code> Directory</a></h3>
<div class="paragraph">
<p>Another option is to put the frontend code in a separate directory.
Two alternatives are:</p>
</div>
<div class="sect3">
<h4 id="_a_under_the_workspace"><a class="link" href="#_a_under_the_workspace">a) Under the Workspace</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">myworkspace
 bases
 components
 development
 myfrontend <i class="conum" data-value="1"></i><b>(1)</b>
 projects</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Not a base, not a component, just your frontend code referenced as <code>:local/root</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You would include <code>.cljc</code> files from your backend code by treating it as a library and referencing it via <code>:local/root</code>.
A drawback is that changes to the frontend code files will not be detected by <code>poly</code> because they sit outside the <code>poly</code> directory structure and are, therefore, unknown to <code>poly</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We are working on supporting ClojureScript, see <a href="https://github.com/polyfy/polylith/issues/481">this</a> issue.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_b_outside_the_workspace"><a class="link" href="#_b_outside_the_workspace">b) Outside the Workspace</a></h4>
<div class="paragraph">
<p>Under this strategy, the frontend code sits within your git repository but physically outside of the workspace.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">myrepository
 mybackend <i class="conum" data-value="1"></i><b>(1)</b>
    bases
    components
    development
    projects
 myfrontend <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>mybackend <code>poly</code> workspace</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>myfrontend plain old Clojure <code>:local/root</code> library</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You would reference frontend <code>.cljc</code> files as a <code>:local/root</code> library in the same way as in alternative 2a.
The <code>poly</code> tool can handle both layouts; it&#8217;s more a matter of preference what you choose.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_3_frontend_in_separate_repository"><a class="link" href="#_3_frontend_in_separate_repository">3. Frontend in Separate Repository</a></h3>
<div class="paragraph">
<p>The last alternative is to put your frontend code in a separate git repository.</p>
</div>
<div class="paragraph">
<p>Some downsides to this strategy are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You are no longer working with a monorepo and might even have separate frontend and backend releases</p>
</li>
<li>
<p>You have a greater risk of the frontend and backend code becoming out of synch</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_artifacts"><a class="link" href="#_artifacts">Artifacts</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_artifacts_2" class="sect0"><a class="link" href="#_artifacts_2">Artifacts</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>We assemble our bricks (<a href="#">components</a> and <a href="#">bases</a>) in <a href="#">deployable projects</a> from which we build artifacts.</p>
</div>
<div class="paragraph">
<p>The base (a project typically has a single base) acts as the runtime entry point.</p>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool has no say in what type of artifacts we build or how we <a href="#">build</a> them.
Some artifact examples are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>REST APIs</p>
</li>
<li>
<p>Lambda functions</p>
</li>
<li>
<p>Command line tools</p>
</li>
<li>
<p>Libraries</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="libraries"><a class="link" href="#libraries">Libraries</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are challenges associated with building more than one library from a single workspace.
But let&#8217;s start with the simple case.</p>
</div>
<div class="sect2">
<h3 id="_single_library"><a class="link" href="#_single_library">Single library</a></h3>
<div class="paragraph">
<p>Let&#8217;s say we have a workspace with three components:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/artifacts/workspace.png" alt="workspace" width="300">
</div>
</div>
<div class="paragraph">
<p>Now we can easily build a library of these components (e.g. <code>libx.jar</code>) and everything will work just as well as if we had a traditional monolithic codebase:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/artifacts/single-lib.png" alt="single lib" width="300">
</div>
</div>
<div class="paragraph">
<p>It&#8217;s natural to use a base to expose a library&#8217;s functionality, as they are meant for that job (exposing APIs).
For instance, we can use a <code>libx-api</code> base to expose the functionality of the <code>libx</code> library above.
Alternatively, we can use a component to expose the functionality, as demonstrated by the <a href="https://cljdoc.org/d/polylith/clj-poly/CURRENT/api/polylith.clj.core.api">clj-poly</a> library.</p>
</div>
</div>
<div class="sect2">
<h3 id="_multiple_libraries"><a class="link" href="#_multiple_libraries">Multiple libraries</a></h3>
<div class="paragraph">
<p>Let&#8217;s say we release <code>1.1</code> of library <code>libx</code> and <code>liby</code>, and then after a while we release <code>1.2</code>.
If someone out there now includes <code>libx-1.1</code> and <code>liby-1.2</code> in their classpath, we will get this situation:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/artifacts/multiple-libs.png" alt="multiple libs" width="400">
</div>
</div>
<div class="paragraph">
<p>Here the <code>c</code> component is used by both <code>libx</code> and <code>liby</code> and depending on which library that comes first in the classpath, we will get either <code>1.1</code> or <code>1.2</code> of <code>c</code>.</p>
</div>
<div class="paragraph">
<p>If the interface of <code>c</code> has changed between <code>1.1</code> and <code>1.2</code> then <code>libx</code> may even fail to compile.
Even if it does compile, it remains problematic, because
<code>c</code> may exhibit new behavior that hasn&#8217;t been tested from the <code>1.1</code> context.</p>
</div>
</div>
<div class="sect2">
<h3 id="_one_library_per_brick"><a class="link" href="#_one_library_per_brick">One library per brick</a></h3>
<div class="paragraph">
<p>There is another alternative, and that is to build one library/jar per brick:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/artifacts/one-lib-per-brick.png" alt="one lib per brick" width="400">
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s say we have built and released <code>1.1</code> of all these five libraries, and then after a while, we release <code>1.2</code>. Let&#8217;s say someone has included version <code>1.1</code> of "libx" by including <code>liba</code>, <code>libb</code>, and <code>libc</code>, and version <code>1.2</code> of "liby" by including <code>libc</code>, <code>libd</code> and <code>libe</code>.
Now, we can&#8217;t be certain which version of component <code>c</code> will be picked up by the classloader, as it depends on the order in which the libraries are specified:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/artifacts/one-lib-per-brick-grouped.png" alt="one lib per brick grouped" width="500">
</div>
</div>
<div class="paragraph">
<p>This means we experience the same problem as if we build <code>libx</code> and <code>liby</code> separately.</p>
</div>
</div>
<div class="sect2">
<h3 id="_one_library_per_workspace"><a class="link" href="#_one_library_per_workspace">One library per workspace</a></h3>
<div class="paragraph">
<p>The most solid solution is probably to build a single jar out of the entire workspace that includes all the bricks (<code>myws.jar</code> in this example) and thus all the libraries:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/artifacts/one-lib-per-workspace.png" alt="one lib per workspace" width="400">
</div>
</div>
<div class="paragraph">
<p>This will ensure that the same version of all libraries is used, regardless of which one(s) the user is interested in.</p>
</div>
</div>
<div class="sect2">
<h3 id="_adjust_the_top_namespace_at_build_time"><a class="link" href="#_adjust_the_top_namespace_at_build_time">Adjust the top namespace at build time</a></h3>
<div class="paragraph">
<p>The last alternative is to adjust the top namespace for each library, when building the jar. We should keep the namespace of the API base though, so that people don&#8217;t have to change their <code>:require</code> statements when they use the library.</p>
</div>
<div class="paragraph">
<p>This approach comes with its own challenges, which is discussed in issue <a href="https://github.com/polyfy/polylith/issues/212">212</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conclusion"><a class="link" href="#_conclusion">Conclusion</a></h3>
<div class="paragraph">
<p>If you have intended to build two or more libraries from a Polylith workspace, we recommend that you build one library per workspace.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_explore_the_workspace"><a class="link" href="#_explore_the_workspace">Explore the Workspace</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_explore_the_workspace_2" class="sect0"><a class="link" href="#_explore_the_workspace_2">Explore the Workspace</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>The <code>poly</code> tool stores the workspace structure internally in an in-memory map.
It is used by <code>poly</code> internally to support all <a href="#">commands</a>.
All operations happen efficiently and directly on the map.</p>
</div>
<div class="paragraph">
<p>We expose the workspace structure via <code>ws</code> to allow our users to explore the complete state of any workspace.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The workspace structure represents internal state and can change with new releases of <code>poly</code>.
See <a href="#">Versions</a> for a changelog.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This document is a guide, see <a href="#">workspace structure</a> for a complete reference.</p>
</div>
<div class="paragraph">
<p>All examples operate on our tutorial <a href="/examples/doc-example">example workspace</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exploring_with_ws"><a class="link" href="#_exploring_with_ws">Exploring With <code>ws</code></a></h2>
<div class="sectionbody">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
We recommend you <em>always</em> use the <a href="#">shell</a>.
Its command autocompletion really shines when exploring workspace structures with the <a href="#ws">ws</a> command.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_the_basics"><a class="link" href="#_the_basics">The Basics</a></h3>
<div class="paragraph">
<p>To return the entire workspace structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws</code></pre>
</div>
</div>
<div class="paragraph">
<p>The workspace structure is large.
You can limit what <code>poly</code> returns via the <code>get</code> argument.
For example, to return <code>settings</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:settings</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:active-profiles #{"default"},
 :color-mode "dark",
 :compact-views #{},
 :default-profile-name "default",
 :empty-character ".",
 :interface-ns "interface",
 :m2-dir "/Users/joakimtengstrand/.m2",
 :tag-patterns {:release "v[0-9]*", :stable "stable-*"},
 :thousand-separator ",",
 :top-namespace "se.example",
 :user-config-filename "/Users/joakimtengstrand/.config/polylith/config.edn",
 :user-home "/Users/joakimtengstrand",
 :vcs {:auto-add true,
       :branch "issue-315",
       :git-root "/Users/joakimtengstrand/source/polylith",
       :is-git-repo true,
       :name "git",
       :polylith {:branch "master",
                  :repo "https://github.com/polyfy/polylith.git"},
       :stable-since {:sha "15453ebc5a86f52ee1c75ec52ebb19da4b113c30",
                      :tag "stable-master"}}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="#settings">workspace structure</a> reference for descriptions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_digging_deeper"><a class="link" href="#_digging_deeper">Digging Deeper</a></h3>
<div class="paragraph">
<p>If you are only interested in a specific element in this structure, you can dig deeper, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:profiles:default:paths</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">["components/user/src" "components/user/resources" "components/user/test"]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_learning_what_data_is_available"><a class="link" href="#_learning_what_data_is_available">Learning What Data is Available</a></h3>
<div class="paragraph">
<p>When exploring, it is nice to know what is available.
To list top level keys:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:keys</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">[:bases
 :changes
 :components
 :configs
 :interfaces
 :messages
 :name
 :paths
 :profiles
 :projects
 :settings
 :user-input
 :version
 :ws-dir
 :ws-local-dir
 :ws-reader
 :ws-type]</code></pre>
</div>
</div>
<div class="paragraph">
<p>To list the <code>components</code> keys:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:components:keys</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">["user" "user-remote"]</code></pre>
</div>
</div>
<div class="paragraph">
<p>To show the <code>user</code> component:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:components:user</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:interface {:definitions [{:name "hello"
                            :arglist [{:name "name"}]
                            :type "function"}]
             :name "user"}
 :interface-deps {:src [], :test []}
 :lib-deps {}
 :lib-imports {:test ["clojure.test"]}
 :lines-of-code {:src 9, :test 7}
 :name "user"
 :namespaces {:src [{:file-path "components/user/src/se/example/user/interface.clj"
                     :imports ["se.example.user.core"]
                     :name "interface"
                     :namespace "se.example.user.interface"}
                    {:file-path "components/user/src/se/example/user/core.clj"
                     :imports []
                     :name "core"
                     :namespace "se.example.user.core"}]
              :test [{:file-path "components/user/test/se/example/user/interface_test.clj"
                      :imports ["clojure.test" "se.example.user.interface"]
                      :name "interface-test"
                      :namespace "se.example.user.interface-test"}]}
 :paths {:src ["src" "resources"], :test ["test"]}
 :type "component"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="#components">workspace structure</a> reference for descriptions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_fetching_library_usage"><a class="link" href="#_fetching_library_usage">Fetching Library Usage</a></h3>
<div class="paragraph">
<p>We&#8217;ve shown you how the <a href="#libs">libs</a> command <a href="#reporting">reports 3rd-party library usage</a>.
You can also retrieve library usage via <code>ws</code>, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:components:user-remote:lib-deps</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{"compojure/compojure" {:size 15172, :type "maven", :version "1.6.2"},
 "http-kit/http-kit" {:size 191467, :type "maven", :version "2.4.0"},
 "ring/ring" {:size 4621, :type "maven", :version "1.8.1"},
 "slacker/slacker" {:size 28408, :type "maven", :version "0.17.0"}}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="export-workspace"><a class="link" href="#export-workspace">Saving the Workspace Structure</a></h3>
<div class="paragraph">
<p>To save output to a file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws out:ws.edn</code></pre>
</div>
</div>
<div class="paragraph">
<p>An alternative way to reach the same result from your OS shell (e.g. bash, redirection does not work from the poly shell) is to turn off the coloring and redirect to <code>ws.edn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws color-mode:none &gt; ws.edn</code></pre>
</div>
</div>
<div class="paragraph">
<p>A saved workspace can be a convenient way to share the workspace structure with others without sharing the entire workspace codespace.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ws-file"><a class="link" href="#ws-file">Referencing a Saved Workspace Structure</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>To load a workspace structure from a file, specify the <code>ws-file</code> argument, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info ws-file:ws.edn</code></pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll see the same output as if you executed <code>poly info</code> from the machine that created <code>ws.edn</code>.</p>
</div>
<div class="paragraph">
<p>You can run all commands with <code>ws-file</code> except <a href="#create">create</a> and <a href="#test">test</a>.</p>
</div>
<div class="paragraph">
<p>To inspect the arguments used to produce the file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:old:user-input:args ws-file:ws.edn</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">["ws" "out:ws.edn"]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_referencing_a_workspace_in_another_dir"><a class="link" href="#_referencing_a_workspace_in_another_dir">Referencing a Workspace in Another Dir</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Similar to <a href="#ws-file">ws-file</a> is the <code>ws-dir</code> argument.</p>
</div>
<div class="paragraph">
<p>It allows you to explore workspaces in other directories.
Like <code>ws-file</code>, you can run all commands with <code>ws-dir</code> except <a href="#create">create</a> and <a href="#test">test</a>.</p>
</div>
<div class="paragraph">
<p>Assuming you have a workspace in <code>../local-dep</code>, you could check it from your current directory like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly check ws-dir:../local-dep</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_polyx"><a class="link" href="#_polyx">Polyx</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_polyx_2" class="sect0"><a class="link" href="#_polyx_2">Polyx</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>The <code>polyx</code> tool is the same as <code>poly</code> with one extra trick: it can output images for some commands.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The features and interface of this tool are subject to change.
A future release may expose its functionality in some different way.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We created the <code>polyx</code> tool separate from <code>poly</code> because:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>There have been reports of issues with Apple Silicon when using <a href="https://en.wikipedia.org/wiki/Abstract_Window_Toolkit">Java AWT</a> used by the underlying <a href="https://github.com/Clojure2D/clojure2d">Clojure2d</a> library used by <code>polyx</code> to output images.</p>
</li>
<li>
<p>Java AWT starts a Java process:</p>
<div class="paragraph">
<p><span class="image"><img src="images/polyx/java.png" alt="java"></span><br></p>
</div>
<div class="paragraph">
<p>which is not ideal for a command line tool.</p>
</div>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_install_via_polyx_alias"><a class="link" href="#_install_via_polyx_alias">Install via <code>:polyx</code> alias</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Unlike <code>poly</code>, we have no AOT-compiled <code>polyx</code> jar for you to download.
If you want to use <code>polyx</code>, add it as an alias to your <code>./deps.edn</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">:polyx {:main-opts ["-m" "polylith.clj.core.poly-cli.core"]
        :extra-deps {polyfy/polylith
                     {:git/url   "https://github.com/polyfy/polylith"
                      :sha       "9e79264981b0c5be6e6cb70c93a540a82c489510" <i class="conum" data-value="1"></i><b>(1)</b>
                      :deps/root "projects/polyx"}}}}}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Choose the revision via a Git SHA</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_finding_your_git_sha"><a class="link" href="#_finding_your_git_sha">Finding your Git SHA</a></h3>
<div class="sect3">
<h4 id="_stable"><a class="link" href="#_stable">Stable</a></h4>
<div class="paragraph">
<p>For the <code>sha</code> of the latest stable release, navigate to <a href="https://github.com/polyfy/polylith/releases/latest" class="bare">https://github.com/polyfy/polylith/releases/latest</a> (versions will differ from images below, but the page layout should be the same):</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>click on the tag:<br>
<span class="image"><img src="images/polyx/github-click-tag.png" alt="github click tag"></span></p>
</li>
<li>
<p>click on commits:<br>
<span class="image"><img src="images/polyx/github-click-commits.png" alt="github click commits"></span></p>
</li>
<li>
<p>and finally copy the full sha:<br>
<span class="image"><img src="images/polyx/github-copy-full-sha.png" alt="github copy full sha"></span></p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_snapshot"><a class="link" href="#_snapshot">SNAPSHOT</a></h4>
<div class="paragraph">
<p>For the latest <code>SNAPSHOT</code> release, navigate to <a href="https://github.com/polyfy/polylith" class="bare">https://github.com/polyfy/polylith</a>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>click on commits (as above)</p>
</li>
<li>
<p>and copy the full sha (as above)</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_from_command_line"><a class="link" href="#_from_command_line">From Command Line</a></h4>
<div class="paragraph">
<p>Or, if you prefer the command line, this should give you the data you need:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">git ls-remote --tags --refs --sort=-version:refname \
    https://github.com/polyfy/polylith.git</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using"><a class="link" href="#_using">Using</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Start a <a href="#">shell</a> from the <code>example</code> workspace root dir:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">clojure -M:polyx</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>polyx</code> tool can create output images for <a href="#info">info</a>, <a href="#deps">deps</a>, <a href="#libs">libs</a>, and <a href="#overview">overview</a> commands.
Let&#8217;s create an output image from <code>info</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example$ info out:info.png</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/polyx/output/info.png" alt="info" width="400">
</div>
</div>
<div id="transparent" class="paragraph">
<p>If you need a transparent background, which can be useful if you are going to use the image graphically, e.g. on a website or to print a T-shirt, you can pass in <code>:transparent</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example$ deps out:deps.png :transparent</code></pre>
</div>
</div>
<div class="paragraph">
<p>Set the color mode to <code>light</code> if you want a white background:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example$ info color-mode:light out:info.png</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/colors/output/info-light.png" alt="info light" width="400">
</div>
</div>
<div class="paragraph">
<p>Most people typically create <code>.png</code> images, but you can choose <a href="https://clojure2d.github.io/clojure2d/docs/codox/clojure2d.core.html#var-img-writer-formats">any image format Clojure2d supports</a>.</p>
</div>
<div class="paragraph">
<p>If you choose any other filename extension, e.g., <code>.txt</code>, <code>polyx</code> will output text:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example$ poly info out:info.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output contains ANSI escape codes to colorize the text.
If you <code>cat info.txt</code> you&#8217;ll see colorful output:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/polyx/output/info.png" alt="info" width="400">
</div>
</div>
<div class="paragraph">
<p>ANSI escape codes are not appropriate for some usages.
Specify <code>color-mode:none</code> for plaintext output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example$ info out:info.txt color-mode:none</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">  stable since: c91fdad

  projects: 2   interfaces: 1
  bases:    1   components: 1

  project         alias  status   dev
  -----------------------------   ---
  command-line *  cl      ---     ---
  development *   dev     s--     s--

  interface  brick    cl    dev
  -----------------   ---   ---
  user       user *   stx   st-
  -          cli *    stx   st-</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_the_overview_command"><a class="link" href="#_the_overview_command">The <code>overview</code> Command</a></h3>
<div class="paragraph">
<p>The <code>polyx</code> tool includes an <a href="#overview">overview</a> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">example$ overview out:overview.png :no-changes</code></pre>
</div>
</div>
<div class="paragraph">
<p>Generates:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/polyx/output/overview.png" alt="overview">
</div>
</div>
<div class="paragraph">
<p>For some real world examples of overview images see <a href="#">Example Systems</a> and <a href="#">Production Systems</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_naming"><a class="link" href="#_naming">Naming</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_naming_2" class="sect0"><a class="link" href="#_naming_2">Naming</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="quoteblock">
<blockquote>
There are two hard things in computer science: cache invalidation, naming things, and off-by-one errors.
</blockquote>
<div class="attribution">
&#8212; Phil Karlton (extended)
</div>
</div>
<div class="paragraph">
<p>Every <a href="#">interface</a>, <a href="#">component</a>, <a href="#">base</a>, <a href="#">project</a>, and <a href="#">workspace</a> needs a name.
Finding good names is both important and challenging.
When we fail to find good names, our systems are harder to reason about and change.</p>
</div>
<div class="paragraph">
<p><a href="components.html">Components</a> are the core of Polylith, so let&#8217;s start with them.
If a component does <em>one thing</em>,  consider basing its name on the one action it fulfills, e.g., <code>validator</code>, <code>invoicer</code>, or <code>purchaser</code>.
A component sometimes operates around a concept or noun, e.g., <code>account</code> or <code>car</code>.
This can be an alternative if the component does multiple things, but still ties it to a single concept.</p>
</div>
<div class="paragraph">
<p>If a component&#8217;s main responsibility is to simplify access to a third-party API, consider suffixing it with <code class="nowrap">-api</code>, e.g., <code>foobarcorp-api</code>.
When using a well-known cloud service like <a href="https://aws.amazon.com/">AWS</a>, consider dropping the <code>-api</code> suffix and using plain service names, like <code>s3</code>, <code>dynamodb</code>, and <code>cloudwatch</code>, or group them with a vendor prefix: <code>aws-s3</code>, <code>aws-dynamodb</code>, <code>aws-cloudwatch</code>.
Grouping can work nicely for output from commands like <a href="#info">info</a> and <a href="#deps">deps</a>.</p>
</div>
<div class="paragraph">
<p>When you have found a good name for a component, we recommend you use the same name for its interface.
The <code>poly</code> tool does this by default when you create a component:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly create component name:invoicer</code></pre>
</div>
</div>
<div class="paragraph">
<p>Is equivalent to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly create component name:invoicer interface:invoicer</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you have two components that use the <a href="#one-interface-in-multiple-components">same interface</a> where one is responsible for the business logic and the other is simply a delegator to that business logic, consider a naming scheme of, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>invoicer</code> for interface name</p>
</li>
<li>
<p><code>invoicer</code> for business logic component</p>
</li>
<li>
<p><code>invoicer-remote</code> for the component that delegates to the <code>invoicer</code> component</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#">Bases</a> are responsible for exposing a public API and delegating incoming calls to components.
Consider naming them after what they do, followed by the type of the API.
For example, if you have a REST API that takes care of invoicing, consider <code>invoicer-rest-api</code>.
For a lambda function that generates different reports, consider <code>report-generator-lambda</code>.</p>
</div>
<div class="paragraph">
<p><a href="#">Deployable projects</a> represent your deployable artifacts.
Consider naming services after what they do, like <code>invoicer</code> or <code>report-generator</code>.
A tool might do many things and therefore deserve a more generic name, like, for a great example, <code>poly</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_git_hooks"><a class="link" href="#_git_hooks">Git Hooks</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_git_hook" class="sect0"><a class="link" href="#_git_hook">Git Hook</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>You can use <a href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks">git hooks</a> to have Git invoke custom scripts for specific Git events.</p>
</div>
<div class="paragraph">
<p>Some folks add a <code>commit-msg</code> hook to have Git automatically run the <code>poly</code> <a href="#check">check</a> command to <a href="#">validate</a> their workspace on <a href="https://git-scm.com/docs/git-commit">git commit</a>.
If the <code>poly check</code> fails, the <code>git commit</code> is aborted.</p>
</div>
<div class="paragraph">
<p>From your workspace root directory, you&#8217;d add an executable <code>./git/hooks/commit-msg</code> script, something like the following would work on macOS or Linux:</p>
</div>
<div class="listingblock">
<div class="title">./git/hooks/commit-msg</div>
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#!/usr/bin/env bash

set -eou pipefail

clojure -M:poly check color-mode:none</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Don&#8217;t forget to <code>chmod +x ./get/hooks/commit-msg</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Client-side git hooks are developer-specific and not tracked by <code>git</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Failing hooks can be mysterious when committing from an IDE.
If the commit hook fails, the commit will fail, but you might not get a meaningful message as to why.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The example git hook script above invokes <code>poly</code> via the <code>:poly</code> alias.
For better performance, you might explore having your git hook script invoke <a href="#">poly as a stand-alone AOT-compiled jar</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_colors"><a class="link" href="#_colors">Colors</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_colors_2" class="sect0"><a class="link" href="#_colors_2">Colors</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>The <code>poly</code> tool uses color to make its output easier to digest.
The Dark column shows the colors used in all the examples, while Light is the colors used by <a href="#">polyx</a> when <code>color-mode</code> is set to <code>light</code>.</p>
</div>
<table id="color-schemas" class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top"><span class="nowrap">ANSI Color</span></th>
<th class="tableblock halign-left valign-top">Dark</th>
<th class="tableblock halign-left valign-top">Light</th>
<th class="tableblock halign-left valign-top">Example <code>poly</code> Usages</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">yellow</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ESC[33m</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="images/colors/dark/yellow.png" alt="yellow" width="65"></span><br>
<span class="nowrap"><code>#f8eeb6</code></span></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="images/colors/light/yellow.png" alt="yellow" width="65"></span><br>
<span class="nowrap"><code>#977f2a</code></span></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">interfaces, warning messages</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">green</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ESC[32m</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="images/colors/dark/green.png" alt="green" width="65"></span><br>
<code class="nowrap">#bfefc5</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="images/colors/light/green.png" alt="green" width="65"></span><br>
<code class="nowrap">#2c9d3a</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">components, success messages</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">blue</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ESC[34m</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="images/colors/dark/blue.png" alt="blue" width="65"></span><br>
<code class="nowrap">#77bcfc</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="images/colors/light/blue.png" alt="blue" width="65"></span><br>
<code class="nowrap">#2c68a1</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bases</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">purple</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ESC[35m</code><br>
(magenta)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="images/colors/dark/purple.png" alt="purple" width="65"></span><br>
<code class="nowrap">#e2aeff</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="images/colors/light/purple.png" alt="purple" width="65"></span><br>
<code class="nowrap">#8e58ad</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">projects</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">red</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ESC[31m</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="images/colors/dark/red.png" alt="red" width="65"></span><br>
<code class="nowrap">#ee9b9a</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="images/colors/light/red.png" alt="red" width="65"></span><br>
<code class="nowrap">#ee9b9a</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">error messages</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">light grey</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ESC[37m</code><br>
(white)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="images/colors/dark/grey-light.png" alt="grey light" width="65"></span><br>
<code class="nowrap">#cccccc</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="images/colors/light/grey-light.png" alt="grey light" width="65"></span><br>
<code class="nowrap">#787878</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tags and shas (dark mode)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dark grey</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ESC[90m</code><br>
(bright black)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tags and shas (light mode)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">white (background)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ESC[40m</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="images/colors/light/white.png" alt="white" width="65"></span><br>
<code class="nowrap">#ffffff</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used as background color by <a href="#">polyx</a> when <code>color-mode</code> is set to <code>light</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">black (background)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ESC[40m</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="images/colors/dark/black.png" alt="black" width="65"></span><br>
<code class="nowrap">#24272b</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used as background color by <a href="#">polyx</a> when <code>color-mode</code> is set to <code>dark</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Your OS terminal shell and its color theme configuration can redefine these colors.
If you want to match our dark scheme preference (inspired by the <a href="https://github.com/Misophistful/borealis-cursive-theme">Cursive Borealis color scheme</a>), configure your terminal to use the sample colors from the table above.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="config"><a class="link" href="#config">Config</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you create your first <a href="#">workspace</a>, <code>poly</code> creates a <a href="#color-mode">user config file</a> that specifies a <code>color-mode</code>:</p>
</div>
<div class="listingblock">
<div class="title">~/.config/polylith/config.edn</div>
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:color-mode "dark" <i class="conum" data-value="1"></i><b>(1)</b>
 :thousand-separator ","
 :empty-character ""}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>poly</code> tool sets the initial value to <code>"dark"</code> on macOS and Linux and to <code>"none"</code> on Windows.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Valid <code>color-mode</code> values are <code>"none"</code>, <code>"light"</code>, and <code>"dark"</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We don&#8217;t support colored text on Windows, so <code>poly</code> sets the initial <code>:color-mode</code> on Windows to <code>"none"</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you use a light theme for your OS terminal shell, consider switching <code>:color-mode</code> to <code>"light"</code>.
The only difference between <code>"light"</code> and <code>"dark"</code> is very subtle; they use different <a href="/components/util/src/polylith/clj/core/util/colors.clj#L3-L13">shades of grey</a>.
The shade of grey in the <code>"light"</code> mode can show up better when using a light theme in your OS terminal shell.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_usage"><a class="link" href="#_usage">Usage</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Throughout our documentation, our screenshots show output from an OS terminal shell configured with a dark theme with <code>:color-mode</code> left at its default <code>"dark"</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">poly info</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/colors/output/info-dark.png" alt="info dark" width="450">
</div>
</div>
<div class="paragraph">
<p>When you can specify <code>color-mode</code> as an argument, it will override your <code>poly</code> <a href="#config">config</a>.
Assuming you&#8217;ve configured your OS terminal shell to a light color scheme, you might want to tell <code>poly</code> to use <code>color-mode:light</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">poly info color-mode:light</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/colors/output/info-light.png" alt="info light" width="450">
</div>
</div>
<div class="paragraph">
<p>When you specify a <code>color-mode</code> of <code>none</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">poly info color-mode:none</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>poly</code> tool will emit uncolored plaintext:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  stable since: 65957ce | stable-lisa

  projects: 3   interfaces: 1
  bases:    2   components: 2

  active profiles: default

  project         alias   status   dev  remote
  ------------------------------   -----------
  command-line *  cl       -t-     -t-    --
  user-service *  user-s   ---     ---    --
  development *   dev      s--     s--    --

  interface  brick           cl   user-s   dev  remote
  ------------------------   -----------   -----------
  user       user *          ---   stx     st-    --
  user       user-remote *   stx   ---     ---    st
  -          cli *           stx   ---     st-    --
  -          user-api *      ---   stx     st-    --</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_developing_polylith"><a class="link" href="#_developing_polylith">Developing Polylith</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_developing_poly" class="sect0"><a class="link" href="#_developing_poly">Developing poly</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>The curious are most welcome, but we wrote this document for folks who are (or want to) contribute to the development <code>poly</code> itself.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contributing"><a class="link" href="#_contributing">Contributing</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>We very much appreciate contributions from the community.</p>
</div>
<div class="sect2">
<h3 id="_issues_first_please"><a class="link" href="#_issues_first_please">Issues First Please</a></h3>
<div class="paragraph">
<p>If you have an idea or a fix, please do raise a GitHub issue before investing in any coding effort.
That way, we can discuss first.
Writing code is the easy part; maintaining it forever is the hard part!</p>
</div>
<div class="paragraph">
<p>That said, if you notice a simple typo, a PR without an issue is fine.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
We are also happy to chat about your idea or fix on the Clojurians <a href="https://clojurians.slack.com/messages/C013B7MQHJQ">polylith</a> channel.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_include_tests_and_docs"><a class="link" href="#_include_tests_and_docs">Include Tests and Docs</a></h3>
<div class="paragraph">
<p>We expect you to include/update tests for your change.</p>
</div>
<div class="paragraph">
<p>You&#8217;ve probably gotten the sense that providing good docs for our users is important to us.
When your change affects our docs or needs to be described for our users, we expect you to do so.</p>
</div>
<div class="paragraph">
<p>Add a brief line summarizing your change to <a href="/next-release.adoc">next-release.adoc</a>.
The <code>poly</code> core team moves the content in this file to the changelog for each stable <a href="https://github.com/polyfy/polylith/releases">release</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_submitting_a_pull_request"><a class="link" href="#_submitting_a_pull_request">Submitting a Pull Request</a></h3>
<div class="paragraph">
<p>Please never force push on your PR, as this makes reviewing incremental changes impossible for us.
When we merge your PR, we&#8217;ll usually squash it, so that will clean up any rambling work-in-progress.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_special_poly_arguments"><a class="link" href="#_special_poly_arguments">Special <code>poly</code> Arguments</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some <code>poly</code> arguments are special-case or <code>poly</code> developer-focused.
For this reason, the <a href="#shell">shell</a> will not include these arguments in its autocomplete suggestions <a href="#all-shell">by default</a>.</p>
</div>
<div class="paragraph">
<p>Most special arguments tweak the output of the various <code>poly</code> commands.</p>
</div>
<div class="sect2">
<h3 id="all-shell"><a class="link" href="#all-shell"><code>all</code> - <code>shell</code></a></h3>
<div class="paragraph">
<p>By default, the <a href="#shell">shell</a> does not suggest special <code>poly</code> arguments because they are irrelevant and inappropriate for typical users of <code>poly</code>.
If you are developing <code>poly</code> itself, suggesting special <code>poly</code> arguments can be appropriate and meaningful.
To start a shell with autocomplete suggestions enabled for all <code>poly</code> arguments:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly :all</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_changed_files"><a class="link" href="#_changed_files"><code>changed-files</code></a></h3>
<div class="paragraph">
<p>Have <code>poly</code> react as if specified files have changed.
We use this to support testing <code>poly</code> itself.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info changed-files:components/file/src/polylith/clj/core/file/core.clj</code></pre>
</div>
</div>
<div class="paragraph">
<p>More than one file can be faked as changed by separating them with colons.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Although multiple files are supported, the <code>shell</code> autocomplete support works only for the first file.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Specify a brick or project path with a trailing forward slash, and <code>poly</code> will treat the brick or project as changed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info changed-files:bases/mybase/:components/mycomponent/:projects/myproject/</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fake_sha"><a class="link" href="#_fake_sha"><code>fake-sha</code></a></h3>
<div class="paragraph">
<p>Fake the Git <code>sha</code> output by the <a href="#info">info</a> command.
We use this to generate consistent <code>info</code> output and screenshots for our documentation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info fake-sha:c91fdad</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fake_tag"><a class="link" href="#_fake_tag"><code>fake-tag</code></a></h3>
<div class="paragraph">
<p>Fake the Git <code>tag</code> for output by the <a href="#info">info</a> command.
We sometimes use this to generate consistent <code>info</code> output and screenshots for our documentation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info fake-tag:stable-lisa</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want no Git <code>tag</code> to be shown in <code>info</code> output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info fake-tag:</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fake_poly"><a class="link" href="#_fake_poly"><code>fake-poly</code></a></h3>
<div class="paragraph">
<p>Fake that you are using a stable production release of <code>poly</code> when you might actually be using a <code>SNAPSHOT</code> release, <code>polyx</code>, or both.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly help :fake-poly <i class="conum" data-value="1"></i><b>(1)</b>
polyx :fake-poly <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Excludes <code>-SNAPSHOT</code> from the version at the top of the help output</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Shows <code>poly</code> instead of <code>polyx</code> and excludes <code>-SNAPSHOT</code> from the Polylith ASCII art logo</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This can be handy when capturing output for docs.</p>
</div>
</div>
<div class="sect2">
<h3 id="_hide_lib_size"><a class="link" href="#_hide_lib_size"><code>hide-lib-size</code></a></h3>
<div class="paragraph">
<p>If <code>:hide-lib-size</code> is given to the <a href="#libs">libs</a> command, values in the <code>KB</code> column appear as <code>-</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly libs :hide-lib-size <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is used in tests to guarantee that the output will look the same, regardless if a library has been downloaded or not.</p>
</div>
</div>
<div class="sect2">
<h3 id="_latest_sha"><a class="link" href="#_latest_sha"><code>latest-sha</code></a></h3>
<div class="paragraph">
<p>Populate the <code>latest-sha</code> from your Git repository in your workspace structure (by default, <code>poly</code> does not populate this value).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:settings:vcs:polylith:latest-sha :latest-sha</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_no_changes"><a class="link" href="#_no_changes"><code>no-changes</code></a></h3>
<div class="paragraph">
<p>Fake that there are no changes to your workspace since the last <a href="#">stable point in time</a>; can be useful when generating output for docs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell"># Returns no rows:
poly diff :no-changes
# Gets rid of the * characters:
poly info :no-changes
# ...has the same effect as:
poly info changed-files:</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_no_exit"><a class="link" href="#_no_exit"><code>no-exit</code></a></h3>
<div class="paragraph">
<p>By default, <code>poly</code> explicitly exits via <code>System/exit</code> .
If executing <code>poly</code> from a REPL, this will also exit the REPL, which probably isn&#8217;t what you want.
To avoid that, specify <code>:no-exit</code>.</p>
</div>
<div class="paragraph">
<p>See <a href="/bases/poly-cli/src/polylith/clj/core/poly_cli/core.clj">poly-cli source</a> <code>comment</code> block for plenty of examples.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Outside of REPL support, <code>:no-exit</code> has little use.
If you run, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly info :no-exit</code></pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll have to press kbd:[Ctrl+C] to exit!</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_replace"><a class="link" href="#_replace"><code>replace</code></a></h3>
<div class="paragraph">
<p>Manipulate output from the <a href="#ws">ws</a> command.</p>
</div>
<div class="paragraph">
<p>You can tell the <code>ws</code> command to search for strings (using regular expressions) and replace the occurrences with another string.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:settings:user-home</code></pre>
</div>
</div>
<div class="paragraph">
<p>On Joakim&#8217;s system, output is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">"/Users/joakimtengstrand"</code></pre>
</div>
</div>
<div class="paragraph">
<p>But maybe we want some repeatable output for test or documentation purposes, regardless of which user is running the <code>ws</code>.
Assuming that your <code>HOME</code> environment variable is set appropriately and that you are running from your OS shell (not poly&#8217;s <code>shell</code>):</p>
</div>
<div class="paragraph">
<p><strong>An example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:settings:user-home replace:$HOME:MY-HOME</code></pre>
</div>
</div>
<div class="paragraph">
<p>Outputs a user-generic:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">"MY-HOME"</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Another example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:settings:user-config-filename replace:$HOME:MY-HOME</code></pre>
</div>
</div>
<div class="paragraph">
<p>Outputs a user-generic:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">"MY-HOME/.polylith/config.edn"</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>An example with multiple replacements:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:settings:user-config-filename replace:$HOME:MY-HOME:config.edn:USER-CONFIG</code></pre>
</div>
</div>
<div class="paragraph">
<p>Outputs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">"MY-HOME/.polylith/USER-CONFIG"</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Sometimes you need to deal with your OS shell escaping rules and add, for example, <code>""</code>.</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:settings:vcs:stable-since:sha replace:"[0-9]+":"*"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output will vary because git shas are unique, but on Joakim&#8217;s system once:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">"*e*d*b*cee*fb*e*ff*fafcf"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_documentation_2"><a class="link" href="#_documentation_2">Documentation</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>We strive to write great documentation for our Polylith users.</p>
</div>
<div class="paragraph">
<p><a href="https://asciidoctor.org/docs/what-is-asciidoc/#what-is-asciidoc">AsciiDoc</a> is thoughtfully designed for writing articles; we like that, so all of our articles are written in AsciiDoc.</p>
</div>
<div class="paragraph">
<p>Some conventions we have found helpful are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Write one sentence per line.
Among other <a href="https://asciidoctor.org/docs/asciidoc-recommended-practices/#one-sentence-per-line">things</a>, this helps us to avoid run-on sentences.</p>
</li>
<li>
<p>These particular docs cover an implementation of a Polylith tool, so use the concrete <code>poly</code> instead of the abstract "Polylith tool".</p>
</li>
<li>
<p>For command-line <code>poly create workspace top-ns:my-ns branch:my-branch :commit</code> refer to:</p>
<div class="ulist">
<ul>
<li>
<p><code>create workspace</code> as a command</p>
</li>
<li>
<p><code>top-ns:my-ns</code>, <code>branch:my-branch</code> and <code>:commit</code> as arguments</p>
</li>
</ul>
</div>
</li>
<li>
<p>Link to referenced commands and concepts to make it easier for readers to explore and dig into details.</p>
</li>
<li>
<p>Use the <a href="https://docs.asciidoctor.org/asciidoc/latest/macros/keyboard-macro/">AsciiDoc keyboard macro</a> for keyboard shortcuts.
For an example usage, see <a href="#quit">Shell page</a>.</p>
</li>
<li>
<p>Use "we" when talking from the Polylith core team and "you" when directing the reader through some steps or a tutorial.</p>
</li>
<li>
<p>Try to maintain a casual and friendly tone.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_diagrams"><a class="link" href="#_diagrams">Diagrams</a></h3>
<div class="paragraph">
<p>We create our diagrams with the ever-so-awesome <a href="https://inkscape.org/">Inkscape</a>.
Inkscape&#8217;s native format is <code>.svg</code>.
We export to <code>.png</code> for use in our documentation.
We keep the source <code>.svg</code> beside the exported <code>.png</code> in our GitHub repo.</p>
</div>
<div class="paragraph">
<p>We store doc images under <code>./images/</code>, for example for the overview diagram in <a href="/doc/doc.html">./doc/doc.adoc</a> doc:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Inkscape source: <a href="/images/doc/doc-overview.svg">./images/doc/doc-overview.svg</a></p>
</li>
<li>
<p>Exported png: <a href="/images/doc/doc-overview.png">./images/doc/doc-overview.png</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Generated images (currently from <code>bb create-example</code> via <code>polyx</code>) are grouped with their related images but are prefixed with an <code>output</code> dir.
This strategy helps us distinguish hand-crafted images from generated ones and reminds us not to edit images in the <code>output</code> dirs.</p>
</div>
<div class="paragraph">
<p>Sometimes, we&#8217;ll annotate a generated image.
We do so via an Inkscape SVG file and link (rather than embed) the generated image.
As of this writing, if any of these images change, the <code>.svg</code> will have to be manually re-exported to its <code>.png</code>.</p>
</div>
<div class="paragraph">
<p>Tips:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use a transparent background.</p>
</li>
<li>
<p>We host our docs on <a href="https://cljdoc.org">cljdoc</a>, which uses a light theme.
Folks viewing our docs on GitHub might have opted for a dark theme, so choose colors that will also be dark-theme friendly.</p>
</li>
<li>
<p>Choose cross-platform-friendly fonts.
<code>Courier New</code> and <code>Arial</code> seem to be what existing diagrams use.
If you are a Linux user, you can install these as part of Microsoft&#8217;s fonts.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_cljdoc"><a class="link" href="#_cljdoc">Cljdoc</a></h3>
<div class="paragraph">
<p>We host our docs on <a href="https://cljdoc.org/d/polylith/clj-poly">cljdoc</a>, which generates docs for our:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>API by analyzing our source code from our release jar</p>
</li>
<li>
<p>pages (which cljdoc calls "articles") which cljdoc finds under <a href="/doc">doc</a>, and whose layout is defined by <a href="/doc/cljdoc.edn">doc/cljdoc.edn</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We have cljdoc build our docs each time we release to clojars.
This includes <code>SNAPSHOT</code> releases, which we create for every successful push to <code>master</code>.
See <a href="#releases">Polylith CI Setup</a> for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="local-cljdoc"><a class="link" href="#local-cljdoc">Previewing Cljdoc Locally</a></h3>
<div class="paragraph">
<p>When making changes to docs, you can preview what they will look like on <a href="https://cljdoc.org">cljdoc</a>.
If you have not already done so, clone the <a href="https://github.com/polyfy/polylith">polylith</a> repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">git clone git@github.com:polyfy/polylith.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Take a look at the help for our babashka <code>doc-preview</code> task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ cd polylith
$ bb doc-preview help

Commands:
 start   Start docker containers supporting cljdoc preview
 ingest  Locally publishes poly for cljdoc preview
 view    Opens cljdoc preview in your default browser
 stop    Stops docker containers supporting cljdoc preview
 status  Status of docker containers supporting cljdoc preview
 help    Show this help</code></pre>
</div>
</div>
<div class="paragraph">
<p>Start the server and publish the documentation locally (the first <code>start</code> will take some time to download the cljdoc docker image, and <code>ingest</code> is on the slow side):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ bb doc-preview start
$ bb doc-preview ingest</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Commit and push all your changes before you <code>ingest</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Bring the docs up in your web browser with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>bb doc-preview view</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="local"><a class="link" href="#local">Poly Shell and Local Cljdoc</a></h3>
<div class="paragraph">
<p>If you are in the <code>polylith</code> workspace root directory (which is also the git repo root dir), you can start a <a href="#shell">shell</a> specifying the <code>:local</code> argument to tell the <a href="#doc">doc</a> command to open pages on <code>https://localhost:8000</code> instead of <code>https://cljdoc.org</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">clojure -M:poly :local</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now docs open in your browser against the <a href="#local-cljdoc">locally running cljdoc</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">polylith$ doc page:component</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_refreshing_local_cljdoc_preview"><a class="link" href="#_refreshing_local_cljdoc_preview">Refreshing Local Cljdoc Preview</a></h3>
<div class="paragraph">
<p>From time to time, there is a new release of cljdoc.
To pick it up:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">bb doc-preview stop
bb doc-preview start</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you&#8217;ve changed the polylith codebase, you need to run <code>ingest</code> again (no need to <code>stop</code> and <code>start</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">bb doc-preview ingest</code></pre>
</div>
</div>
<div class="paragraph">
<p>Examples of when you might want to <code>ingest</code> are when you have:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Switched to a different git branch.</p>
</li>
<li>
<p>Pulled changes down with <code>git pull</code>.</p>
</li>
<li>
<p>Pushed commits with <code>git push</code>.
You must commit and push your changes for <code>ingest</code> to function; doing so from a branch is fine.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_open_page_source_in_github"><a class="link" href="#_open_page_source_in_github">Open Page Source in GitHub</a></h3>
<div class="paragraph">
<p>Fire up a <a href="#shell">shell</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">clojure -M:poly :local</code></pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>In addition to <a href="#local">opening pages locally instead of on cljdoc.org</a>, the <code>:local</code> argument also enables, for convenience, <code>shell</code> autocompletion for the <code>:github</code> argument.
Feel free to also specify <a href="#all-shell">:all</a>.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Specify the <code>:github</code> argument to bring up the page in your web browser on GitHub:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">polylith$ doc page:component :github</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you started your shell from the <code>polylith</code> repository (not a fork), then pages will automatically be opened in your current working branch; otherwise, pages will open on the <code>master</code> branch.</p>
</div>
<div class="paragraph">
<p>To choose a specific <code>branch</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">polylith$ doc page:component branch:issue-318 :github</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you aren&#8217;t running cljdoc locally, you may want to always open pages on GitHub instead of cljdoc; specify the <code>:github</code> argument when starting a shell:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">clojure -M:poly :github
polylith$ doc page:component</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_referencing_a_local_poly"><a class="link" href="#_referencing_a_local_poly">Referencing a Local <code>poly</code></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>So long as you&#8217;ve cloned the <code>polylith</code> workspace locally, you can access it from other workspaces.
This can be convenient when testing another workspace but wanting to use a local <code>polylith</code> that has some work in progress.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s say you have cloned the <a href="https://github.com/furkan3ayraktar/clojure-polylith-realworld-example-app">Realworld example app</a> as a sibling to the <code>polylith</code> repo in your directory tree.</p>
</div>
<div class="paragraph">
<p>You could then replace the <code>:poly</code> alias in <code>clojure-polylith-realworld-example-app/deps.edn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">    ...
    :poly {:main-opts ["-m" "polylith.clj.core.poly-cli.core"]
           :extra-deps {polylith/clj-poly {:local/root "../polylith/projects/poly"}}} <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Notice the <code>..</code> relative path to <code>poly</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>And now, from the <code>clojure-polylith-realworld-example-app</code> dir, you can launch local <code>poly</code> via, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">clojure -M:poly</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_snapshot_releases_caching"><a class="link" href="#_snapshot_releases_caching">SNAPSHOT Releases &amp; Caching</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://github.com/clojure/tools.deps">Clojure tools.deps</a> only checks for updates once per day by default.</p>
</div>
<div class="paragraph">
<p>This caching behavior means users referencing a specific <code>SNAPSHOT</code> will be more likely to temporarily be on an older release if you frequently release under the same <code>SNAPSHOT</code> version.</p>
</div>
<div class="paragraph">
<p>Users can <a href="https://clojure.org/reference/deps_and_cli#_classpath_caching">-Sforce</a> a check for an update, but most probably won&#8217;t think to do that.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="visualize-repo"><a class="link" href="#visualize-repo">Visualize the repo</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use <a href="https://gource.io">Gource</a> to visualize how the code has evolved over time.</p>
</div>
<div class="paragraph">
<p>Here is an example animation:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://youtu.be/cfVzy9iPpLg"><img src="images/developing-polylith/polylith-git-repo-animation.png" alt="polylith git repo animation"></a>
</div>
</div>
<div class="sect2">
<h3 id="_install_3"><a class="link" href="#_install_3">Install</a></h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">brew install gource
brew install ffmpeg</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_generate"><a class="link" href="#_generate">Generate</a></h3>
<div class="paragraph">
<p>This will generate a <code>polylith.mp4</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">gource --seconds-per-day 0.2 --auto-skip-seconds 1 --max-file-lag 0.1 --background 9dabcb --logo images/developing-polylith/logo.png --disable-bloom --font-size 18 --font-colour 566ca1 --hide filenames --date-format "%d %B %Y" --dir-colour eeeeee --dir-name-depth 2 --caption-colour ff0000 --dir-font-size 12 -o - | ffmpeg -y -r 60 -f image2pipe -vcodec ppm -i - -vcodec libx264 -preset ultrafast -pix_fmt yuv420p -crf 1 -threads 0 -bf 0 polylith2.mp4</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also experiment without generating a file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">gource --seconds-per-day 0.2 \
       --auto-skip-seconds 1 \
       --max-file-lag 0.1 \
       --background 9dabcb \
       --logo images/developing-polylith/logo.png \
       --disable-bloom \
       --font-size 18 \
       --font-colour 566ca1 \
       --hide filenames \
       --date-format "%d %B %Y" \
       --dir-colour eeeeee \
       --dir-name-depth 2 \
       --caption-colour ff0000 \
       --dir-font-size 12</code></pre>
</div>
</div>
<div class="paragraph">
<p>See how to tweak the animation <a href="https://github.com/acaudwell/Gource/wiki/Controls">here</a>. All the options are listed <a href="https://github.com/acaudwell/Gource/blob/master/README.md#using-gource">here</a>, or execute <code>gource --help</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="create-a-snapshot-release"><a class="link" href="#create-a-snapshot-release">Create a snapshot release</a></h3>
<div class="paragraph">
<p>Run all the tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly test :all</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you have made a lot of changes, run the <code>gen-all</code> script (this will take a few minutes):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">bb gen-all</code></pre>
</div>
</div>
<div class="paragraph">
<p>Compare the output with what&#8217;s in git, and commit the changes if everything looks good.</p>
</div>
<div class="paragraph">
<p>Make a <code>0.2.20-SNAPSHOT #34</code> release:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Update the <code>version</code> component and ensure that:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/polyfy/polylith/blob/87aeb2ce093f31449827fb19d189e4ad0f80859d/components/version/src/polylith/clj/core/version/interface.clj#L24-L26">version</a> is set to <code>0.2.20</code>.</p>
</li>
<li>
<p><a href="https://github.com/polyfy/polylith/blob/87aeb2ce093f31449827fb19d189e4ad0f80859d/components/version/src/polylith/clj/core/version/interface.clj#L27">revision</a> is set to <code>SNAPSHOT</code>.</p>
</li>
<li>
<p><a href="https://github.com/polyfy/polylith/blob/87aeb2ce093f31449827fb19d189e4ad0f80859d/components/version/src/polylith/clj/core/version/interface.clj#L28">snapshot</a> is set to <code>34</code>.</p>
</li>
<li>
<p><a href="https://github.com/polyfy/polylith/blob/87aeb2ce093f31449827fb19d189e4ad0f80859d/components/version/src/polylith/clj/core/version/interface.clj#L40">date</a> is set to today&#8217;s date (yyyy-mm-dd).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Ensure the versions are correctly specified in <code>readme.adoc</code>:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/polyfy/polylith/blob/87aeb2ce093f31449827fb19d189e4ad0f80859d/readme.adoc?plain=1#L2">snapshot-version</a> is set to <code>34</code>.</p>
</li>
<li>
<p><a href="https://github.com/polyfy/polylith/blob/87aeb2ce093f31449827fb19d189e4ad0f80859d/readme.adoc?plain=1#L5">Stable</a> is set to current stable version, <code>0.2.19</code>.</p>
</li>
<li>
<p><a href="https://github.com/polyfy/polylith/blob/87aeb2ce093f31449827fb19d189e4ad0f80859d/readme.adoc?plain=1#L7">Snapshot</a> version is set to <code>0.2.20-SNAPSHOT</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Commit and push your changes.</p>
</li>
<li>
<p>Go to the <a href="https://github.com/polyfy/polylith">polylith repo</a> and prepare to merge the <code>snapshot-022034</code> branch into <code>master</code>, by clicking the "Compare &amp; pull requests" button at the top.
If the <a href="https://app.circleci.com/pipelines/github/polyfy">circlci pipeline</a> is green, merge it into the <code>master</code> branch.</p>
</li>
<li>
<p>Execute <code>git switch master</code> followed by <code>git pull</code> to get the latest from <code>master</code>.</p>
</li>
<li>
<p>Execute (depending on what the next release should be):</p>
<div class="ulist">
<ul>
<li>
<p><code>git switch -c snapshot-022035</code> if the next release should be a <code>0.2.20-SNAPSHOT #35</code> snapshot release.</p>
</li>
<li>
<p><code>git switch -c release-0220</code> if the next release should be a <code>0.2.20</code> stable release.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="create-a-stable-release"><a class="link" href="#create-a-stable-release">Create a stable release</a></h3>
<div class="paragraph">
<p>In this example, we work with <code>0.2.20-SNAPSHOT #34</code> from the <code>snapshot-022034</code> branch, and want to create a <code>0.2.20</code> release out of it.</p>
</div>
<div class="paragraph">
<p>Run all the tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly test :all</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the <code>gen-all</code> script (this will take a few minutes):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">bb gen-all</code></pre>
</div>
</div>
<div class="paragraph">
<p>Compare the output with what&#8217;s in git, and commit and push the changes if everything looks good.</p>
</div>
<div class="paragraph">
<p>Create a <code>0.2.20-SNAPSHOT #34</code> release (if you refer to the release, make sure you separate # and 34 so that you don&#8217;t link to old issues and PRs).</p>
</div>
<div class="paragraph">
<p>Announce in good time in the <a href="https://clojurians.slack.com/archives/C013B7MQHJQ">polylith channel</a> in Slack, that people should start testing current SNAPSHOT version.
Also mention that there will only be minor changes until release, such as updating the documentation. Wait a few days before you make the new release.</p>
</div>
<div class="paragraph">
<p>Make a <code>0.2.20</code> release:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Execute <code>git switch master</code> followed by <code>git pull</code> to get the latest (you may need to stash local files first).</p>
</li>
<li>
<p>Create the release branch by executing <code>git switch -c release-0220</code>.</p>
</li>
<li>
<p>Update the <code>version</code> component and ensure that:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/polyfy/polylith/blob/87aeb2ce093f31449827fb19d189e4ad0f80859d/components/version/src/polylith/clj/core/version/interface.clj#L24-L26">version</a> is set to <code>0.2.20</code>.</p>
</li>
<li>
<p><a href="https://github.com/polyfy/polylith/blob/87aeb2ce093f31449827fb19d189e4ad0f80859d/components/version/src/polylith/clj/core/version/interface.clj#L27">revision</a> is set to <code>RELEASE</code>.</p>
</li>
<li>
<p><a href="https://github.com/polyfy/polylith/blob/87aeb2ce093f31449827fb19d189e4ad0f80859d/components/version/src/polylith/clj/core/version/interface.clj#L28">snapshot</a> is set to <code>0</code>.</p>
</li>
<li>
<p><a href="https://github.com/polyfy/polylith/blob/87aeb2ce093f31449827fb19d189e4ad0f80859d/components/version/src/polylith/clj/core/version/interface.clj#L40">date</a> is set to today&#8217;s date (yyyy-mm-dd).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Ensure the versions are correctly specified in <code>readme.adoc</code>:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/polyfy/polylith/blob/87aeb2ce093f31449827fb19d189e4ad0f80859d/readme.adoc?plain=1#L2">snapshot-version</a> is set to <code>0</code>.</p>
</li>
<li>
<p><a href="https://github.com/polyfy/polylith/blob/87aeb2ce093f31449827fb19d189e4ad0f80859d/readme.adoc?plain=1#L5">Stable</a> is set to current stable version, <code>0.2.20</code>.</p>
</li>
<li>
<p><a href="https://github.com/polyfy/polylith/blob/87aeb2ce093f31449827fb19d189e4ad0f80859d/readme.adoc?plain=1#L7">Snapshot</a> version is set to <code>0.2.20-SNAPSHOT</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Commit and push your changes.</p>
</li>
<li>
<p>Build a <a href="#local-cljdoc">local version</a> of Cljdoc:</p>
<div class="ulist">
<ul>
<li>
<p>Check that new content looks correct.</p>
</li>
<li>
<p>Check that the badges at the top and the API at the bottom left are displayed correctly (most namespaces should begin with a <code>^:no-doc</code> tag, to exclude them from the API doc).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Go to the <a href="https://github.com/polyfy/polylith">polylith repo</a> and prepare to merge the <code>release-0220</code> branch into <code>master</code>, by clicking the "Compare &amp; pull requests" button at the top.</p>
<div class="ulist">
<ul>
<li>
<p>Add a comment indicating that this is release 0.2.20.</p>
</li>
<li>
<p>If the <a href="https://app.circleci.com/pipelines/github/polyfy">circlci pipeline</a> is green, merge it into the <code>master</code> branch.</p>
</li>
<li>
<p>Ensure that the <a href="https://cljdoc.org/d/polylith/clj-poly/0.2.20/doc/readme">poly-clj</a> documentation has been built, and verify that the badges at the top and the API at the bottom left are displayed correctly.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Update the <a href="https://github.com/polyfy/polylith/releases/tag/v0.2.20">release notes</a> for the 0.2.20 release:</p>
<div class="ulist">
<ul>
<li>
<p>Summarize the release in the introduction.</p>
</li>
<li>
<p>Copy the content from <a href="https://github.com/polyfy/polylith/blob/v0.2.20/next-release.adoc">next-release.md</a> into the release notes.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Execute <code>git switch master</code> followed by <code>git pull</code> to get the latest from master.</p>
</li>
<li>
<p>Execute <code>git switch -c snapshot-032101</code> to create a first snapshot branch for the next release (here we imagine that the next release is 0.3.21).</p>
</li>
<li>
<p>Create a <code>0.3.21-SNAPSHOT #1</code> release, see <a href="#create-a-snapshot-release">make a snapshot release for instructions</a>.</p>
</li>
<li>
<p>Announce in <a href="https://clojurians.slack.com/archives/C015AL9QYH1">#releases</a> in clojurians in Slack, by summarizing the most important changes + the included issues and PRs.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ci"><a class="link" href="#_ci">CI</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_continuous_integration"><a class="link" href="#_continuous_integration">Continuous Integration</a></h3>

</div>
</div>
</div>
<h1 id="_continuous_integration_2" class="sect0"><a class="link" href="#_continuous_integration_2">Continuous Integration</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>The <code>poly</code> tool stays out of your way on how you <a href="#">build</a> your <a href="#">deployable project</a> <a href="#">artifacts</a> on your continuous integration server.</p>
</div>
<div class="paragraph">
<p>Here, we go over a couple of <a href="#release">tagging and release</a> strategies for you to consider.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_build_and_release_all"><a class="link" href="#_build_and_release_all">Build and Release All</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you don&#8217;t have many projects, you might want to build and deploy for all deployable projects:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run tests.</p>
</li>
<li>
<p>Git tag the release.</p>
</li>
<li>
<p>Build artifacts for all deployable projects.</p>
</li>
<li>
<p>Deploy all built artifacts.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_build_and_release_for_changed_projects_only"><a class="link" href="#_build_and_release_for_changed_projects_only">Build and Release for Changed Projects Only</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Perhaps you want to optimize your flow to only build and deploy what has changed:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run tests.</p>
</li>
<li>
<p>Ask <code>poly</code> what deployable projects have changed since the last release:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:changes:changed-or-affected-projects since:release skip:dev <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We <code>skip:dev</code> because it is not a deployable project</td>
</tr>
</table>
</div>
</li>
<li>
<p>Git tag the release.</p>
</li>
<li>
<p>Build artifacts for all <em>changed</em> deployable projects.</p>
</li>
<li>
<p>Deploy all built artifacts.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you were to swap steps 2 and 3, you would use <code>since:previous-release</code> instead of <code>since:release</code></p>
</div>
<div class="sect2">
<h3 id="_polylith_ci_setup"><a class="link" href="#_polylith_ci_setup">Polylith CI Setup</a></h3>

</div>
</div>
</div>
<h1 id="_the_polylith_ci_setup" class="sect0"><a class="link" href="#_the_polylith_ci_setup">The Polylith CI setup</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>The polylith repository has a continuous integration and deployment setup via <a href="https://circleci.com">CircleCI</a>.
The setup has a workflow for validation, testing, and deployment.
The workflow has several jobs that validate, test, and deploy the artifacts to <a href="https://clojars.org/search?q=polylith">Clojars</a>, <a href="https://cljdoc.org/versions/polylith/clj-poly">cljdoc</a>, and GitHub as <a href="https://github.com/polyfy/polylith/releases">releases</a>.</p>
</div>
<div class="paragraph">
<p>You can find the CircleCI configuration file <a href="../.circleci/config.yml">here</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="releases"><a class="link" href="#releases">Releases</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <a href="https://github.com/polyfy/polylith/releases">release</a> is triggered when a commit is pushed to master, often a squashed branch that fixes/implements an <a href="https://github.com/polyfy/polylith/issues">issue</a>.
If SNAPSHOT is included in the version name, then it becomes a
<a href="https://github.com/polyfy/polylith/blob/779d0815fb3fbb7dac0a278448926711a7efa82c/components/version/src/polylith/clj/core/version/interface.clj#L26">snapshot</a> release, otherwise a "final" release.
The manual steps for creating a release are detailed in the  <a href="#create-a-snapshot-release">snapshot</a> and <a href="#create-a-stable-release">stable</a> sections on the Developing Poly page.</p>
</div>
<div class="paragraph">
<p>&#160;<br></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/polylith-ci-setup/release-timeline.png" alt="release timeline">
</div>
</div>
<div class="paragraph">
<p>&#160;<br></p>
</div>
<div class="sect2">
<h3 id="_final_release"><a class="link" href="#_final_release">Final release</a></h3>
<div class="paragraph">
<p>A commit is pushed to the <code>master</code> branch where <a href="https://github.com/polyfy/polylith/blob/56a481b9a209bc013fbe1852d1797b4bba2bdf1a/components/version/src/polylith/clj/core/version/interface.clj#L31">version</a>
is not a snapshot, e.g. <code>0.2.18</code> or <code>0.2.19</code>, which triggers a build in CircleCi that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creates a <a href="https://github.com/polyfy/polylith/releases">release</a> of the <code>poly</code> tool.</p>
</li>
<li>
<p>Releases the <a href="https://cljdoc.org/d/polylith/clj-poly/CURRENT/api/polylith">clj-poly</a> library to Clojars.</p>
</li>
<li>
<p>Triggers a build of the web based <a href="https://cljdoc.org/d/polylith/clj-poly/CURRENT/doc/readme">cljdoc</a> documentation.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_snapshot_release"><a class="link" href="#_snapshot_release">Snapshot release</a></h3>
<div class="paragraph">
<p>A commit is pushed to the <code>master</code> branch where <a href="https://github.com/polyfy/polylith/blob/56a481b9a209bc013fbe1852d1797b4bba2bdf1a/components/version/src/polylith/clj/core/version/interface.clj#L31">version</a>
is a snapshot, e.g. <code>0.2.19-SNAPSHOT</code>, which triggers a build in CircleCi that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creates a <a href="https://docs.github.com/en/repositories/releasing-projects-on-github/managing-releases-in-a-repository#creating-a-release">pre-release</a> of the <code>poly</code> tool.</p>
</li>
<li>
<p>Releases the snapshot version of the <a href="https://cljdoc.org/d/polylith/clj-poly/CURRENT/api/polylith">clj-poly</a> library to Clojars.</p>
</li>
<li>
<p>Triggers a snapshot build of the web based <a href="https://cljdoc.org/d/polylith/clj-poly/CURRENT/doc/readme">cljdoc</a> documentation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The same snapshot release can be triggered several times and will overwrite the latest snapshot release.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="https://github.com/polyfy/polylith/blob/master/next-release.md">next-release.md</a> file lists what has been included in the SNAPSHOT release, since the previous final release.
This file is cleared when making the first SNAPSHOT release directly after a final release.
Changes to the workspace structure are listed in the <a href="#">versions</a> page.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="remove-old-snapshot-releases" class="exampleblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Old SNAPSHOT releases are regularly deleted. If you use snapshot releases, ensure you use the latest SNAPSHOT or stable version.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deploy_workflow"><a class="link" href="#_deploy_workflow">Deploy Workflow</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This workflow has three jobs triggered by any commit to a branch associated with a pull request. These three jobs are <code>check</code>, <code>info</code>, and <code>test</code>. The workflow runs the remaining jobs only if the current branch is the <em>master</em> branch.</p>
</div>
<div class="sect2">
<h3 id="_jobs"><a class="link" href="#_jobs">Jobs</a></h3>
<div class="sect3">
<h4 id="_create_version_txt"><a class="link" href="#_create_version_txt">create-version-txt</a></h4>
<div class="paragraph">
<p>This job runs the <code>create-version-txt</code> function in the <code>build.clj</code> file. The <code>create-version-txt</code> function gets the current version string and writes it to the <code>version.txt</code> file. This file will be persisted during the CI run so that the following jobs can read the version from it.</p>
</div>
</div>
<div class="sect3">
<h4 id="_check"><a class="link" href="#_check">check</a></h4>
<div class="paragraph">
<p>This job runs the check command from the <code>poly</code> tool as follows: <code>clojure -M:poly check</code>.
If there are any errors in the <a href="#">workspace</a>, it returns with a non-zero exit code and the CircleCI workflow stops at this stage.
If there are any warnings printed by the tool, it will be visible in the job&#8217;s output.
If the current branch is the master branch, <code>since:previous-release</code> argument is added to the command and run as: <code>clojure -M:poly check since:previous-release</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_info"><a class="link" href="#_info">info</a></h4>
<div class="paragraph">
<p>This job runs the following commands, one after another:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>clojure -M:poly ws</code></p>
<div class="ulist">
<ul>
<li>
<p>Prints the current workspace as data in <a href="https://github.com/edn-format/edn">edn</a> format.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>clojure -M:poly info</code></p>
<div class="ulist">
<ul>
<li>
<p>Prints workspace information.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>clojure -M:poly deps</code></p>
<div class="ulist">
<ul>
<li>
<p>Prints the dependency information</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>clojure -M:poly libs</code></p>
<div class="ulist">
<ul>
<li>
<p>Prints all libraries that are used in the workspace.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the current branch is the master branch, <code>since:previous-release</code> argument is added to each command above.</p>
</div>
<div class="paragraph">
<p>After this job is done, all this information will be available in the jobs output for debugging purposes, if needed.
You can read more about available commands <a href="#">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_test"><a class="link" href="#_test">test</a></h4>
<div class="paragraph">
<p>This job runs all the tests for all the bricks and projects that are directly or indirectly changed since the last stable point in time.
The <code>poly</code> tool supports incremental testing out-of-the-box by using stable point marks in the git repository.
It runs the following command: <code>clojure -M:poly test :project</code>.
If any of the tests fail, it will exit with a non-zero exit code and the CircleCI workflow stops at this stage.
Information about the passed/failed tests will be printed in the job&#8217;s output.
If the current branch is the master branch, <code>since:previous-release</code> argument is added to the command and run as: <code>clojure -M:poly test since:previous-release</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mark_as_stable"><a class="link" href="#_mark_as_stable">mark-as-stable</a></h4>
<div class="paragraph">
<p>This job only runs for the commits made to the <em>master</em> branch.
It adds (or replaces if already exists) the <code>stable-master</code> tag to the repository.
At this point in the workflow, it is "proven" that the Polylith workspace is valid and all of the tests are passed, and it&#8217;s safe to mark this commit as stable.</p>
</div>
<div class="paragraph">
<p>It does that by running the following commands, one after another:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>git tag -f -a &quot;stable-$CIRCLE_BRANCH&quot; -m &quot;[skip ci] Added Stable Polylith tag&quot;</code></p>
<div class="ulist">
<ul>
<li>
<p>Creates or moves the tag.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>git push origin $CIRCLE_BRANCH --tags --force-with-lease=$CIRCLE_BRANCH</code></p>
<div class="ulist">
<ul>
<li>
<p>Pushes the tag back to the git repository.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_add_version_tag"><a class="link" href="#_add_version_tag">add-version-tag</a></h4>
<div class="paragraph">
<p>This job only runs for the commits made to the <em>master</em> branch.
It adds a new version tag to the repository in the form of <code>vX.Y.Z</code>.
The version string is read from the <code>version.txt</code> file.
This job skips adding the version tag if the current version is a snapshot version.</p>
</div>
<div class="paragraph">
<p>The tag is added by running the following commands, one after another:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VERSION=`cat version.txt`</code></p>
<div class="ulist">
<ul>
<li>
<p>Reads the version string.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>git tag -f -a &quot;v$VERSION&quot; -m &quot;[skip ci] Added new version tag&quot;</code></p>
<div class="ulist">
<ul>
<li>
<p>Creates the tag.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>git push origin $CIRCLE_BRANCH --tags --force-with-lease=$CIRCLE_BRANCH</code></p>
<div class="ulist">
<ul>
<li>
<p>Pushes the tag back to the git repository.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_deploy"><a class="link" href="#_deploy">deploy</a></h4>
<div class="paragraph">
<p>This job only runs for the commits made to the <em>master</em> branch.
It deploys the changed projects to Clojars.
If this is a snapshot version, it also triggers a cljdoc build after deploying projects to Clojars.
It&#8217;s easy to deploy incrementally with the <code>poly</code> tool.
Changed projects are calculated since the latest release.
You can see how it&#8217;s done <a href="https://github.com/polyfy/polylith/blob/master/build.clj">here</a>.
In a nutshell, it executes <code>poly ws get:changes:changed-or-affected-projects skip:dev since:previous-release</code> and only deploys the returned projects.</p>
</div>
</div>
<div class="sect3">
<h4 id="_create_artifacts"><a class="link" href="#_create_artifacts">create-artifacts</a></h4>
<div class="paragraph">
<p>This job only runs for the commits made to the <em>master</em> branch.
It creates two types of artifacts per changed project, an AOT compiled uberjar and a package that can be used to deploy <a href="https://brew.sh">Homebrew</a>.
Created artifacts can be found in the artifacts section of this job&#8217;s output.</p>
</div>
</div>
<div class="sect3">
<h4 id="_publish_github_release"><a class="link" href="#_publish_github_release">publish-gitHub-release</a></h4>
<div class="paragraph">
<p>This job only runs for the commits made to the <em>master</em> branch.
It uploads the artifacts created after the previous job and uploads them to a new release in GitHub.
If this is a snapshot version, the release in GitHub is marked as pre-release. If there is an existing pre-release in GitHub for the same version and tag, the release is overriden.
It makes use of the <a href="https://github.com/tcnksm/ghr">GHR</a> tool in order to create a new release on GitHub and upload the artifacts.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reference"><a class="link" href="#_reference">Reference</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_commands"><a class="link" href="#_commands">Commands</a></h3>

</div>
</div>
</div>
<h1 id="_commands_2" class="sect0"><a class="link" href="#_commands_2">Commands</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>The individual help texts listed here are taken from the built-in <code>help</code> command.</p>
</div>
<div class="paragraph">
<p>To list all available commands, type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly help</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  poly 0.2.20 (2024-07-10) - https://github.com/polyfy/polylith

  poly CMD [ARGS] - where CMD [ARGS] are:

    check [ARG]                 Checks if the workspace is valid.
    create E name:N [ARG]       Creates a component, base, project or workspace.
    deps [project:P] [brick:B]  Shows dependencies.
    diff [ARG]                  Shows changed files since last stable point in time.
    doc [ARG]                   Opens the web based documentation in a browser.
    help [C] [ARG]              Shows this help or help for specified command.
    info [ARGS]                 Shows a workspace overview and checks if it's valid.
    libs [ARGS]                 Shows all libraries in the workspace.
    shell [ARGS]                Starts an interactive shell.
    test [ARGS]                 Runs tests.
    version                     Shows current version of the tool.
    ws [get:X]                  Shows the workspace as data.

  From the shell:

    switch-ws ARG  Switches to specified workspace.
    tap [ARG]      Opens a portal window that outputs tap&gt; statements.
    exit           Exits the shell.
    quit           Quits the shell.

  If ws-dir:PATH is passed in as an argument, where PATH is a relative
  or absolute path, then the command is executed from that directory.
  This works for all commands except 'test'.

  If ws-file:FILE is passed in, then the workspace will be populated with the content
  from that file. All commands except 'create' and 'test' can be executed with this
  argument set. The FILE is created by executing the 'ws' command, e.g.:
  'poly ws out:ws.edn'.

  The ws-dir and ws-file arguments are replaced by switch-ws when executing commands
  from the shell.

  If skip:PROJECTS is passed in, then the given project(s) will not be read from disk.
  Both project names and aliases can be used and should be separated by : if more than
  one.

  If since:SINCE is passed in as an argument, the last stable point in time will be
  used depending on the value of SINCE (or the first commit if no match was found).
  If prefixed with 'previous-', e.g. 'previous-release', then the SHA directly before
  the most recent matching tag of the 'release' pattern will be used:
    stable  -&gt; the latest tag that matches stable-*, defined by
               :tag-patterns &gt; :stable in workspace.edn.
    release -&gt; the latest tag that matches v[0-9]*, defined by
               :tag-patterns &gt; :release in workspace.edn.
    KEY     -&gt; any key in :tag-patterns.
    SHA     -&gt; a git SHA-1 hash (if no key was found in :tag-patterns).

  The color mode is taken from ~/.config/polylith/config.edn but can be overridden by
  passing in color-mode:COLOR where valid colors are none, light, and dark.
  (if the XDG_CONFIG_HOME environment variable is set, that will be used instead of
  ~/.config)

  Example (shell only):
    switch-ws dir:~/myworkspace
    switch-ws file:../../another/ws.edn
    switch-ws via:myworkspace
    tap
    tap open
    tap clean
    tap close

  'poly :tap' will start a shell and open a portal window.

  Example:
    poly
    poly :tap
    poly check
    poly check :dev
    poly create component name:user
    poly create component name:admin interface:user
    poly create base name:mybase
    poly create project name:myproject
    poly create workspace name:myws top-ns:com.my.company
    poly create workspace name:myws top-ns:com.my.company :commit
    poly create workspace name:myws top-ns:com.my.company branch:master :commit
    poly deps
    poly deps brick:mybrick
    poly deps project:myproject
    poly deps project:myproject brick:mybrick
    poly deps :swap-axes
    poly deps out:out.txt
    poly diff
    poly doc
    poly doc help
    poly doc help:check
    poly doc page:install
    poly doc ws:settings
    poly doc more:blog-posts
    poly doc more:blog-posts:how-polylith-came-to-life
    poly doc more:high-level
    poly doc more:high-level:who-made-this
    poly doc more:podcasts
    poly doc more:podcasts:polylith-with-joakim-james-and-furkan
    poly doc more:python-tool
    poly doc more:slack
    poly doc more:videos
    poly doc more:videos:polylith-in-a-nutshell
    poly doc more:workspaces:realworld
    poly help
    poly help info
    poly help create
    poly help create component
    poly help create base
    poly help create project
    poly help create workspace
    poly help deps
    poly help deps :project
    poly help deps :brick
    poly help deps :project :brick
    poly help deps :workspace
    poly info
    poly info +
    poly info :loc
    poly info since:65a7918
    poly info since:head
    poly info since:head~1
    poly info since:stable
    poly info since:release
    poly info since:previous-release
    poly info skip:dev
    poly info skip:dev:myproject
    poly info project:myproject
    poly info project:myproject:another-project
    poly info brick:mycomponent
    poly info brick:mycomponent:mybase
    poly info color-mode:none
    poly info :project
    poly info :dev
    poly info :project :dev
    poly info :all
    poly info :all-bricks
    poly info out:info.txt
    poly info ws-dir:another-ws
    poly info ws-file:ws.edn
    poly libs
    poly libs :compact
    poly libs :outdated
    poly libs :update
    poly libs :update libraries:metosin/malli:zprint/zprint
    poly libs out:libs.txt
    poly shell
    poly shell :tap
    poly shell :all
    poly test
    poly test :project
    poly test :all-bricks
    poly test :all
    poly test project:proj1
    poly test project:proj1:proj2
    poly test brick:mycomponent
    poly test brick:mycomponent:mybase
    poly test :dev
    poly test :project :dev
    poly test :all-bricks :dev
    poly test :all :dev
    poly test with:default:kaocha-test-runner
    poly version
    poly ws
    poly ws get:keys
    poly ws get:count
    poly ws get:configs
    poly ws get:settings
    poly ws get:user-input:args
    poly ws get:user-input:args:0
    poly ws get:settings:keys
    poly ws get:components:keys
    poly ws get:components:count
    poly ws get:components:mycomp:lines-of-code
    poly ws get:settings:vcs:polylith :latest-sha
    poly ws get:settings:vcs:polylith :latest-sha branch:master
    poly ws get:changes:changed-or-affected-projects skip:dev color-mode:none
    poly ws out:ws.edn</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_check_2"><a class="link" href="#_check_2">check</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Validates the workspace.

  poly check [:dev]

  Prints 'OK' and returns 0 if no errors were found.
  If errors or warnings were found, show messages and return the error code,
  or 0 if only warnings. If internal errors, 1 is returned.

  Error 101 - Illegal dependency on namespace.
    Triggered if a :require statement refers to a component namespace
    other than interface. Examples of valid namespaces:
     - com.my.company.mycomponent.interface
     - com.my.company.mycomponent.interface.subns
     - com.my.company.mycomponent.interface.my.subns

  Error 102 - Function or macro is defined twice.
    Triggered if a function or macro is defined twice in the same namespace.

  Error 103 - Missing definitions.
    Triggered if a def, defn or defmacro definition exists in one component's
    interface but is missing in another component that uses the same interface.

  Error 104 - Circular dependencies.
    Triggered if circular dependencies were detected, e.g.:
    Component A depends on B that depends on A (A &gt; B &gt; A), or A &gt; B &gt; C &gt; A.

  Error 105 - Illegal name sharing.
    Triggered if a base has the same name as a component or interface.
    Projects and profiles can be given any name.

  Error 106 - Multiple components that share the same interfaces in a project.
    Triggered if a project contains more than one component that shares the
    same interface.

  Error 107 - Missing components in project.
    Triggered if a component depends on an interface that is not included in the
    project. The solution is to add a component to the project that
    implements the interface.

  Error 108 - Components with an interface that is implemented by more than one
              component are not allowed for the development project.
    The solution is to remove the component from the development project
    and define the deps/paths for each component in separate profiles
    (including test paths).

  Error 109 - Invalid test runner configuration for some projects.
    The value of the optional :create-test-runner key under [:test] or
    [:projects "some-project-name" :test] in workspace.edn must be either
    nil, :default, or a fully qualified symbol referring to a function on
    the poly tool's classpath, which can take a single argument and must return
    an instance of polylith.clj.core.test-runner-contract.interface/TestRunner.

  Error 110 - Invalid config file.
    Triggered if a deps.edn file for a brick or project is invalid.
    It's allowed to omit the deps.edn file entirely, except for development,
    and in that case the brick/project will be ignored.

  Error 111 - Unreadable namespace in brick/project.
    Triggered if a namespace can't be parsed for a brick or project.
    The solution is to fix the invalid namespace (add it if missing)
    or move the file from 'src' to 'resources' or from 'test' to 'test-resources'.

  Error 112 - Illegal dependency on brick.
    Triggered if a brick depends on a brick from its deps.edn config file.
    The solution is to remove the dependency and specify the brick in the
    projects in which it is used.

  Warning 201 - Mismatching argument lists in function or macro.
    Triggered if a function or macro is defined in the interface for a component
    but also defined in the same interface for another component but with a
    different argument list.

  Warning 202 - Missing paths in project.
    Triggered if a path in a project doesn't exist on disk.
    The solution is to add the file or directory, or to remove the path.

  Warning 203 - Path exists in both dev and profile.
    It's discouraged to have the same path in both the development project
    and a profile. The solution is to remove the path from dev or the profile.

  Warning 205 - Non top namespace was found in brick.
    Triggered if a namespace in a brick doesn't start with the top namespaces
    defined in :top-namespace in ./workspace.edn.
    Files that are put in 'resources' or 'test-resources' are not checked.

  Warning 207 - Unnecessary components were found in project.
    Triggered if components were defined in a project that are not used by any of
    its bricks. Development is only checked if :dev is passed in and is only performed
    by the check command (not test and info). To ignore this warning, put the component
    name in the :necessary vector for a project in :projects in ./workspace.edn.
    See an example here: https://github.com/polyfy/polylith/blob/master/workspace.edn</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create"><a class="link" href="#_create">create</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Creates a component, base, project or workspace.

  poly create TYPE [ARGS]

    TYPE = c[omponent] -&gt; Creates a component.
           b[ase]      -&gt; Creates a base.
           p[roject]   -&gt; Creates a project.
           w[orkspace] -&gt; Creates a workspace.

    ARGS = Varies depending on TYPE.

  To get help for a specific TYPE, execute 'poly help create TYPE'.

  Example:
    poly create component name:user
    poly create component name:admin interface:user
    poly create base name:mybase
    poly create project name:myproject
    poly create workspace name:myws top-ns:com.my.company
    poly create workspace name:myws top-ns:com.my.company :commit
    poly create workspace name:myws top-ns:com.my.company branch:master</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_component"><a class="link" href="#_create_component">create component</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Creates a component.

  poly create component name:NAME [interface:INTERFACE] [:git-add]

    NAME = The name of the component to create.

    :git-add = If :vcs &gt; :auto-add in workspace.edn is set to false,
               then we can pass in this flag instead, to explicitly add the
               created files to git.

    INTERFACE = The name of the interface (namespace) or NAME if not given.

  Example:
    poly create component name:user
    poly create component name:user :git-add
    poly create component name:admin interface:user</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_base"><a class="link" href="#_create_base">create base</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Creates a base.

  poly create base name:NAME [:git-add]

    NAME = The name of the base to create.

    :git-add = If :vcs &gt; :auto-add in workspace.edn is set to false,
               then we can pass in this flag instead, to explicitly add the
               created files to git.

  Example:
    poly create base name:mybase
    poly create base name:mybase :git-add</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_project"><a class="link" href="#_create_project">create project</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Creates a project.

  poly create project name:NAME [:git-add]
    NAME = The name of the project to create.

    :git-add = If :vcs &gt; :auto-add in workspace.edn is set to false,
               then we can pass in this flag instead, to explicitly add the
               created files to git.

  Example:
    poly create project name:myproject
    poly create project name:myproject :git-add</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_workspace"><a class="link" href="#_create_workspace">create workspace</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Creates a workspace in current directory. If the workspace is created within
  an existing git repo, then that repository will be used. If the workspace is
  created outside a git repo, then you have two alternatives:

  1. Pass in :commit and let the tool initiate the repository and commit the files
     for you, using these commands:
       git init
       git add .
       git commit -m "Workspace created."

  2. Initiate the workspace manually by executing commands similar to the ones above.

  poly create workspace [name:NAME] top-ns:TOP-NAMESPACE [:commit] [branch:BRANCH]

    NAME = The name of the workspace to create, which must be given
           if created outside a git repository. Otherwise it's optional.

    TOP-NAMESPACE = The top namespace name.

    BRANCH = The name of the branch, or the default git main branch if not given.

  Example:
    poly create workspace name:myws top-ns:com.my.company
    poly create workspace name:myws top-ns:com.my.company :commit
    poly create workspace name:myws top-ns:com.my.company branch:master :commit</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deps"><a class="link" href="#_deps">deps</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Shows dependencies.

  poly deps [project:PROJECT] [brick:BRICK] [out:FILENAME]

    (omitted) = Shows workspace dependencies.

    PROJECT = Shows dependencies for the given project.

    BRICK = Shows dependencies for the given brick.

    FILENAME = The name of the text file to create, containing the
               output from this command.

  To get help for a specific diagram, type:
    poly help deps ARGS:

      ARGS = :brick           Help for the brick diagram.
             :project         Help for the project diagram.
             :project :brick  Help for the project/brick diagram.
             :workspace       Help for the workspace diagram.

  Example:
    poly deps
    poly deps brick:mybrick
    poly deps project:myproject
    poly deps project:myproject brick:mybrick
    poly deps :swap-axes
    poly deps out:deps.txt</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deps_brick"><a class="link" href="#_deps_brick">deps :brick</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Shows dependencies for selected brick.

  poly deps brick:BRICK [out:FILENAME]

    BRICK = The name of the brick to show dependencies for.

    FILENAME = The name of the text file to create, containing the
               output from this command.

  used by  &lt;  user  &gt;  uses
  -------              ----
  payer                util

  In this example, user is used by payer and it uses util itself.
  If a brick or interface ends with '(t)' then it indicatest that
  it's only used from the test context.

  Example:
    poly deps brick:mybrick
    poly deps brick:mybrick out:deps.txt</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deps_project"><a class="link" href="#_deps_project">deps :project</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Shows dependencies for selected project.

  poly deps project:PROJECT [out:FILENAME]

    PROJECT = The project name or alias to show dependencies for.

    FILENAME = The name of the text file to create, containing the
               output from this command.

         p
         a  u  u
         y  s  t
         e  e  i
  brick  r  r  l
  --------------
  payer  .  x  t
  user   .  .  x
  util   .  .  .
  cli    x  +  +

  When the project is known, we also know which components are used.

  In this example, payer uses user in the src context, and util only
  in the test context. user uses util, and cli uses payer. The 't'
  means that payer is only used in the test context by user. The +
  signs mark indirect dependencies, while - signs (not present here)
  mark indirect dependencies in the test context. Here the cli base
  depends on user and util, via 'cli &gt; payer &gt; user' and
  'cli &gt; payer &gt; util'. Each usage comes from at least one :require
  statement in the brick.

  Example:
    poly deps project:myproject
    poly deps project:myproject out:deps.txt</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deps_workspace"><a class="link" href="#_deps_workspace">deps :workspace</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Shows dependencies for the workspace.

  poly deps [:swap-axes] [out:FILENAME]

    :swap-axes = Swaps the diagram's x and y axes.

    FILENAME   = The name of the text file to create, containing the
                 output from this command.

         p
         a  u  u
         y  s  t
         e  e  i
  brick  r  r  l
  --------------
  payer  .  x  t
  user   .  .  x
  util   .  .  .
  cli    x  .  .

  In this example, payer uses user from the src context, and util from
  the test context (indicated by 't'). user uses util and cli uses payer.
  Each usage comes from at least one :require statement in the brick.

  Example:
    poly deps
    poly deps :swap-axes
    poly deps out:deps.txt</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deps_project_brick"><a class="link" href="#_deps_project_brick">deps :project :brick</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Shows dependencies for selected brick and project.

  poly deps project:PROJECT brick:BRICK [out:FILENAME]

    PROJECT = The project (name or alias) to show dependencies for.

    BRICK = The brick to show dependencies for.

    FILENAME = The name of the text file to create, containing the
               output from this command.

  used by  &lt;  user  &gt;  uses
  -------              ----
  payer                util

  In this example, user is used by payer and it uses util itself.
  If a brick ends with '(t)' then it indicatest that it's only used
  from the test context.

  Example:
    poly deps project:myproject brick:mybrick
    poly deps project:myproject brick:mybrick out:deps.txt</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_diff"><a class="link" href="#_diff">diff</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Shows changed files since the most recent stable point in time.

  poly diff [since:SINCE]

  If since:SINCE is passed in as an argument, the last stable point in time will be
  used depending on the value of SINCE (or the first commit if no match was found).

  If prefixed with 'previous-', e.g. 'previous-release', then the SHA directly before
  the most recent matching tag of the 'release' pattern will be used:
    stable  -&gt; the latest tag that matches stable-*, defined by
               :tag-patterns &gt; :stable in workspace.edn.
    release -&gt; the latest tag that matches v[0-9]*, defined by
               :tag-patterns &gt; :release in workspace.edn.
    KEY     -&gt; any key in :tag-patterns.
    SHA     -&gt; a git SHA-1 hash (if no key was found in :tag-patterns).

  Internally, it executes 'git diff SHA --name-only' where SHA is the SHA-1
  of the first commit in the repository, or the SHA-1 of the most recent tag
  that matches the default pattern 'stable-*' or the passed in since:SINCE.

  Stable points are normally set by the CI server or by individual developers,
  e.g. Lisa, with 'git tag -f stable-lisa'.

  The pattern can be changed in :tag-patterns in workspace.edn.

  The way the latest tag is found is by taking the first line that matches the
  'stable-*' regular expression, or if no match was found, the first commit in
  the repository:
    git log --pretty=format:'%H %d'

  Here is a compact way of listing all the commits including tags:
    git log --pretty=oneline

  Example:
    poly diff
    poly diff since:65a7918
    poly diff since:head
    poly diff since:head~1
    poly diff since:stable
    poly diff since:release
    poly diff since:previous-release</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_doc_2"><a class="link" href="#_doc_2">doc</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Opens a help page in a web browser.

  poly doc [ARG]

    ARG = (omitted)    -&gt; Opens the poly tool readme (first page).

          help:COMMAND -&gt; Opens the help for the given poly COMMAND,
                          or the overall help if not given.

          page:PAGE    -&gt; Opens the given PAGE of the poly tool documentation.

          ws:KEY       -&gt; Opens the workspace structure section of the poly tool
                          documentation, and scrolls to the KEY section.

          more:TYPE    -&gt; Opens the given blog-post, podcast, video, et cetera.

  Example:
    poly doc
    poly doc help
    poly doc help:check
    poly doc page:install
    poly doc ws:settings
    poly doc more:blog-posts
    poly doc more:blog-posts:how-polylith-came-to-life
    poly doc more:high-level
    poly doc more:high-level:who-made-this
    poly doc more:podcasts
    poly doc more:podcasts:polylith-with-joakim-james-and-furkan
    poly doc more:python-tool
    poly doc more:slack
    poly doc more:videos
    poly doc more:videos:polylith-in-a-nutshell
    poly doc more:workspaces:realworld</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_info_2"><a class="link" href="#_info_2">info</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Shows workspace information.

  poly info [:loc] [out:FILENAME]

    :loc     = Shows the number of lines of code for each brick and project.

    FILENAME = The name of the text file to create, containing the output from
               this command.

  All the arguments used by the 'test' command can also be used as a way to see
  what tests will be executed.

    stable since: dec73ec | stable-lisa

    projects: 2   interfaces: 3
    bases:    1   components: 4

    active profiles: default

    project       alias  status   dev  admin
    ---------------------------   ----------
    command-line  cl      ---     ---   --
    development   dev     s--     s--   --

    interface  brick    cl    dev  admin
    -----------------   ---   ----------
    payer      payer    s--   st-   --
    user       admin    s--   ---   s-
    user       user *   ---   st-   --
    util       util     s--   st-   --
    -          cli      s--   st-   --

  This example shows a sample workspace. Let's go through each section:

  1. stable since: dec73ec | stable-lisa

     Shows the most recent commit marked as stable, or the last release if
     since:release or since:previous-release was given, or the first commit
     in the repository if no tag was found, followed by the tag (if found).
     More information can be found in the 'diff' command help.

  2. projects: 2   interfaces: 3
     bases:    1   components: 4

     Shows how many projects, bases, components and interfaces there are
     in the workspace.

  3. active profiles: default

     Shows the names of active profiles. The profile paths are merged into the
     development project. A profiles is an alias in ./deps.edn that starts
     with a +. If no profile is selected, the default profile is automatically
     selected.

     Profiles are activated by passing them in by name (prefixed with '+'), e.g.:
       poly info +admin +onemore

     To deactivate all the profiles, and stop 'default' from being merged into
     the development project, type:
       poly info +

  4. project       alias  status   dev  admin
     ---------------------------   ----------
     command-line  cl      ---     ---   --
     development   dev     s--     s--   --

    This table lists all projects. The 'project' column shows the name
    of the projects, which are the directory names under the 'projects',
    directory except for 'development' that stores its code under the
    'development' directory. If any file within the project directory has
    changed, then it will be marked with a *. If that's not the case, but
    any of the included bricks are changed, then it will be marked with a +.

    The 'deps.edn' config files are stored under each project, except for
    the development project that stores it at the workspace root.

    Aliases are configured in :projects in ./workspace.edn.

    The 'status' column has three flags with different meaning:
      s--  The project has a 'src' directory, e.g.
           'projects/command-line/src'.
      -t-  The project has a 'test' directory, e.g.
           'projects/command-line/test'.
      --x  The project tests (its own) are marked for execution.

    To show the 'resources' directory, also pass in :r or :resources, e.g.
    'poly info :resources':
      s---  The project has a 'src' directory, e.g.
            'projects/command-line/src'.
      -r--  The project has a 'resources' directory, e.g.
            'projects/command-line/resources'.
      --t-  The project has a 'test' directory, e.g.
            'projects/command-line/test'
      ---x  The project tests (its own) are marked for execution.

    The dev column has three flags with different meaning:
      s--  The project's 'src' directory, e.g.
           'development/src' is added to './deps.edn'
      -t-  The project's 'test' directory, e.g.
           'development/test' is added to './deps.edn'
      --x  The project tests are marked for execution from development.

    The last admin column, is a profile:
      s-  The profile contains a path to the 'src' directory, e.g.
          'projects/command-line/src'.
      -t  The profile contains a path to the 'test' directory, e.g.
          'projects/command-line/test'.

    If also passing in :r or :resources, e.g. 'poly info :resources':
      s--  The profile contains a path to the 'src' directory, e.g.
           'projects/command-line/src'.
      -r-  The profile contains a path to the 'resources' directory, e.g.
           'projects/command-line/resources'.
      --t  The profile contains a path to the 'test' directory, e.g.
           'projects/command-line/test'.

  5. interface  brick    cl    dev  admin
     -----------------   ---   ----------
     payer      payer    s--   st-   --
     user       admin    s--   ---   s-
     user       user *   ---   st-   --
     util       util     s--   st-   --
     -          cli      s--   st-   --

    This table lists all bricks and in which projects and profiles they are
    added to.

    The 'interface' column shows what interface the component has. The name
    is the first namespace after the top namespace, e.g.:
    com.my.company.user.interface

    The 'brick' column shows the name of the brick, in green if a component or
    blue if a base. Each component lives in a directory under the 'components'
    directory and each base lives under the 'bases' directory. If any file for
    a brick has changed since the last stable point in time, it will be marked
    with an asterisk, * (user in this example).

    The changed files can be listed by executing 'poly diff'.

    The next cl column is the command-line project that lives under the
    'projects' directory. Each line in this column says whether a brick is
    included in the project or not.
    The flags mean:
      s--  The project contains a path to the 'src' directory, e.g.
           'components/user/src' (or is indirectly added by a :local/root).
      -t-  The project contains a path to the 'test' directory, e.g.
           'components/user/test' (or is indirectly added by a :local/root).
      --x  The brick is marked to be executed from this project.

    If :r or :resources is also passed in:
      s---  The project contains a path to the 'src' directory, e.g.
            'components/user/src' (or is indirectly added by a :local/root).
      -r--  The project contains a path to the 'resources' directory, e.g.
            'components/user/resources' (or is indirectly added by a :local/root).
      --t-  The project contains a path to the 'test' directory, e.g.
            'components/user/test' (or is indirectly added by a :local/root).
      ---x  The brick is marked to be executed from this project.

    The next group of columns, dev admin, is the development project with
    its profiles. If passing in a plus with 'poly info +' then it will also show
    the default profile. The flags for the dev project works the same
    as for cl.

    The flags for the admin profile means:
      s-  The profile contains a path to the 'src' directory, e.g.
          'components/user/src'.
      -t  The profile contains a path to the 'test' directory, e.g.
          'components/user/test'

  It's not enough that a path has been added to a project to show an 'x',
  the file or directory must also exist.

  If any warnings or errors were found in the workspace, they will be listed at
  the end, see the 'check' command help, for a complete list of validations.

  Example:
    poly info
    poly info :loc
    poly info since:release
    poly info since:previous-release
    poly info project:myproject
    poly info project:myproject:another-project
    poly info brick:mycomponent
    poly info brick:mycomponent:mybase
    poly info color-mode:none
    poly info :project
    poly info :dev
    poly info :project :dev
    poly info :all
    poly info :all-bricks
    poly info out:info.txt
    poly info ws-dir:another-ws
    poly info ws-file:ws.edn</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_libs"><a class="link" href="#_libs">libs</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Shows all libraries that are used in the workspace.

  poly libs [:compact] [:outdated] [:update] [libraries:LIBS] [out:FILENAME]

    :compact  = Shows the table in a more compact way.

    :outdated = Shows the latest version of each library, or blank if up to date.

    :update   = Updates all libraries to the latest version. If LIBS is given,
                then only update selected libraries.
                Old library versions can be kept by giving the library as a symbol in
                :keep-lib-versions for bricks and projects in workspace.edn.

    FILENAME  = The name of the text file to create, containing the
                output from this command.
                                                                                 u  u
                                                                                 s  t
                                                                                 e  i
    library                 version    type      KB   cl   dev  default  admin   r  l
    -----------------------------------------------   --   -------------------   ----
    antlr/antlr             2.7.7      maven    434   x     x      -       -     .  x
    clj-time                0.15.2     maven     23   x     x      -       -     x  .
    org.clojure/clojure     1.10.1     maven  3,816   x     x      -       -     .  .
    org.clojure/tools.deps  0.16.1264  maven     46   x     x      -       -     .  .

  In this example we have four libraries used by the cl and dev projects.
  If any of the libraries are added to the default or admin profiles, they will appear
  as an x in these columns. Remember that src and test sources live together in a
  profile, which is fine because they are only used from the development project.

  The x for the cl and dev columns says that the library is part of the src scope.
  If a library is only used from the test scope, then it's marked with a 't'.
  A library used in the test scope, can either be specified directly by the project
  itself via :aliases &gt; :test &gt; :extra-deps or indirectly via included bricks in
  :deps &gt; :local/root which will be picked up and used by the 'test' command.

  The x in the user column, tells that clj-time is used by that component
  by having it specified in its 'deps.edn' file as a src dependency.
  If a dependency is only used from the test scope, then it will turn up as a t.

  Libraries can also be selected per project and it's therefore possible to have
  different versions of the same library in different projects (if needed).
  Use the :override-deps key in the project's 'deps.edn' file to explicitly set
  a version for one or several libraries in a project.

  The 'type' column says in what way the dependency is included, e.g.:
   - maven: clj-time/clj-time {:mvn/version "0.15.2"}
   - local: clj-time {:local/root "/local-libs/clj-time-0.15.2.jar"}
   - git:   clj-time/clj-time {:git/url "https://github.com/clj-time/clj-time.git"
                               :sha     "d9ed4e46c6b42271af69daa1d07a6da2df455fab"}

  The KB column shows the size in kilobytes, which is the size of the jar
  file for Maven and Local dependencies, and the size of all files in the
  ~/.gitlibs/libs/YOUR-LIBRARY directory for Git dependencies.

  Example:
    poly libs
    poly libs :compact
    poly libs :outdated
    poly libs :update
    poly libs :update libraries:metosin/malli:zprint/zprint
    poly libs out:libs.txt
    poly doc page:libraries</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="link" href="#_overview">overview</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Shows the output from the info, deps, and libs commands, side by side.
  This command is mainly used to generate an image for our documentation
  and is only available from the polyx tool.

  We can duplicate the :poly alias in ./deps.edn and rename it to :polyx and
  change :deps/root to "projects/polyx" to get access to the :polyx command.

  poly overview [:no-changes] [out:FILENAME]

    (omitted)  = Shows the output.

    :no-changes = Shows the output as if there were no changes in the workspace.

    FILENAME = Creates a text or image file based on the output.
               If FILENAME ends with .txt, then the file will contain
               the output as text. If FILENAME ends with .bmp, .wbmp, .gif,
               .png, .jpeg, .jpg, .png, .tif, or .tiff, then the file will be
               generated as an image.

  Example:
    clojure -M:polyx overview
    clojure -M:polyx overview out:overview.png
    clojure -M:polyx overview out:overview.jpg :no-changes</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_shell_3"><a class="link" href="#_shell_3">shell</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Starts an interactive shell with the name of the selected workspace, e.g.:
    myworkspace$&gt;

  poly [shell] [:all] [:tap]

    :all = The autocomplete will suggest all available arguments,
           including rarely used ones.

    :tap = A Portal window that outputs tap&gt; statements is opened.

  From here we can execute any poly command, e.g.:
    myworkspace$&gt; info

  We can also use the built in autocomplete, e.g.:
    myworkspace$&gt; i

  ...and when pressing the &lt;tab&gt; key, the 'i' is completed to 'info'.

  This works for both commands and arguments, and is context sensitive.
  If we for example type:
    myworkspace$&gt; deps brick:mybrick project:

  ...and press &lt;tab&gt;, it will only suggest projects that include 'mybrick'.

  Arguments that start with a : can be selected by just typing their name,
  e.g. 'l' will select ':loc'. To distinguish between 'project:PROJECT' and
  ':project' we need to type ':p' to select ':project'.

  From the shell we also have access to these commands:
    switch-ws ARG  Switches to selected workspace.
    tap [ARG]      Opens (or closes/cleans) a portal window that outputs tap&gt;
                   statements.
    exit           Exits the shell.
    quit           Quits the shell.

  It's also possible to start a shell and switch to a workspace at the same time,
  e.g.:
    poly shell ws-dir:examples/doc-example
    poly shell ws-file:realworld.edn

  An alternative way of exiting the shell is by pressing &lt;ctrl&gt;+C or &lt;ctrl&gt;+D.

  Example:
    poly shell
    poly shell :all
    poly shell :tap
    poly shell :all :tap
    poly doc page:shell</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_switch_ws"><a class="link" href="#_switch_ws">switch-ws</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Selects which workspace to be used by commands executed from the shell.
  After we have switched workspace, all subsequent commands will append either
  ws-dir:DIR or ws-file:FILE, depending on whether we switch to a directory or a file.

  switch-ws [dir:DIR] [file:FILE] [via:SHORTCUT]

    DIR = Switches to the given workspace directory.
          The prompt will be prefixed with 'dir:' to show this.

    FILE = Switches to the workspace specified in the selected file,
           created by something like 'poly ws out:ws.edn'.
           The prompt will be prefixed with 'file:' to show this.

    SHORTCUT = Switches to the workspace specified under the :ws-shortcuts key in
               ~/.config/polylith/config.edn

    Example of a config file in ~/.config/polylith/config.edn:


  Example:
    switch-ws dir:~/myworkspace
    switch-ws file:../../another/ws.edn
    switch-ws via:myworkspace</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tap_3"><a class="link" href="#_tap_3">tap</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Opens (or closes/cleans) a portal window (https://github.com/djblue/portal)
  where tap&gt; statements are sent to. This command is used from the shell and
  is mainly used internally when developing the poly tool itself.

  tap [ARG]

    ARG = (omitted)  Opens a portal window.
          open       Opens a portal window.
          close      Closes the portal window
          clear      Clears the portal window

  Example:
    tap
    tap open
    tap clean
    tap close
    doc page:tap</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test_2"><a class="link" href="#_test_2">test</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Executes brick and/or project tests.

  poly test [ARGS]

  The brick tests are executed from all projects they belong to except for the
  development project (if not :dev is passed in):

  ARGS              Tests to execute
  ----------------  -------------------------------------------------------------
  (omitted)         All brick tests that are directly or indirectly changed.

  :project          All brick tests that are directly or indirectly changed +
                    tests for changed projects.

  :all-bricks       All brick tests.

  :all              All brick tests + all project tests (except development).

  with:CONFIG       Merges the CONFIG configuration snippet(s) from :test-configs
                    in workspace.edn to the :test key. More than one CONFIG can be
                    selected. See https://github.com/polyfy/polylith/blob/master/
                    examples/test-runners/workspace.edn as example.


  To also execute the brick tests from the development project, pass in :dev:

  ARGS              Tests to execute
  ----------------  -------------------------------------------------------------
  :dev              All brick tests that are directly or indirectly changed,
                    executed from all projects (development included).

  :project :dev     All brick tests that are directly or indirectly changed,
                    executed from all projects (development included) +
                    tests for changed projects (development included).

  :all-bricks :dev  All brick tests, executed from all projects
                    (development included).

  :all :dev         All brick tests, executed from all projects
                    (development included) + all project tests
                    (development included).

  Projects can also be explicitly selected with e.g. project:proj1 or
  project:proj1:proj2.

  We can also specify which bricks to include, by listing them like this:
  brick:mycomponent:another-component:mybase

  Example:
    poly test
    poly test :project
    poly test :all-bricks
    poly test :all
    poly test project:proj1
    poly test project:proj1:proj2
    poly test brick:mycomponent
    poly test brick:mycomponent:mybase
    poly test :dev
    poly test :project :dev
    poly test :all-bricks :dev
    poly test :all :dev
    poly test with:default:kaocha-test-runner
    poly doc page:testing
    poly doc page:test-runners</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_version"><a class="link" href="#_version">version</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  poly version

  Prints out:
    - the tool name ('poly' or 'polyx')
    - the version (major.minor.patch)
    - the revision (SNAPSHOT if a shapshot release, otherwise empty)
    - snapshot sequence number (if a snapshot release)
    - the date (year-month-day)

  Example of a final release:
    poly 0.2.18 (2023-09-27)

  Example of a snapshot release:
    poly 0.2.18-SNAPSHOT #1 (2023-09-15)

  The poly tool does not only version control releases but also the public API,
  the workspace structure, and the test runner API, which we can read more about
  by executing:
    poly doc ws:version</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ws"><a class="link" href="#_ws">ws</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">  Prints or writes the workspace as data.

  poly ws [get:ARG] [out:FILE] [branch:BRANCH] [:latest-sha]

    ARG = keys  -&gt; Lists the keys for the data structure:
                   - If it's a hash map, it returns all its keys.
                   - If it's a list and its elements are hash maps,
                     it returns a vector with all the :name keys.

          count -&gt; Counts the number of elements.

          KEY   -&gt; If applied to a hash map, it returns the value of the KEY.
                   If applied to a list of hash maps, it returns the hash map with
                   a matching :name. Projects are also matched against :alias
                   e.g. 'dev' instead of 'development'.

          INDEX -&gt; A list element can be looked up by INDEX.

          Several ARG keys can be given, separated by colon.
          Every new key goes one level deeper into the workspace data structure.

    FILE = Writes the output to the specified FILE. Will have the same effect
           as setting color-mode:none and piping the output to a file.

    BRANCH = Can be used together with :latest-sh to set the branch to use
             if other than 'main'.

    :latest-sha = if passed in, then settings:vcs:polylith:latest-sha will be set,
                  by retreiving the latest sha from the 'main' branch.
  Example:
    poly ws
    poly ws get:keys
    poly ws get:count
    poly ws get:configs
    poly ws get:settings
    poly ws get:user-input:args
    poly ws get:user-input:args:0
    poly ws get:settings:keys
    poly ws get:components:keys
    poly ws get:components:count
    poly ws get:components:mycomp:lines-of-code
    poly ws get:settings:vcs:polylith :latest-sha
    poly ws get:settings:vcs:polylith :latest-sha branch:master
    poly ws out:ws.edn
    poly ws color-mode:none &gt; ws.edn
    poly doc ws
    poly doc ws:components</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_workspace_structure"><a class="link" href="#_workspace_structure">Workspace Structure</a></h3>

</div>
</div>
</div>
<h1 id="_workspace_structure_2" class="sect0"><a class="link" href="#_workspace_structure_2">Workspace Structure</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>The <code>poly</code> tool gives us access to the data structure that represents the workspace, which is the same structure that all the <code>poly</code> commands operate on internally.</p>
</div>
<div class="paragraph">
<p>Here we will use the output from the <a href="https://github.com/polyfy/polylith/tree/master/examples/doc-example">example</a> in the documentation.</p>
</div>
<div class="paragraph">
<p>To list all the keys at the root, execute this from the <code>examples/doc-example</code> directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:keys</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">[:bases
 :changes
 :components
 :configs
 :interfaces
 :messages
 :name
 :paths
 :profiles
 :projects
 :settings
 :user-input
 :version
 :ws-dir
 :ws-local-dir
 :ws-reader
 :ws-type]</code></pre>
</div>
</div>
<div class="paragraph">
<p>An even better way is to explore the workspace interactively from a <a href="#shell">shell</a>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/workspace-structure/shell.png" alt="shell">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bases"><a class="link" href="#bases">bases</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:bases:user-api</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:base-deps {:src [], :test []},
 :interface-deps {:src ["user"], :test []},
 :lib-deps {:src {"slacker/slacker" {:size 28408,
                                     :type "maven",
                                     :version "0.17.0"}}},
 :lib-imports {:src ["se.example.user-api.api" "slacker.server"],
               :test ["clojure.test" "se.example.user-api.core"]},
 :lines-of-code {:src 13, :test 6},
 :name "user-api",
 :namespaces {:src [{:file-path "/Users/joakimtengstrand/source/polylith/examples/doc-example/bases/user-api/src/se/example/user_api/core.clj",
                     :imports ["se.example.user-api.api" "slacker.server"],
                     :name "core",
                     :namespace "se.example.user-api.core"}
                    {:file-path "/Users/joakimtengstrand/source/polylith/examples/doc-example/bases/user-api/src/se/example/user_api/api.clj",
                     :imports ["se.example.user.interface"],
                     :name "api",
                     :namespace "se.example.user-api.api"}],
              :test [{:file-path "/Users/joakimtengstrand/source/polylith/examples/doc-example/bases/user-api/test/se/example/user_api/core_test.clj",
                      :imports ["clojure.test" "se.example.user-api.core"],
                      :name "core-test",
                      :namespace "se.example.user-api.core-test"}]},
 :paths {:src ["src" "resources"], :test ["test"]},
 :type "base"}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>:base-deps</code> Lists the bases this base depends on.</p>
</li>
<li>
<p><code>:illegal-deps</code> A vector of illegal dependencies. Populated if the base depends on something an implementing namespace in a component (bases are allowed to depend on bases) from the :src context (:test has no restrictions).</p>
<div class="ulist">
<ul>
<li>
<p><code>:from-ns</code> The name of the namespace where we refer the incorrect namespace.</p>
</li>
<li>
<p><code>:to-brick-id</code> The interface name or base name we depend on.</p>
</li>
<li>
<p><code>:to-namespace</code> The namespace we depend on.</p>
</li>
<li>
<p><code>:to-type</code> Set to the type of the brick we depend on ("base" or "component").</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:interface-deps</code> Lists the interfaces this base depends on.
Here it depends on the <code>user</code> interface from the <code>src</code> context.
This is because the <code>se.example.user-api.api</code> namespace imports <code>se.example.user.interface</code>.
No interfaces are imported from the test context in this example.</p>
</li>
<li>
<p><code>:keep-lib-versions</code> A vector containing the library names that should not be affected when executing <code>poly libs :update</code>. Configured in the workspace.edn under :bases.</p>
</li>
<li>
<p><code>:lib-deps</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:src</code> A map with the libraries that are used in this base&#8217;s src context.</p>
<div class="ulist">
<ul>
<li>
<p><code>:latest-version</code> Set if there is a newer version of this library, except if <a href="#keep-lib-versions">:keep-lib-versions</a> is set for this library. Calculated if <code>:outdated</code> is given for any command, or if <code>:update</code> is given for the libs command.</p>
</li>
<li>
<p><code>:size</code> The size of this library in bytes.</p>
</li>
<li>
<p><code>:type</code> The type of the library, "maven", "local" or "git" (<code>:mvn/version</code>, <code>:local/root</code> and <code>:git/url</code>).</p>
</li>
<li>
<p><code>:version</code> The library version:</p>
<div class="ulist">
<ul>
<li>
<p>if type is <code>maven</code> then version is set to <code>groupId/artifactId</code>.</p>
</li>
<li>
<p>if type is <code>local</code> then the version key is excluded (a <code>-</code> is shown in the output from the <a href="#libs">libs</a> command).</p>
</li>
<li>
<p>if type is <code>git</code> then the version is set to the first seven characters in the <code>sha</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>:test</code> A map with the libraries that are used in this base&#8217;s test context. Follows the same structure as the <code>:src</code> context.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:lib-imports</code> The name is a bit misleading as internal namespaces for the base is also included.</p>
<div class="ulist">
<ul>
<li>
<p><code>:src</code> Lists all imports from the src context except component interfaces.</p>
</li>
<li>
<p><code>:test</code> Lists all imports from the test context except component interfaces.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:lines-of-code</code> The total number of lines of code for this base (all namespaces included).</p>
</li>
<li>
<p><code>:name</code> The name of the directory for this base under the <code>bases</code> directory.</p>
</li>
<li>
<p><code>:namespaces</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:src</code> Lists all the namespaces that live under the src directory.</p>
<div class="ulist">
<ul>
<li>
<p><code>:file-path</code> The absolute path to the namespace.</p>
</li>
<li>
<p><code>:imports</code> Lists all its namespaces.</p>
</li>
<li>
<p><code>:is-invalid</code> Set to <code>true</code> if the namespace is missing or if the file can&#8217;t be parsed.</p>
</li>
<li>
<p><code>:name</code> The name of the namespace where top namespace + base name (<code>se.example</code> + <code>user-api</code> in this case) have been stripped away.</p>
</li>
<li>
<p><code>:namespace</code> The full name of the namespace.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:test</code> Lists all the namespaces that live under the test directory (same keys as for the <code>:src</code>).</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:non-top-namespace</code> If the base contains any non-top namespaces, they will be stored in a vector with elements like this:</p>
<div class="ulist">
<ul>
<li>
<p><code>{:non-top-ns "com.wrong", :file "bases/cli/src/com/wrong/cli/interface.clj"}</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:paths</code> The paths that are specified in its <code>deps.edn</code> file
(paths for <code>src</code> and <code>resources</code> paths + <code>aliases &gt; :test &gt; :extra-paths</code> for test paths).</p>
</li>
<li>
<p><code>:type</code> Set to "base".</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="changes"><a class="link" href="#changes">changes</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:changes since:b339c35</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:changed-bases ["cli" "user-api"],
 :changed-components ["user" "user-remote"],
 :changed-files ["bases/cli/deps.edn"
                 "bases/cli/resources/cli/.keep"
                 "bases/cli/src/se/example/cli/core.clj"
                 "bases/cli/test/se/example/cli/core_test.clj"
                 "bases/user-api/deps.edn"
                 "bases/user-api/resources/user-api/.keep"
                 "bases/user-api/src/se/example/user_api/api.clj"
                 "bases/user-api/src/se/example/user_api/core.clj"
                 "bases/user-api/test/se/example/user_api/core_test.clj"
                 "components/user-remote/deps.edn"
                 "components/user-remote/resources/user-remote/.keep"
                 "components/user-remote/src/se/example/user/core.clj"
                 "components/user-remote/src/se/example/user/interface.clj"
                 "components/user-remote/test/se/example/user/interface_test.clj"
                 "components/user/deps.edn"
                 "components/user/resources/user/.keep"
                 "components/user/src/se/example/user/core.clj"
                 "components/user/src/se/example/user/interface.clj"
                 "components/user/test/se/example/user/interface_test.clj"
                 "deps.edn"
                 "development/src/dev/lisa.clj"
                 "projects/command-line/deps.edn"
                 "projects/command-line/test/project/command_line/dummy_test.clj"
                 "projects/user-service/deps.edn"
                 "readme.txt"
                 "scripts/build-cli-uberjar.sh"
                 "scripts/build-uberjar.sh"
                 "scripts/build-user-service-uberjar.sh"
                 "workspace.edn"],
 :changed-or-affected-projects ["command-line" "development" "user-service"],
 :changed-projects ["command-line" "development" "user-service"],
 :git-diff-command "git diff b339c35 --name-only",
 :since "b339c35",
 :since-sha "b339c35"}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>:changed-bases</code> Lists the changed bases since the sha <code>b339c35</code> (or last stable point in time if <code>:since</code> is not given).</p>
</li>
<li>
<p><code>:changed-components</code> Lists the changed components since the sha <code>b339c35</code> (or last stable point in time if <code>:since</code> is not given).</p>
</li>
</ul>
</div>
<div id="changed-files" class="ulist">
<ul>
<li>
<p><code>:changed-files</code> The same list that is returned by <code>poly diff since:b339c35</code>.
The keys <code>:changed-bases</code>, <code>:changed-components</code> and <code>:changed-projects</code> are calculated from this list.</p>
</li>
<li>
<p><code>:changed-or-affected-projects</code> Lists the projects that are directly or indirectly changed.
A project will be marked as changed if a file in its project directory has changed, or if a file in the bricks it includes has changed.</p>
</li>
<li>
<p><code>:changed-projects</code> Lists the changed projects since the sha <code>b339c35</code> (or last stable point in time if <code>:since</code> is not given).</p>
</li>
<li>
<p><code>:git-diff-command</code> The git command that was executed to calculate the <code>:changed-files</code> list.</p>
</li>
<li>
<p><code>:since</code> Set to "stable" if <code>since:SINCE</code> is not given.</p>
</li>
<li>
<p><code>:since-sha</code> The full sha if <code>since:SINCE</code> was not given, e.g. <code>b339c358079fa36ca20ed0163708ba010a0ffd4c</code>.</p>
</li>
<li>
<p><code>:since-tag</code> The name of the tag, e.g. <code>0.1.0-alpha9</code> if <code>since:release</code> was given.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="components"><a class="link" href="#components">components</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:components:user</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:interface {:definitions [{:name "hello",
                            :arglists [{:name "name"}],
                            :type "function"}],
             :name "user"},
 :interface-deps {:src [], :test []},
 :lib-deps {},
 :lib-imports {:test ["clojure.test"]},
 :lines-of-code {:src 9, :test 7},
 :name "user",
 :namespaces {:src [{:file-path "/Users/joakimtengstrand/source/polylith/examples/doc-example/components/user/src/se/example/user/interface.clj",
                     :imports ["se.example.user.core"],
                     :name "interface",
                     :namespace "se.example.user.interface"}
                    {:file-path "/Users/joakimtengstrand/source/polylith/examples/doc-example/components/user/src/se/example/user/core.clj",
                     :imports [],
                     :name "core",
                     :namespace "se.example.user.core"}],
              :test [{:file-path "/Users/joakimtengstrand/source/polylith/examples/doc-example/components/user/test/se/example/user/interface_test.clj",
                      :imports ["clojure.test" "se.example.user.interface"],
                      :name "interface-test",
                      :namespace "se.example.user.interface-test"}]},
 :paths {:src ["src" "resources"], :test ["test"]},
 :type "component"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Component keys are the same as for the base plus the <code>:interfaces</code> key, except that it doesn&#8217;t have <code>:base-deps</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>:interface</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:definitions</code> Lists all public <code>def</code>, <code>defn</code> and <code>defmacro</code> definitions in the interface namespace.
If a type hint is given, then <code>:type</code> will also be set and be part of the contract.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:illegal-deps</code> A vector of illegal dependencies. Populated if the component depends on something else than interfaces, from the :src context (:test has no restrictions).</p>
<div class="ulist">
<ul>
<li>
<p><code>:from-ns</code> The name of the namespace where we refer the incorrect namespace.</p>
</li>
<li>
<p><code>:to-brick-id</code> The interface name or base name we depend on.</p>
</li>
<li>
<p><code>:to-namespace</code> The namespace we depend on.</p>
</li>
<li>
<p><code>:to-type</code> Set to the type of the brick we depend on ("base" or "component").</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:interface-deps</code> Lists the interfaces this base depends on.
Here it depends on the <code>user</code> interface from the <code>src</code> context.
This is because the <code>se.example.user-api.api</code> namespace imports <code>se.example.user.interface</code>.<br>
No interfaces are imported from the test context in this example.</p>
</li>
<li>
<p><code>:keep-lib-versions</code> A vector containing the library names that should not be affected when executing <code>poly libs :update</code>. Configured in workspace.edn under <code>:bricks</code>.</p>
</li>
<li>
<p><code>:lib-deps</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:src</code> A map with the libraries that are used in this component&#8217;s src context.</p>
<div class="ulist">
<ul>
<li>
<p><code>:latest-version</code> Set if there is a newer version of this library, except if <a href="#keep-lib-versions">:keep-lib-versions</a> is set for this library. Calculated if <code>:outdated</code> is given for any command, or if <code>:update</code> is given for the libs command.</p>
</li>
<li>
<p><code>:size</code> The size of this library in bytes.</p>
</li>
<li>
<p><code>:type</code> The type of the library, "maven", "local" or "git" (<code>:mvn/version</code>, <code>:local/root</code> and <code>:git/url</code>).</p>
</li>
<li>
<p><code>:version</code> The library version:</p>
<div class="ulist">
<ul>
<li>
<p>if type is <code>maven</code> then version is set to <code>groupId/artifactId</code>.</p>
</li>
<li>
<p>if type is <code>local</code> then the version key is excluded (a <code>-</code> is shown in the output from the <a href="#libs">libs</a> command).</p>
</li>
<li>
<p>if type is <code>git</code> then the version is set to the first seven characters in the <code>sha</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>:test</code> A map with the libraries that are used in this base&#8217;s test context. Follows the same structure as the <code>:src</code> context.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:lib-imports</code> The name is a bit misleading as internal namespaces for the base is also included.</p>
<div class="ulist">
<ul>
<li>
<p><code>src</code> Lists all imports from the src context except component interfaces.</p>
</li>
<li>
<p><code>test</code> Lists all imports from the test context except component interfaces.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:lines-of-code</code> The total number of lines of code for this base (all namespaces included).</p>
</li>
<li>
<p><code>:name</code> The name of the directory for this base under the <code>bases</code> directory.</p>
</li>
<li>
<p><code>:namespaces</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:src</code> Lists all the namespaces that live under the src directory.</p>
<div class="ulist">
<ul>
<li>
<p><code>:file-path</code> The absolute path to the namespace.</p>
</li>
<li>
<p><code>:imports</code> Lists all its namespaces.</p>
</li>
<li>
<p><code>:is-invalid</code> Set to <code>true</code> if the namespace is missing or if the file can&#8217;t be parsed.</p>
</li>
<li>
<p><code>:name</code> The name of the namespace where top namespace + base name (<code>se.example</code> + <code>user-api</code> in this case) have been stripped away.</p>
</li>
<li>
<p><code>:namespace</code> The full name of the namespace.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:test</code> Lists all the namespaces that live under the test directory (same keys as for the <code>:src</code>).</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:non-top-namespace</code> If the base contains any non-top namespaces, they will be stored in a vector with elements like this:</p>
<div class="ulist">
<ul>
<li>
<p>{<code>:non-top-ns</code> "com.wrong", <code>:file</code> "bases/cli/src/com/wrong/cli/interface.clj"}</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:paths</code> The paths that are specified in its <code>deps.edn</code> file (paths for <code>src</code> and <code>resources</code> paths + <code>aliases &gt; :test &gt; :extra-paths</code> for test paths).</p>
</li>
<li>
<p><code>:type</code> Set to "base".</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configs"><a class="link" href="#configs">configs</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:configs</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:bases [{:deps {:aliases {:test {:extra-deps {}, :extra-paths ["test"]}},
                 :deps {},
                 :paths ["src" "resources"]},
          :name "cli",
          :type "base"}
         {:deps {:aliases {:test {:extra-deps {}, :extra-paths ["test"]}},
                 :deps {slacker/slacker {:mvn/version "0.17.0"}},
                 :paths ["src" "resources"]},
          :name "user-api",
          :type "base"}],
 :components [{:deps {:aliases {:test {:extra-deps {}, :extra-paths ["test"]}},
                      :deps {},
                      :paths ["src" "resources"]},
               :name "user",
               :type "component"}
              {:deps {:aliases {:test {:extra-deps {}, :extra-paths ["test"]}},
                      :deps {compojure/compojure {:mvn/version "1.6.2"},
                             http-kit/http-kit {:mvn/version "2.4.0"},
                             ring/ring {:mvn/version "1.8.1"},
                             slacker/slacker {:mvn/version "0.17.0"}},
                      :paths ["src" "resources"]},
               :name "user-remote",
               :type "component"}],
 :projects [{:deps {:aliases {:test {:extra-deps {}, :extra-paths ["test"]},
                              :uberjar {:main se.example.cli.core}},
                    :deps {org.apache.logging.log4j/log4j-core {:mvn/version "2.13.3"},
                           org.apache.logging.log4j/log4j-slf4j-impl {:mvn/version "2.13.3"},
                           org.clojure/clojure {:mvn/version "1.11.1"},
                           poly/cli {:local/root "../../bases/cli"},
                           poly/user-remote {:local/root "../../components/user-remote"}}},
             :name "command-line",
             :type "project"}
            {:deps {:aliases {:+default {:extra-deps {poly/user {:local/root "components/user"}},
                                         :extra-paths ["components/user/test"]},
                              :+remote {:extra-deps {poly/user-remote {:local/root "components/user-remote"}},
                                        :extra-paths ["components/user-remote/test"]},
                              :build {:deps {io.github.clojure/tools.build {:mvn/version "0.9.5"},
                                             io.github.seancorfield/build-uber-log4j2-handler {:git/sha "55fb6f6",
                                                                                               :git/tag "v0.1.5"},
                                             org.clojure/tools.deps {:mvn/version "0.16.1281"}},
                                      :ns-default build,
                                      :paths ["build/resources"]},
                              :dev {:extra-deps {org.apache.logging.log4j/log4j-core {:mvn/version "2.13.3"},
                                                 org.apache.logging.log4j/log4j-slf4j-impl {:mvn/version "2.13.3"},
                                                 org.clojure/clojure {:mvn/version "1.11.1"},
                                                 poly/cli {:local/root "bases/cli"},
                                                 poly/user-api {:local/root "bases/user-api"}},
                                    :extra-paths ["development/src"]},
                              :poly {:extra-deps {polylith/clj-poly {:mvn/version "0.2.18"}},
                                     :main-opts ["-m"
                                                 "polylith.clj.core.poly-cli.core"]},
                              :test {:extra-paths ["bases/cli/test"
                                                   "bases/user-api/test"
                                                   "projects/command-line/test"]}}},
             :name "development",
             :type "project"}
            {:deps {:aliases {:test {:extra-deps {}, :extra-paths []},
                              :uberjar {:main se.example.user-api.core}},
                    :deps {org.apache.logging.log4j/log4j-core {:mvn/version "2.13.3"},
                           org.apache.logging.log4j/log4j-slf4j-impl {:mvn/version "2.13.3"},
                           org.clojure/clojure {:mvn/version "1.11.1"},
                           poly/user {:local/root "../../components/user"},
                           poly/user-api {:local/root "../../bases/user-api"}}},
             :name "user-service",
             :type "project"}],
 :user {:color-mode "dark", :empty-character ".", :thousand-separator ","},
 :workspace {:compact-views #{},
             :default-profile-name "default",
             :interface-ns "interface",
             :tag-patterns {:release "v[0-9]*", :stable "stable-*"},
             :top-namespace "se.example",
             :vcs {:auto-add true, :name "git"}}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>These attributes are described in the <a href="#">Configuration</a> section.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="interfaces"><a class="link" href="#interfaces">interfaces</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:interfaces:user</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:definitions [{:name "hello",
                :arglists [{:name "name"}],
                :type "function"}],
 :implementing-components ["user" "user-remote"],
 :name "user",
 :type "interface"}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>:definitions</code> A list of the public <code>def</code>, <code>defn</code> and <code>defmacro</code> definitions that are part of the interface.</p>
<div class="ulist">
<ul>
<li>
<p><code>:name</code> the name of the <code>def</code>, <code>defn</code> or <code>defmacro</code> definition.
If it&#8217;s a multi-arity function or macro, then each arity will be stored separately.</p>
</li>
<li>
<p><code>:arglists</code> Set for functions and macros.
Specifies the function/macro arguments:</p>
<div class="ulist">
<ul>
<li>
<p><code>:name</code> The name of the argument.</p>
</li>
<li>
<p><code>:type</code> If a type hint, e.g. <code>^String</code> is given, then this attribute is set.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:type</code> Set to "data", "function" or "macro".</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:name</code> The name of the interface.
In this case the bricks <code>user</code> and <code>user-remote</code> share the same <code>user</code> interface and live in the <code>se.example.user.interface</code> namespace.</p>
</li>
<li>
<p><code>:type</code> Set to "interface".</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="messages"><a class="link" href="#messages">messages</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:messages</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">[{:code 103,
  :message "Missing definitions in user's interface: hello[name]",
  :colorized-message "Missing definitions in user's interface: hello[name]",
  :components ["user"],
  :type "error"}]</code></pre>
</div>
</div>
<div class="paragraph">
<p>To trigger this error, we commented out the hello function from the user component interface.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>:code</code> The code of the error or warning.
To get a full list of existing codes, execute poly help check.</p>
</li>
<li>
<p><code>:message</code> The error message.</p>
</li>
<li>
<p><code>:colorized-message</code> The error message using colors so the text can be printed in color.</p>
</li>
<li>
<p><code>:components</code> Each error message can have extra keys/information, like affected components as in this case.</p>
</li>
<li>
<p><code>:type</code> Set to "error" or "warning".</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="name"><a class="link" href="#name">name</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:name</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">"doc-example"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The name of the workspace directory.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="old"><a class="link" href="#old">old</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:old ws-file:ws.edn</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:user-input {:args ["ws" "out:ws.edn"],
              :cmd "ws",
              :is-all `true`,
              :is-dev false,
              :is-latest-sha false,
              :is-no-exit false,
              :is-run-all-brick-tests false,
              :is-run-project-tests false,
              :is-search-for-ws-dir false,
              :is-show-brick false,
              :is-show-loc false,
              :is-show-project false,
              :is-show-resources false,
              :is-show-workspace false,
              :is-verbose false,
              :out "ws.edn",
              :selected-profiles #{},
              :selected-projects #{},
              :unnamed-args []}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the workspace is loaded using <code>ws-file:WS-FILE</code> then the <code>:old</code> key is populated.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>user-input</code> The user input from the original ws file.</p>
</li>
<li>
<p><code>:active-profiles</code> If any profiles are given, then this key is added with the value of <code>:active-profiles</code> taken from the <code>:settings</code> key from the original ws file.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="paths"><a class="link" href="#paths">paths</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:paths</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:existing ["bases/cli/resources"
            "bases/cli/src"
            "bases/cli/test"
            "bases/user-api/resources"
            "bases/user-api/src"
            "bases/user-api/test"
            "components/user-remote/resources"
            "components/user-remote/src"
            "components/user-remote/test"
            "components/user/resources"
            "components/user/src"
            "components/user/test"
            "development/src"
            "projects/command-line/test"],
 :on-disk ["bases/cli/resources"
           "bases/cli/src"
           "bases/cli/test"
           "bases/user-api/resources"
           "bases/user-api/src"
           "bases/user-api/test"
           "components/user-remote/resources"
           "components/user-remote/src"
           "components/user-remote/test"
           "components/user/resources"
           "components/user/src"
           "components/user/test"
           "projects/command-line/test"],
 :missing []}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>:existing</code> All existing paths in the workspace that are used in bricks, projects, and profiles.</p>
</li>
<li>
<p><code>:on-disk</code> All paths to directories within the workspace.</p>
</li>
<li>
<p><code>:missing</code> All missing paths in the workspace that are used in bricks, projects, and profiles but don&#8217;t exist on disk.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="profiles"><a class="link" href="#profiles">profiles</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:profiles:default</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:base-names [],
 :component-names ["image-creator" "system"],
 :lib-deps {},
 :name "default",
 :paths ["components/image-creator/src" "components/system/src"],
 :project-names [],
 :type "profile"}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>:base-names</code> The bases that are referenced from the specified paths.</p>
</li>
<li>
<p><code>:component-names</code> The components that are referenced from the specified paths.</p>
</li>
<li>
<p><code>:lib-deps</code> The library dependencies specified by the key <code>:extra-deps</code>.</p>
</li>
<li>
<p><code>:name</code> the profile name, taken from an alias name that starts with a <code>+</code> in <code>./deps.edn</code>.</p>
</li>
<li>
<p><code>:paths</code> The paths specified by the key <code>:extra-paths</code>.</p>
</li>
<li>
<p><code>:project-names</code> The projects that are referenced from the specified paths.</p>
</li>
<li>
<p><code>:type</code> Set to "profile".</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="projects"><a class="link" href="#projects">projects</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:projects:user-service</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:alias "user-s",
 :base-names {:src ["user-api"], :test ["user-api"]},
 :bricks-to-test ["user" "user-api"],
 :component-names {:src ["user"], :test ["user"]},
 :deps {"user" {:src {}, :test {}},
        "user-api" {:src {:direct ["user"]}, :test {:direct ["user"]}}},
 :deps-filename "examples/doc-example/projects/user-service/deps.edn",
 :indirect-changes {:src [], :test []},
 :is-dev false,
 :lib-deps {:src {"org.apache.logging.log4j/log4j-core" {:size 1714164,
                                                         :type "maven",
                                                         :version "2.13.3"},
                  "org.apache.logging.log4j/log4j-slf4j-impl" {:size 23590,
                                                               :type "maven",
                                                               :version "2.13.3"},
                  "org.clojure/clojure" {:size 4105111,
                                         :type "maven",
                                         :version "1.11.1"},
                  "slacker/slacker" {:size 28408,
                                     :type "maven",
                                     :version "0.17.0"}}},
 :lib-imports {:src ["se.example.user-api.api" "slacker.server"],
               :test ["clojure.test" "se.example.user-api.core"]},
 :lines-of-code {:src 0, :test 0, :total {:src 44, :test 26}},
 :maven-repos {"central" {:url "https://repo1.maven.org/maven2/"},
               "clojars" {:url "https://repo.clojars.org/"}},
 :name "user-service",
 :namespaces {},
 :paths {:src ["bases/user-api/resources"
               "bases/user-api/src"
               "components/user/resources"
               "components/user/src"],
         :test ["bases/user-api/test" "components/user/test"]},
 :project-dir "examples/doc-example/projects/user-service",
 :project-lib-deps {:src {"org.apache.logging.log4j/log4j-core" {:size 1714164,
                                                                 :type "maven",
                                                                 :version "2.13.3"},
                          "org.apache.logging.log4j/log4j-slf4j-impl" {:size 23590,
                                                                       :type "maven",
                                                                       :version "2.13.3"},
                          "org.clojure/clojure" {:size 4105111,
                                                 :type "maven",
                                                 :version "1.11.1"}},
                    :test {}},
 :projects-to-test [],
 :test {:create-test-runner [polylith.clj.core.clojure-test-test-runner.interface/create]},
 :type "project"}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>:alias</code> The project alias, specified in the project&#8217;s config.edn file.</p>
</li>
<li>
<p><code>:base-names</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:src</code> The bases that are included in the project for the <code>src</code> context, either as paths or included as <code>:local/root</code>.</p>
</li>
<li>
<p><code>:test</code> The bases that are included in the project for the <code>test</code> context, either as paths or included as <code>:local/root</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:bricks-to-test</code> A vector with the bricks to test from this project if executing the <a href="#test">test</a> command.</p>
</li>
<li>
<p><code>:component-names</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:src</code> The components that are included in the project for the <code>src</code> context, either as paths or included as <code>:local/root</code>.</p>
</li>
<li>
<p><code>:test</code> The components that are included in the project for the <code>test</code> context, either as paths or included as <code>:local/root</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:deps</code> A map with brick names as keys where each brick contains:</p>
<div class="ulist">
<ul>
<li>
<p><code>:src</code> Keeps track of the dependencies from the <code>:src</code> context.</p>
<div class="ulist">
<ul>
<li>
<p><code>:direct</code> A vector with the direct dependencies, from the <code>:src</code> directory, to components (component names).</p>
</li>
<li>
<p><code>:indirect</code> A vector with the indirect dependencies, from the <code>:src</code> directory, to components (component names).</p>
</li>
<li>
<p><code>:circular</code> A vector with the circular dependency chain, translated to the components in the project, e.g. ["a" "b" "c" "a"] from the <code>:src</code> directory.</p>
</li>
<li>
<p><code>:missing-ifc-and-bases</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:direct</code> A vector containing missing interface and base names, that are directly accessed from the <code>:src</code> directory.</p>
</li>
<li>
<p><code>:indirect</code> A vector containing missing interface and base names, that are indirectly accessed from the <code>:src</code> directory.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>:test</code> Keeps track of the dependencies from the <code>:test</code> context, with the same set of keys as the <code>:src</code> context.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:deps-filename</code> The absolute path to the <code>deps.edn</code> config file.</p>
</li>
<li>
<p><code>:indirect-changes</code> A vector of the bricks that are indirectly changed (directly changed bricks excluded).
E.g. if components <code>a</code> and <code>b</code> are included in the project, and <code>a</code> has not changed, but <code>b</code> has changed and <code>a</code> uses <code>b</code>, then <code>b</code> will be included in this vector.</p>
</li>
<li>
<p><code>:is-dev</code> Set to <code>true</code> for the development project.</p>
</li>
<li>
<p><code>:keep-lib-versions</code> A vector containing the library names that should not be affected when executing <code>poly libs :update</code>. Configured in the project&#8217;s config.edn file.</p>
</li>
<li>
<p><code>:lib-deps</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:src</code> Stores a map with the libraries that are used in the project for the src context. Contains libraries that are specified by the project and the included bricks.</p>
<div class="ulist">
<ul>
<li>
<p><code>:latest-version</code> Set if there is a newer version of this library, except if <a href="#keep-lib-versions">:keep-lib-versions</a> is set for this library. Calculated if <code>:outdated</code> is given for any command, or if <code>:update</code> is given for the libs command.</p>
</li>
<li>
<p><code>:size</code> The size of this library in bytes.</p>
</li>
<li>
<p><code>:type</code> The type of the library, "maven", "local" or "git" (<code>:mvn/version</code>, <code>:local/root</code> and <code>:git/url</code>).</p>
</li>
<li>
<p><code>:version</code> The library version:</p>
<div class="ulist">
<ul>
<li>
<p>if type is <code>maven</code> then version is set to <code>groupId/artifactId</code>.</p>
</li>
<li>
<p>if type is <code>local</code> then the version key is excluded (a <code>-</code> is shown in the output from the <a href="#libs">libs</a> command).</p>
</li>
<li>
<p>if type is <code>git</code> then the version is set to the first seven characters in the <code>sha</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>:test</code> A map with the libraries that are used in the project for the test context. Follows the same structure as the <code>:src</code> context.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:lib-imports</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:src</code> All <code>:lib-imports</code> taken from the bricks that are included in this project for the <code>src</code> context.</p>
</li>
<li>
<p><code>:test</code> All <code>:lib-imports</code> taken from the bricks that are included in this project for the <code>test</code> context.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:lines-of-code</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:src</code> Number of lines of code living in the project&#8217;s <code>src</code> directory.</p>
</li>
<li>
<p><code>:test</code> Number of lines of code living in the project&#8217;s <code>test</code> directory.</p>
</li>
<li>
<p><code>:total</code> The total number of lines of code for all the bricks that are included in this project.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:maven-repos</code> The maven repos that are used by this project.
If <code>:mvn/repos</code> is specified by a brick that is included in this project, then it will automatically turn up in this list.</p>
</li>
<li>
<p><code>:name</code> The name of the project directory under the <code>projects</code> directory.</p>
</li>
<li>
<p><code>:namespaces</code> If the project has a <code>test</code> and/or <code>src</code> directory, then the included namespaces are listed here.</p>
<div class="ulist">
<ul>
<li>
<p><code>:src</code> Lists all the namespaces that live under the src directory.</p>
<div class="ulist">
<ul>
<li>
<p><code>:file-path</code> The absolute path to the namespace.</p>
</li>
<li>
<p><code>:imports</code> Lists all its namespaces.</p>
</li>
<li>
<p><code>:is-invalid</code> Set to <code>true</code> if the namespace is missing or if the file can&#8217;t be parsed.</p>
</li>
<li>
<p><code>:name</code> The name of the namespace where top namespace + component name (<code>se.example</code> + <code>user</code> in this case) are stripped away.</p>
</li>
<li>
<p><code>namespace</code> The full name of the namespace.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:test</code> Lists all the namespaces that live under the <code>test</code> directory (same keys as for the <code>:src</code>).</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:necessary</code> If we get <a href="#error111">Error 111 - Unreadable namespace in brick/project</a> and know that the brick(s) has to be included in the project, then we can add the necessary bricks(s) to a vector in the project&#8217;s config.edn for this key.</p>
</li>
<li>
<p><code>:paths</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:src</code> Lists the paths that are either explicitly defined as paths or implicitly defined as <code>:local/root</code> bricks, for the <code>src</code> context.</p>
</li>
<li>
<p><code>:test</code> Lists the paths that are either explicitly defined as paths or implicitly defined as <code>:local/root</code> bricks, for the <code>test</code> context.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:project-dir</code> The absolute path to the project directory.</p>
</li>
<li>
<p><code>:project-lib-deps</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:src</code> Stores a map with the libraries that are specified by the project for the src context.</p>
<div class="ulist">
<ul>
<li>
<p><code>:latest-version</code> Set if there is a newer version of this library, except if <a href="#keep-lib-versions">:keep-lib-versions</a> is set for this library. Calculated if <code>:outdated</code> is given for any command, or if <code>:update</code> is given for the libs command.</p>
</li>
<li>
<p><code>:size</code> The size of this library in bytes.</p>
</li>
<li>
<p><code>:type</code> The type of the library, "maven", "local" or "git" (<code>:mvn/version</code>, <code>:local/root</code> and <code>:git/url</code>).</p>
</li>
<li>
<p><code>:version</code> The library version:</p>
<div class="ulist">
<ul>
<li>
<p>if type is <code>maven</code> then version is set to <code>groupId/artifactId</code>.</p>
</li>
<li>
<p>if type is <code>local</code> then the version key is excluded (a <code>-</code> is shown in the output from the <a href="#libs">libs</a> command).</p>
</li>
<li>
<p>if type is <code>git</code> then the version is set to the first seven characters in the <code>sha</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>:test</code> A map with the libraries that are used in the project for the test context. Follows the same structure as the <code>:src</code> context.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:projects-to-test</code> A vector with the projects to test from this project if executing the <a href="#test">test</a> command.</p>
</li>
<li>
<p><code>:test</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:exclude</code> Specifies which brick should be excluded when running the test command.</p>
</li>
<li>
<p><code>:include</code> Specifies which bricks should be included when running the test command.
Empty if no bricks, missing if all bricks.</p>
</li>
<li>
<p><code>:create-test-runner</code> A vector with one or more test runners, see <a href="#create-test-runner">create test runner</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:type</code> Set to "project".</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="settings"><a class="link" href="#settings">settings</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:settings</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:active-profiles #{"default"},
 :color-mode "dark",
 :compact-views #{},
 :default-profile-name "default",
 :empty-character ".",
 :interface-ns "interface",
 :m2-dir "/Users/joakimtengstrand/.m2",
 :tag-patterns {:release "v[0-9]*", :stable "stable-*"},
 :thousand-separator ",",
 :top-namespace "polylith.clj.core",
 :user-config-filename "/Users/joakimtengstrand/.config/polylith/config.edn",
 :user-home "/Users/joakimtengstrand",
 :vcs {:auto-add false,
       :branch "issue-315",
       :git-root "/Users/joakimtengstrand/source/polylith",
       :is-git-repo true,
       :name "git",
       :polylith {:branch "master",
                  :repo "https://github.com/polyfy/polylith.git"},
       :stable-since {:sha "15453ebc5a86f52ee1c75ec52ebb19da4b113c30",
                      :tag "stable-master"}}}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>:active-profiles</code> If any profiles are defined in <code>./deps.edn</code> then the active profiles(s) are listed here.</p>
</li>
</ul>
</div>
<div id="color-mode" class="ulist">
<ul>
<li>
<p><code>:color-mode</code> The color mode specified in <code>~/.config/polylith/config.edn</code>.</p>
</li>
<li>
<p><code>:compact-views</code> The set of views that should be shown in a more compact way, specified in <code>workspace.edn</code>.</p>
</li>
<li>
<p><code>:default-profile-name</code> The name of the default profile name, specified in <code>workspace.edn</code>.</p>
</li>
<li>
<p><code>:empty-character</code> The character used to represent empty space in output from e.g. the libs command, specified in <code>workspace.edn</code>.</p>
</li>
<li>
<p><code>:interface-ns</code> The name of the namespace/package that is used to represent interfaces, specified in <code>workspace.edn</code>.</p>
</li>
<li>
<p><code>:m2-dir</code> Maven user root directory.
Set to "~/.m2" by default, but can be overridden in <code>~/.config/polylith/config.edn</code>.</p>
</li>
<li>
<p><code>:tag-patterns</code> The tag patterns that are specified in <code>workspace.edn</code>.</p>
</li>
<li>
<p><code>:test</code> Global test configuration used as basis for project test configuration (projects will use these settings and override it with its own settings).</p>
<div class="ulist">
<ul>
<li>
<p><code>:exclude</code> Specifies which brick should be excluded when running the test command.</p>
</li>
<li>
<p><code>:include</code> Specifies which bricks should be included when running the test command.
Empty if no bricks, missing if all bricks.</p>
</li>
<li>
<p><code>:create-test-runner</code> A vector with one or more test runners, see <a href="#create-test-runner">create test runner</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:thousand-separator</code> Used by numbers &gt;= 1000 (e.g. the KB column in the libs command) specified in <code>~/.config/polylith/config.edn</code>.</p>
</li>
<li>
<p><code>:top-namespace</code> The top namespace for the workspace, specified in <code>workspace.edn</code>.</p>
</li>
<li>
<p><code>:user-config-filename</code> The full path to the user config filename.</p>
</li>
<li>
<p><code>:user-home</code> The user home, specified by the user.home environment variable.</p>
</li>
<li>
<p><code>vcs</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:auto-add</code> Set to <code>true</code> if files and directories created by the create command should be automatically added to git.
Specified in <code>workspace.edn</code>.</p>
</li>
<li>
<p><code>:branch</code> The name of the git branch.</p>
</li>
<li>
<p><code>:git-root</code> The root of the git repository.</p>
</li>
<li>
<p><code>:name</code> Set to "git".</p>
</li>
<li>
<p><code>:polylith</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:branch</code> Set to <code>master</code> or <code>BRANCH</code> if <code>branch:BRANCH</code> is given.
The branch is used when calculating the latest sha in <code>./deps.edn</code> for the key <code>:aliases &gt; :poly &gt; :extra-deps &gt; sha</code>.</p>
</li>
<li>
<p><code>:repo</code> Set to "https://github.com/polyfy/polylith.git".</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:stable-since</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:sha</code> The latest stable point in time.</p>
</li>
<li>
<p><code>:tag</code> The tag for the latest stable point in time (if exists).</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="user-input"><a class="link" href="#user-input">user-input</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:user-input</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:args ["ws" "get:user-input"]
 :cmd "ws"
 :is-all false
 :is-commit false
 :is-compact false
 :is-dev false
 :is-fake-poly false
 :is-github false
 :is-hide-lib-size false
 :is-latest-sha false
 :is-local false
 :is-no-changes false
 :is-no-exit false
 :is-outdated false
 :is-run-all-brick-tests false
 :is-run-project-tests false
 :is-search-for-ws-dir false
 :is-shell false
 :is-show-brick false
 :is-show-loc false
 :is-show-project false
 :is-show-resources false
 :is-show-workspace false
 :is-swap-axes false
 :is-tap false
 :is-update false
 :is-verbose false
 :selected-profiles #{}
 :selected-projects #{}
 :unnamed-args []}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We also have a number of arguments that are only populated if they are passed in as an argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:branch "master"
 :changed-files ["images/doc.png" "workspace.edn"]
 :color-mode "none"
 :help "info"
 :dir "../clojure-polylith-realworld-example-app"
 :fake-sha "c91fdad"
 :fake-tag "stable-lisa"
 :file "usermanager.edn"
 :get "user-input"
 :interface "user"
 :is-git-add true
 :libraries ["org.clojure/clojure"]
 :more ["blog-posts" "how-polylith-came-to-life"]
 :out "example.edn"
 :page "naming"
 :replace [{:from "this", :to "that"}]
 :selected-bricks ["user"]
 :since "previous-release"
 :skip ["dev"]
 :top-ns "se.example"
 :with ["default"]
 :ws "settings"
 :ws-dir "examples/doc-example"
 :ws-file "realworld.edn"
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>:args</code> The arguments to the <code>poly</code> tool where the first argument is the command.</p>
</li>
<li>
<p><code>:branch</code> Used in the <a href="#create-workspace">create workspace</a> command to give the branch, otherwise the workspace will be created in the <code>main</code> branch.</p>
</li>
<li>
<p><code>:changed-files</code> Overrides the real <a href="#changed-files">changed-files</a> that is retrieved from a git.</p>
</li>
<li>
<p><code>:cmd</code> The first argument to the <code>poly</code> tool.</p>
</li>
<li>
<p><code>:color-mode</code> Overrides the <a href="#color-mode">color-mode</a>.</p>
</li>
<li>
<p><code>:dir</code> Used by the <a href="#switch-ws">switch-ws</a> command.</p>
</li>
<li>
<p><code>:fake-sha</code> Overrides the "stable since" <code>sha</code> in the output from the <a href="#info">info</a> command.
Used when taking screenshots for this documentation.</p>
</li>
<li>
<p><code>:fake-tag</code> Sets the tag (or clears it if "") used by the <a href="#info">info</a> command.
Sometimes used when taking screenshots for this documentation.</p>
</li>
<li>
<p><code>:file</code> Used by the <a href="#switch-ws">switch-ws</a> command.</p>
</li>
<li>
<p><code>:get</code> Used by the <a href="#ws">ws</a> command.</p>
</li>
<li>
<p><code>:help</code> Used by the <a href="#doc">doc</a> command.</p>
</li>
<li>
<p><code>:interface</code> Used by the <a href="#create-component">create component</a> command.</p>
</li>
<li>
<p><code>:is-all</code> Set to <code>true</code> if <code>:all</code> is given.</p>
</li>
<li>
<p><code>:is-commit</code> Set to <code>true</code> if <code>:commit</code> is given.</p>
</li>
<li>
<p><code>:is-compact</code> Set to <code>true</code> if <code>:compact</code> is given.
Used in combination with the <code>libs</code> and <code>deps</code> commands.</p>
</li>
<li>
<p><code>:is-dev</code> Set to <code>true</code> if <code>:dev</code> is given.</p>
</li>
<li>
<p><code>:is-fake-poly</code> Set to <code>true</code> if <code>:fake-poly</code> is given.
Used when using the <code>polyx</code> tool with the <code>help</code> command,
and when starting a <code>shell</code> with <code>poly shell :fake-poly</code> where the latter will show e.g. "poly 0.2.18" as version, instead of e.g. "polyx 0.2.18-SNAPSHOT".</p>
</li>
<li>
<p><code>:is-git-add</code> Used by the <a href="#create-component">create component</a>, <a href="#create-base">create base</a> and <a href="#create-project">create project</a> commands to add created files to git.
Has the same effect for current command as if <code>:vcs &gt; :auto-add</code> was set to <code>true</code> in <code>workspace.edn</code>.</p>
</li>
<li>
<p><code>:is-github</code> Set to <code>true</code> if <code>:github</code> is given.
Used by the <a href="#doc">doc</a> command to open the corresponding page on GitHub.</p>
</li>
<li>
<p><code>:is-hide-lib-size</code> Set to <code>true</code> if <code>:is-hide-lib-size</code> is given. Used by the tests to show <code>-</code> instead the of size of the libraries in the <code>libs</code> command, to protect tests from failing if a library hasn&#8217;t been downloaded yet.</p>
</li>
<li>
<p><code>:is-latest-sha</code> Set to <code>true</code> if <code>:latest-sha</code> is given.</p>
</li>
<li>
<p><code>:is-local</code> Set to <code>true</code> if <code>:local</code> is given.
If set, the <a href="#doc">doc</a> command will use <code>localhost</code> instead of <code>cljdoc.org</code>, when opening cljdoc pages.
The <code>:local</code> argument can also be passed in when starting a <a href="#shell">shell</a>.</p>
</li>
<li>
<p><code>:is-no-changes</code> Set to <code>true</code> if <code>:no-changes</code> is given.
Used to fake that no changes have been made since the last stable point in time.</p>
</li>
<li>
<p><code>:is-no-exit</code> Set to <code>true</code> if <code>:no-exit</code> is given.
This will prevent the <code>poly</code> tool from exiting with <code>System/exit</code>.</p>
</li>
<li>
<p><code>:is-outdated</code> Set to <code>true</code> if <code>:outdated</code> is given.</p>
</li>
<li>
<p><code>:is-run-all-brick-tests</code> Set to <code>true</code> if <code>:all</code> or <code>:all-bricks are given</code>.</p>
</li>
<li>
<p><code>:is-run-project-tests</code> Set to <code>true</code> if <code>:all</code> or <code>:project</code> are given.</p>
</li>
<li>
<p><code>:is-shell</code> Set to <code>true</code> if a shell has been started with the shell command.</p>
</li>
<li>
<p><code>:is-search-for-ws-dir</code> Set to <code>true</code> if <code>::</code> is given.</p>
</li>
<li>
<p><code>:is-show-brick</code> Set to <code>true</code> if <code>:brick</code> is given.
Used by poly help deps <code>:brick</code> to show help for the deps command when <code>brick:BRICK</code> is given.</p>
</li>
<li>
<p><code>:is-show-loc</code> Set to <code>true</code> if <code>:loc</code> is given.
If given, then the <code>info</code> command will show the number of lines of code.</p>
</li>
<li>
<p><code>:is-show-project</code> Set to <code>true</code> if <code>:project</code> is given.
Used by poly help deps <code>:project</code> to show help for the deps command when <code>project:PROJECT</code> is given.</p>
</li>
<li>
<p><code>:is-show-resources</code> Set to <code>true</code> if <code>:r</code> or <code>:resources</code> is given.
This will tell the <code>info</code> command to show the <code>r</code> status flag.</p>
</li>
<li>
<p><code>:is-show-workspace</code> Set to <code>true</code> if <code>:workspace</code> is given.
Used by <code>poly help deps :workspace</code> to show help for the deps command when <code>workspace:WORKSPACE</code> is given.</p>
</li>
<li>
<p><code>:is-swap-axes</code> Set to <code>true</code> if <code>:swap-axes</code> is given.
Used by <code>poly deps :swap-axes</code> to swap the x and y axes.</p>
</li>
<li>
<p><code>:is-tap</code> Set to <code>true</code> if <code>:tap</code> is given.</p>
</li>
<li>
<p><code>:is-update</code> Set to <code>true</code> if <code>:update</code> is given. Used by the <a href="#libs">libs</a> command.</p>
</li>
<li>
<p><code>:is-verbose</code> Used in combination with the <code>test</code> command to show extra information.</p>
</li>
<li>
<p><code>:out</code> Mainly used by the <a href="#ws">ws</a> command, but can also be passed in to the <a href="#info">info</a>, <a href="#deps">deps</a>, and <a href="#libs">libs</a> commands to generate a text file from the output.
This is also available in the <a href="#overview">overview</a> command if using the <a href="#">polyx</a> tool.</p>
</li>
<li>
<p><code>:libraries</code> Used by the <a href="#libs">libs</a> command.</p>
</li>
<li>
<p><code>:replace</code> Used in tests when maintaining the <code>poly</code> tool itself, to make the output more stable.
Set to e.g. <code>[{:from "this", :to "that"}]</code> if <code>replace:this:that</code> is given.
More than one pair of values can be passed in, separated with :.</p>
</li>
<li>
<p><code>:selected-bricks</code> A vector of bricks.
The key is only populated if <code>bricks:</code> is given.
Used by the <a href="#info">info</a> and <a href="#test">test</a> commands.</p>
</li>
<li>
<p><code>:selected-profiles</code> A vector of profiles, e.g. <code>["default" "extra"]</code>, if <code>poly info +default +extra</code> is executed.
Used by the <a href="#info">info</a> and <a href="#test">test</a> commands.</p>
</li>
<li>
<p><code>:selected-projects</code> A vector of projects.
Used by the <a href="#info">info</a> and <a href="#test">test</a> commands.</p>
</li>
<li>
<p><code>:since</code> Finds the corresponding key in <code>:tag-patterns</code> in <code>workspace.edn</code> and uses that regex to find the latest matching tag/sha in the git repository, which is <em>the latest stable point in time</em> used by various commands.</p>
</li>
<li>
<p><code>:skip</code> Used to skip projects, as if they never existed.
Often used to skip the development project, in e.g. the <a href="#ws">ws</a> commands.</p>
</li>
<li>
<p><code>:top-ns</code> The top namespace, used by the <a href="#create-workspace">create workspace</a> command.</p>
</li>
<li>
<p><code>:unnamed-args</code> All given arguments that don&#8217;t contain a <code>:</code>.
So if we type <code>poly ws get:user-input:unnamed-args :flag arg xx:123</code> it will return <code>["arg"]</code> but not <code>xx</code>.</p>
</li>
<li>
<p><code>:update</code> Used by the <a href="#libs">libs</a> command.</p>
</li>
<li>
<p><code>via</code> Used by <a href="#switch-workspace">switch-ws</a>.</p>
</li>
<li>
<p><code>:with</code> Used by the <a href="#test">test</a> command to merge snippets of configuaration into the <code>:test</code> key in workspace.edn.</p>
</li>
<li>
<p><code>:ws</code> Used by the <a href="#doc">doc</a> command.</p>
</li>
<li>
<p><code>:ws-dir</code> If set, holds the workspace directory we have switched to.
Can either be explicitly passed in together with the <code>poly</code> command,
or implicitly set by the xref:commands.adoc#switch-ws command, using the <code>dir</code> argument.</p>
</li>
<li>
<p><code>:ws-file</code> If set, holds the filename of the exported workspace we have switched to.
Can either be explicitly passed in together with the <code>poly</code> command, or implicitly set by the xref:commands.adoc#switch-ws, using the <code>file</code> argument.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="version"><a class="link" href="#version">version</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:version</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:api {:breaking 1
       :non-breaking 0}
 :release {:date "2023-07-24"
           :major 0
           :minor 2
           :name "0.2.18-SNAPSHOT"
           :patch 18
           :revision "SNAPSHOT"
           :snapshot 1
           :tool "poly"}
 :test-runner-api {:breaking 1
                   :non-breaking 0}
 :ws {:breaking 3
      :non-breaking 0}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are four areas that are version controlled in Polylith:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:api</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The <code>clj-poly</code> library <a href="https://cljdoc.org/d/polylith/clj-poly/CURRENT/api/polylith">API</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:release</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://github.com/polyfy/polylith/releases">Releases</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:test-runner-api</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The <a href="#">test runner API</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>:ws</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The <a href="#">workspace structure</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p><code>:api</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:breaking</code> Increased by one if introducing a non-backward compatible change of the <a href="https://cljdoc.org/d/polylith/clj-poly/CURRENT/api/polylith">API</a>.</p>
</li>
<li>
<p><code>:non-breaking</code> Increased by one when a non-breaking change is made to the <a href="https://cljdoc.org/d/polylith/clj-poly/CURRENT/api/polylith">API</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:release</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:date</code> The date of the release in the format <code>yyyy-mm-dd</code>.</p>
</li>
<li>
<p><code>:major</code> The major version, set to zero.</p>
</li>
<li>
<p><code>:minor</code> Increased by one if any breaking changes.</p>
</li>
<li>
<p><code>:name</code> The full name of the release.</p>
</li>
<li>
<p><code>:patch</code> Increased by one for each release within a given <code>major.minor</code>.</p>
</li>
<li>
<p><code>:revision</code> What comes after <code>major.minor.path</code>.
Has the value "" if a final release, or "SNAPSHOT" if a snapshot release (older releases can have other values here).</p>
</li>
<li>
<p><code>:snapshot</code> Only set if a snapshot release, otherwise 0.
The first snapshot release will have the value of 1.
Each subsequent snapshot release will increase this value by one.</p>
</li>
<li>
<p><code>:tool</code> Set to "poly" if the <code>poly</code> tool, or "polyx" if the extended <a href="#">polyx</a> tool.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:test-runner-api</code> Versioning of the test runner API:</p>
<div class="ulist">
<ul>
<li>
<p><code>:breaking</code> Increased by one if introducing a non-backward compatible change of the <a href="https://cljdoc.org/d/polylith/clj-poly/CURRENT/api/polylith.clj.core.test-runner-contract.interface">test runner API</a>.</p>
</li>
<li>
<p><code>:non-breaking</code> Increased by one when a non-breaking change is made to the <a href="https://cljdoc.org/d/polylith/clj-poly/CURRENT/api/polylith.clj.core.test-runner-contract.interface">test runner API</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:ws</code> Versioning of the internal workspace format, returned by <code>poly ws</code>.</p>
<div class="ulist">
<ul>
<li>
<p><code>:breaking</code> Increased by one if introducing a non-backward compatible change of the workspace format:</p>
<div class="ulist">
<ul>
<li>
<p>If an attribute has changed name.</p>
</li>
<li>
<p>If an attribute has been deleted.</p>
</li>
<li>
<p>If the data format of an attribute has changed.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:non-breaking</code> Increased by one when a non-breaking change is made to the workspace format.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>:from</code> Set to the value of <code>:version</code> if the workspace is read from a file, produced by a different version than the current version of the <code>poly</code> tool, or if the workspace is read from a directory that has not been migrated from <code>:toolsdeps1</code> to <code>:toolsdeps2</code>.</p>
<div class="ulist">
<ul>
<li>
<p><code>:release-name</code> The version of the <code>poly</code> tool from which this ws file was created.</p>
</li>
<li>
<p><code>:ws</code></p>
<div class="ulist">
<ul>
<li>
<p><code>:breaking</code> The breaking version of the original <code>ws</code> format.</p>
</li>
<li>
<p><code>:non-breaking</code> The non-breaking version of the original <code>ws</code> format.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Changes to the <a href="#">workspace structure</a> is documented in the <a href="#">versions</a> page.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ws-dir"><a class="link" href="#ws-dir">ws-dir</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:ws-dir</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">"/Users/joakimtengstrand/source/polylith/examples/doc-example"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The absolute path of the workspace directory.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ws-local-dir"><a class="link" href="#ws-local-dir">ws-local-dir</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:ws-local-dir</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">"examples/doc-example"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the workspace lives at the same level as the git root, which will be the case if we create a workspace outside a git repository, or within an existing without giving a name, then this attribute is not set.
If the workspace lives inside the git root as a directory or subdirectory, which will be the case if we create the workspace inside an existing repository and giving it a name, then it is set to the relative path to the git root.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ws-reader"><a class="link" href="#ws-reader">ws-reader</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:ws-reader</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:file-extensions ["clj" "cljc"],
 :language "Clojure",
 :name "polylith-clj",
 :project-url "https://github.com/polyfy/polylith",
 :type-position "postfix"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This structure explains different aspects of the tool that created this <a href="#">workspace structure</a> (the <code>poly</code> tool in this case) and the idea is that new tooling could support the <code>workspace format</code> and populate this structure so that it can be used by external tooling.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>:file-extensions</code> Lists the supported file extensions.</p>
</li>
<li>
<p><code>:language</code> The name of the supported language.</p>
</li>
<li>
<p><code>:name</code> The name of the workspace reader.</p>
</li>
<li>
<p><code>:project-url</code> The URL to the workspace reader tool.</p>
</li>
<li>
<p><code>:type-position</code> Set to <code>postfix</code> because types (type hints) come before the arguments, in Clojure, e.g. <code>^String arg</code>.
In some other languages like Scala, the types come after the arguments.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ws-type"><a class="link" href="#ws-type">ws-type</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:ws-type</code></pre>
</div>
</div>
<div class="paragraph">
<p>Outputs the type of workspace:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>With start from version <a href="https://github.com/polyfy/polylith/releases/tag/v0.2.0-alpha10">0.2.10-alpha</a> we store <code>deps.edn</code> files in each brick, see <a href="https://github.com/polyfy/polylith/issues/66">issue 66</a>.
These workspaces will have <code>ws-type</code> set to <code>:toolsdeps2</code>.</p>
</li>
<li>
<p>All older versions (<a href="https://github.com/polyfy/polylith/releases/tag/v0.1.0-alpha9">0.1.0-alpha9</a> and older) will have <code>ws-type</code> set to <code>:toolsdeps1</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_versions"><a class="link" href="#_versions">Versions</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_versions_2" class="sect0"><a class="link" href="#_versions_2">Versions</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>There are four areas that are version controlled, which is described <a href="#version">here</a>.</p>
</div>
<div class="paragraph">
<p>The version of the workspace structure can be viewed by:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">poly ws get:version:ws</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-clojure" data-lang="clojure">{:breaking 3, :non-breaking 0}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here are the changes to the workspace structure over time:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ws</th>
<th class="tableblock halign-left valign-top">release</th>
<th class="tableblock halign-left valign-top">action</th>
<th class="tableblock halign-left valign-top">attribute</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.2.20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">configs:workspace</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stores the configuration in workspace.edn.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">configs:workspaces</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replaced by configs:workspace.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bases:BASE:illegal-deps</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set if the base has any illegal namespace dependencies.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">components:COMPONENT:illegal-deps</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set if the component has any illegal namespace dependencies.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.2.19</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ENTITIES:ENTITY:keep-lib-versions</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">projects:PROJECT:necessary</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">projects:PROJECT:test</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">projects:PROJECT:bricks-to-test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Moved from changes:project-to-bricks-to-test.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">projects:PROJECT:indirect-changes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Moved from changes:project-to-indirect-changes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">projects:PROJECT:projects-to-test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Moved from changes:project-to-projects-to-test.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">profiles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Moved from settings:profile-to-settings.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings:test</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">changes:project-to-bricks-to-test</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">changes:project-to-indirect-changes</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">changes:project-to-projects-to-test</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings:profile-to-settings</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings:bricks</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings:projects</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.2.18</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings:projects:PROJECT:keep-lib-versions</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings:bricks:keep-lib-versions</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings:projects:PROJECT:necessary</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bases:BASE:base-deps</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">version.ws.type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Moved out to ws-type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">version.from.ws.type</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">version:api</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">version:tool</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">version:test-runner-api</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">version:release:snapshot</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ws-type</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">renamed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">interfaces:definitions:DEFINITION:arglist</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renamed from parameters.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">renamed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">projects:PROJECT:deps:BRICK:SOURCE:missing-ifc-and-bases</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renamed from missing-ifc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">renamed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">projects:PROJECT:deps-filename</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renamed from config-filename.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">projects:PROJECT:project-lib-deps</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Libraries defined by the project itself.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ENTITIES:ENTITY:namespaces:SOURCE:NAMESPACE:is-invalid</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">changed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ENTITIES:ENTITY:namespaces:SOURCE:NAMESPACE:file-path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The ws-dir part is removed from the file path (data change).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.2.16-alpha</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ENTITIES:ENTITY:namespaces:src:NAMESPACE:invalid</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.2.14-alpha</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings:vcs:is-git-repo</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">projects:PROJECT:is-run-tests</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0-alpha9</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version 0.2.0-alpha9 and earlier, has from.ws set to 0.0 if read from file.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Used in the above table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">What</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">base.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">COMPONENT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">component.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ENTITY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Base, component, or project.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ENTITIES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bases, components, or projects.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAMESPACE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A namespace name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LIBRARY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A library name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SOURCE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src or test.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_contact"><a class="link" href="#_contact">Contact</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_contact_2" class="sect0"><a class="link" href="#_contact_2">Contact</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>Feel free to contact me:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Twitter
</td>
<td class="hdlist2">
<p>@jtengstrand</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Email
</td>
<td class="hdlist2">
<p>joakim.tengstrand[at]gmail[dot]com</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also post your questions in the <a href="https://clojurians.slack.com/messages/C013B7MQHJQ">polylith</a> channel in Slack.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_license"><a class="link" href="#_license">License</a></h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_license_2" class="sect0"><a class="link" href="#_license_2">License</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>Distributed under the <a href="https://opensource.org/license/epl-1-0">Eclipse Public License 1.0</a>, the same as Clojure.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-08-03 16:55:14 UTC
</div>
</div>
</body>
</html>